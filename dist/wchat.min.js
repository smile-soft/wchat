!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Wchat=t()}}(function(){var define,module,exports;return function(){function t(e,n,s){function a(i,o){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(r)return r(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[i]={exports:{}};e[i][0].call(u.exports,function(t){var n=e[i][1][t];return a(n||t)},u,u.exports,t,e,n,s)}return n[i].exports}for(var r="function"==typeof require&&require,i=0;i<s.length;i++)a(s[i]);return a}return t}()({1:[function(t,e,n){function s(t,e){if("string"!=typeof t)throw new TypeError("String expected");e||(e=document);var n=/<([\w:]+)/.exec(t);if(!n)return e.createTextNode(t);t=t.replace(/^\s+|\s+$/g,"");var s=n[1];if("body"==s){var a=e.createElement("html");return a.innerHTML=t,a.removeChild(a.lastChild)}var r=i[s]||i._default,o=r[0],l=r[1],c=r[2],a=e.createElement("div");for(a.innerHTML=l+t+c;o--;)a=a.lastChild;if(a.firstChild==a.lastChild)return a.removeChild(a.firstChild);for(var u=e.createDocumentFragment();a.firstChild;)u.appendChild(a.removeChild(a.firstChild));return u}e.exports=s;var a,r=!1;"undefined"!=typeof document&&(a=document.createElement("div"),a.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',r=!a.getElementsByTagName("link").length,a=void 0);var i={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:r?[1,"X<div>","</div>"]:[0,"",""]};i.td=i.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],i.option=i.optgroup=[1,'<select multiple="multiple">',"</select>"],i.thead=i.tbody=i.colgroup=i.caption=i.tfoot=[1,"<table>","</table>"],i.polyline=i.ellipse=i.polygon=i.circle=i.text=i.line=i.path=i.rect=i.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"]},{}],2:[function(t,e,n){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(t){return"function"==typeof t}function r(t){return"number"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},s.prototype.emit=function(t){var e,n,s,r,l,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(n=this._events[t],o(n))return!1;if(a(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(i(n))for(r=Array.prototype.slice.call(arguments,1),c=n.slice(),s=c.length,l=0;l<s;l++)c[l].apply(this,r);return!0},s.prototype.addListener=function(t,e){var n;if(!a(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,a(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(n=o(this._maxListeners)?s.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(t,e){function n(){this.removeListener(t,n),s||(s=!0,e.apply(this,arguments))}if(!a(e))throw TypeError("listener must be a function");var s=!1;return n.listener=e,this.on(t,n),this},s.prototype.removeListener=function(t,e){var n,s,r,o;if(!a(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],r=n.length,s=-1,n===e||a(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(o=r;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){s=o;break}if(s<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},s.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],a(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},s.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?a(this._events[t])?[this._events[t]]:this._events[t].slice():[]},s.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(a(e))return 1;if(e)return e.length}return 0},s.listenerCount=function(t,e){return t.listenerCount(e)}},{}],3:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],4:[function(t,e,n){var s=t("../internal/arrayEach"),a=t("../internal/baseEach"),r=t("../internal/createForEach"),i=r(s,a);e.exports=i},{"../internal/arrayEach":10,"../internal/baseEach":15,"../internal/createForEach":28}],5:[function(t,e,n){var s=t("../internal/getNative"),a=s(Date,"now"),r=a||function(){return(new Date).getTime()};e.exports=r},{"../internal/getNative":32}],6:[function(t,e,n){function s(t,e,n){function s(){h&&clearTimeout(h),p&&clearTimeout(p),v=0,p=h=b=void 0}function l(e,n){n&&clearTimeout(n),p=h=b=void 0,e&&(v=r(),m=t.apply(g,f),h||p||(f=g=void 0))}function c(){var t=e-(r()-_);t<=0||t>e?l(b,p):h=setTimeout(c,t)}function u(){l(x,h)}function d(){if(f=arguments,_=r(),g=this,b=x&&(h||!w),y===!1)var n=w&&!h;else{p||w||(v=_);var s=y-(_-v),a=s<=0||s>y;a?(p&&(p=clearTimeout(p)),v=_,m=t.apply(g,f)):p||(p=setTimeout(u,s))}return a&&h?h=clearTimeout(h):h||e===y||(h=setTimeout(c,e)),n&&(a=!0,m=t.apply(g,f)),!a||h||p||(f=g=void 0),m}var f,p,m,_,g,h,b,v=0,y=!1,x=!0;if("function"!=typeof t)throw new TypeError(i);if(e=e<0?0:+e||0,n===!0){var w=!0;x=!1}else a(n)&&(w=!!n.leading,y="maxWait"in n&&o(+n.maxWait||0,e),x="trailing"in n?!!n.trailing:x);return d.cancel=s,d}var a=t("../lang/isObject"),r=t("../date/now"),i="Expected a function",o=Math.max;e.exports=s},{"../date/now":5,"../lang/isObject":48}],7:[function(t,e,n){function s(t,e){if("function"!=typeof t)throw new TypeError(a);return e=r(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,s=-1,a=r(n.length-e,0),i=Array(a);++s<a;)i[s]=n[e+s];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,n[0],i);case 2:return t.call(this,n[0],n[1],i)}var o=Array(e+1);for(s=-1;++s<e;)o[s]=n[s];return o[e]=i,t.apply(this,o)}}var a="Expected a function",r=Math.max;e.exports=s},{}],8:[function(t,e,n){function s(t,e,n){var s=!0,o=!0;if("function"!=typeof t)throw new TypeError(i);return n===!1?s=!1:r(n)&&(s="leading"in n?!!n.leading:s,o="trailing"in n?!!n.trailing:o),a(t,e,{leading:s,maxWait:+e,trailing:o})}var a=t("./debounce"),r=t("../lang/isObject"),i="Expected a function";e.exports=s},{"../lang/isObject":48,"./debounce":6}],9:[function(t,e,n){function s(t,e){var n=-1,s=t.length;for(e||(e=Array(s));++n<s;)e[n]=t[n];return e}e.exports=s},{}],10:[function(t,e,n){function s(t,e){for(var n=-1,s=t.length;++n<s&&e(t[n],n,t)!==!1;);return t}e.exports=s},{}],11:[function(t,e,n){function s(t,e,n,s){return void 0!==t&&r.call(s,n)?t:e}var a=Object.prototype,r=a.hasOwnProperty;e.exports=s},{}],12:[function(t,e,n){function s(t,e,n){for(var s=-1,r=a(e),i=r.length;++s<i;){var o=r[s],l=t[o],c=n(l,e[o],o,t,e);(c===c?c===l:l!==l)&&(void 0!==l||o in t)||(t[o]=c)}return t}var a=t("../object/keys");e.exports=s},{"../object/keys":52}],13:[function(t,e,n){function s(t,e){return null==e?t:a(e,r(e),t)}var a=t("./baseCopy"),r=t("../object/keys");e.exports=s},{"../object/keys":52,"./baseCopy":14}],14:[function(t,e,n){function s(t,e,n){n||(n={});for(var s=-1,a=e.length;++s<a;){var r=e[s];n[r]=t[r]}return n}e.exports=s},{}],15:[function(t,e,n){var s=t("./baseForOwn"),a=t("./createBaseEach"),r=a(s);e.exports=r},{"./baseForOwn":18,"./createBaseEach":26}],16:[function(t,e,n){var s=t("./createBaseFor"),a=s();e.exports=a},{"./createBaseFor":27}],17:[function(t,e,n){function s(t,e){return a(t,e,r)}var a=t("./baseFor"),r=t("../object/keysIn");e.exports=s},{"../object/keysIn":53,"./baseFor":16}],18:[function(t,e,n){function s(t,e){return a(t,e,r)}var a=t("./baseFor"),r=t("../object/keys");e.exports=s},{"../object/keys":52,"./baseFor":16}],19:[function(t,e,n){function s(t,e,n,f,p){if(!l(t))return t;var m=o(e)&&(i(e)||u(e)),_=m?void 0:d(e);return a(_||e,function(a,i){if(_&&(i=a,a=e[i]),c(a))f||(f=[]),p||(p=[]),r(t,e,i,s,n,f,p);else{var o=t[i],l=n?n(o,a,i,t,e):void 0,u=void 0===l;u&&(l=a),void 0===l&&(!m||i in t)||!u&&(l===l?l===o:o!==o)||(t[i]=l)}}),t}var a=t("./arrayEach"),r=t("./baseMergeDeep"),i=t("../lang/isArray"),o=t("./isArrayLike"),l=t("../lang/isObject"),c=t("./isObjectLike"),u=t("../lang/isTypedArray"),d=t("../object/keys");e.exports=s},{"../lang/isArray":44,"../lang/isObject":48,"../lang/isTypedArray":50,"../object/keys":52,"./arrayEach":10,"./baseMergeDeep":20,"./isArrayLike":33,"./isObjectLike":37}],20:[function(t,e,n){function s(t,e,n,s,d,f,p){for(var m=f.length,_=e[n];m--;)if(f[m]==_)return void(t[n]=p[m]);var g=t[n],h=d?d(g,_,n,t,e):void 0,b=void 0===h;b&&(h=_,o(_)&&(i(_)||c(_))?h=i(g)?g:o(g)?a(g):[]:l(_)||r(_)?h=r(g)?u(g):l(g)?g:{}:b=!1),f.push(_),p.push(h),b?t[n]=s(h,_,d,f,p):(h===h?h!==g:g===g)&&(t[n]=h)}var a=t("./arrayCopy"),r=t("../lang/isArguments"),i=t("../lang/isArray"),o=t("./isArrayLike"),l=t("../lang/isPlainObject"),c=t("../lang/isTypedArray"),u=t("../lang/toPlainObject");e.exports=s},{"../lang/isArguments":43,"../lang/isArray":44,"../lang/isPlainObject":49,"../lang/isTypedArray":50,"../lang/toPlainObject":51,"./arrayCopy":9,"./isArrayLike":33}],21:[function(t,e,n){function s(t){return function(e){return null==e?void 0:e[t]}}e.exports=s},{}],22:[function(t,e,n){function s(t){return null==t?"":t+""}e.exports=s},{}],23:[function(t,e,n){function s(t,e){for(var n=-1,s=e.length,a=Array(s);++n<s;)a[n]=t[e[n]];return a}e.exports=s},{}],24:[function(t,e,n){function s(t,e,n){if("function"!=typeof t)return a;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,s,a){return t.call(e,n,s,a)};case 4:return function(n,s,a,r){return t.call(e,n,s,a,r)};case 5:return function(n,s,a,r,i){return t.call(e,n,s,a,r,i)}}return function(){return t.apply(e,arguments)}}var a=t("../utility/identity");e.exports=s},{"../utility/identity":59}],25:[function(t,e,n){function s(t){return i(function(e,n){var s=-1,i=null==e?0:n.length,o=i>2?n[i-2]:void 0,l=i>2?n[2]:void 0,c=i>1?n[i-1]:void 0;for("function"==typeof o?(o=a(o,c,5),i-=2):(o="function"==typeof c?c:void 0,i-=o?1:0),l&&r(n[0],n[1],l)&&(o=i<3?void 0:o,i=1);++s<i;){var u=n[s];u&&t(e,u,o)}return e})}var a=t("./bindCallback"),r=t("./isIterateeCall"),i=t("../function/restParam");e.exports=s},{"../function/restParam":7,"./bindCallback":24,"./isIterateeCall":35}],26:[function(t,e,n){function s(t,e){return function(n,s){var o=n?a(n):0;if(!r(o))return t(n,s);for(var l=e?o:-1,c=i(n);(e?l--:++l<o)&&s(c[l],l,c)!==!1;);return n}}var a=t("./getLength"),r=t("./isLength"),i=t("./toObject");e.exports=s},{"./getLength":31,"./isLength":36,"./toObject":42}],27:[function(t,e,n){function s(t){return function(e,n,s){for(var r=a(e),i=s(e),o=i.length,l=t?o:-1;t?l--:++l<o;){var c=i[l];if(n(r[c],c,r)===!1)break}return e}}var a=t("./toObject");e.exports=s},{"./toObject":42}],28:[function(t,e,n){function s(t,e){return function(n,s,i){return"function"==typeof s&&void 0===i&&r(n)?t(n,s):e(n,a(s,i,3))}}var a=t("./bindCallback"),r=t("../lang/isArray");e.exports=s},{"../lang/isArray":44,"./bindCallback":24}],29:[function(t,e,n){function s(t){return a[t]}var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};e.exports=s},{}],30:[function(t,e,n){function s(t){return"\\"+a[t]}var a={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};e.exports=s},{}],31:[function(t,e,n){var s=t("./baseProperty"),a=s("length");e.exports=a},{"./baseProperty":21}],32:[function(t,e,n){function s(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}var a=t("../lang/isNative");e.exports=s},{"../lang/isNative":47}],33:[function(t,e,n){function s(t){return null!=t&&r(a(t))}var a=t("./getLength"),r=t("./isLength");e.exports=s},{"./getLength":31,"./isLength":36}],34:[function(t,e,n){function s(t,e){return t="number"==typeof t||a.test(t)?+t:-1,e=null==e?r:e,t>-1&&t%1==0&&t<e}var a=/^\d+$/,r=9007199254740991;e.exports=s},{}],35:[function(t,e,n){function s(t,e,n){if(!i(n))return!1;var s=typeof e;if("number"==s?a(n)&&r(e,n.length):"string"==s&&e in n){var o=n[e];return t===t?t===o:o!==o}return!1}var a=t("./isArrayLike"),r=t("./isIndex"),i=t("../lang/isObject");e.exports=s},{"../lang/isObject":48,"./isArrayLike":33,"./isIndex":34}],36:[function(t,e,n){function s(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=a}var a=9007199254740991;e.exports=s},{}],37:[function(t,e,n){function s(t){return!!t&&"object"==typeof t}e.exports=s},{}],38:[function(t,e,n){var s=/<%-([\s\S]+?)%>/g;e.exports=s},{}],39:[function(t,e,n){var s=/<%([\s\S]+?)%>/g;e.exports=s},{}],40:[function(t,e,n){var s=/<%=([\s\S]+?)%>/g;e.exports=s},{}],41:[function(t,e,n){function s(t){for(var e=l(t),n=e.length,s=n&&t.length,c=!!s&&o(s)&&(r(t)||a(t)),d=-1,f=[];++d<n;){var p=e[d];(c&&i(p,s)||u.call(t,p))&&f.push(p)}return f}var a=t("../lang/isArguments"),r=t("../lang/isArray"),i=t("./isIndex"),o=t("./isLength"),l=t("../object/keysIn"),c=Object.prototype,u=c.hasOwnProperty;e.exports=s},{"../lang/isArguments":43,"../lang/isArray":44,"../object/keysIn":53,"./isIndex":34,"./isLength":36}],42:[function(t,e,n){function s(t){return a(t)?t:Object(t)}var a=t("../lang/isObject");e.exports=s},{"../lang/isObject":48}],43:[function(t,e,n){function s(t){return r(t)&&a(t)&&o.call(t,"callee")&&!l.call(t,"callee")}var a=t("../internal/isArrayLike"),r=t("../internal/isObjectLike"),i=Object.prototype,o=i.hasOwnProperty,l=i.propertyIsEnumerable;e.exports=s},{"../internal/isArrayLike":33,"../internal/isObjectLike":37}],44:[function(t,e,n){var s=t("../internal/getNative"),a=t("../internal/isLength"),r=t("../internal/isObjectLike"),i="[object Array]",o=Object.prototype,l=o.toString,c=s(Array,"isArray"),u=c||function(t){return r(t)&&a(t.length)&&l.call(t)==i};e.exports=u},{"../internal/getNative":32,"../internal/isLength":36,"../internal/isObjectLike":37}],45:[function(t,e,n){function s(t){return a(t)&&"string"==typeof t.message&&o.call(t)==r}var a=t("../internal/isObjectLike"),r="[object Error]",i=Object.prototype,o=i.toString;e.exports=s},{"../internal/isObjectLike":37}],46:[function(t,e,n){function s(t){return a(t)&&o.call(t)==r}var a=t("./isObject"),r="[object Function]",i=Object.prototype,o=i.toString;e.exports=s},{"./isObject":48}],47:[function(t,e,n){function s(t){return null!=t&&(a(t)?u.test(l.call(t)):r(t)&&i.test(t))}var a=t("./isFunction"),r=t("../internal/isObjectLike"),i=/^\[object .+?Constructor\]$/,o=Object.prototype,l=Function.prototype.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=s},{"../internal/isObjectLike":37,"./isFunction":46}],48:[function(t,e,n){function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=s},{}],49:[function(t,e,n){function s(t){var e;if(!i(t)||u.call(t)!=o||r(t)||!c.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var n;return a(t,function(t,e){n=e}),void 0===n||c.call(t,n)}var a=t("../internal/baseForIn"),r=t("./isArguments"),i=t("../internal/isObjectLike"),o="[object Object]",l=Object.prototype,c=l.hasOwnProperty,u=l.toString;e.exports=s},{"../internal/baseForIn":17,"../internal/isObjectLike":37,"./isArguments":43}],50:[function(t,e,n){function s(t){return r(t)&&a(t.length)&&!!O[j.call(t)]}var a=t("../internal/isLength"),r=t("../internal/isObjectLike"),i="[object Arguments]",o="[object Array]",l="[object Boolean]",c="[object Date]",u="[object Error]",d="[object Function]",f="[object Map]",p="[object Number]",m="[object Object]",_="[object RegExp]",g="[object Set]",h="[object String]",b="[object WeakMap]",v="[object ArrayBuffer]",y="[object Float32Array]",x="[object Float64Array]",w="[object Int8Array]",k="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",C="[object Uint8ClampedArray]",L="[object Uint16Array]",A="[object Uint32Array]",O={};O[y]=O[x]=O[w]=O[k]=O[S]=O[E]=O[C]=O[L]=O[A]=!0,O[i]=O[o]=O[v]=O[l]=O[c]=O[u]=O[d]=O[f]=O[p]=O[m]=O[_]=O[g]=O[h]=O[b]=!1;var T=Object.prototype,j=T.toString;e.exports=s},{"../internal/isLength":36,"../internal/isObjectLike":37}],51:[function(t,e,n){function s(t){return a(t,r(t))}var a=t("../internal/baseCopy"),r=t("../object/keysIn");e.exports=s},{"../internal/baseCopy":14,"../object/keysIn":53}],52:[function(t,e,n){var s=t("../internal/getNative"),a=t("../internal/isArrayLike"),r=t("../lang/isObject"),i=t("../internal/shimKeys"),o=s(Object,"keys"),l=o?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&a(t)?i(t):r(t)?o(t):[]}:i;e.exports=l},{"../internal/getNative":32,"../internal/isArrayLike":33,"../internal/shimKeys":41,"../lang/isObject":48}],53:[function(t,e,n){function s(t){if(null==t)return[];l(t)||(t=Object(t));var e=t.length;e=e&&o(e)&&(r(t)||a(t))&&e||0;for(var n=t.constructor,s=-1,c="function"==typeof n&&n.prototype===t,d=Array(e),f=e>0;++s<e;)d[s]=s+"";for(var p in t)f&&i(p,e)||"constructor"==p&&(c||!u.call(t,p))||d.push(p);return d}var a=t("../lang/isArguments"),r=t("../lang/isArray"),i=t("../internal/isIndex"),o=t("../internal/isLength"),l=t("../lang/isObject"),c=Object.prototype,u=c.hasOwnProperty;e.exports=s},{"../internal/isIndex":34,"../internal/isLength":36,"../lang/isArguments":43,"../lang/isArray":44,"../lang/isObject":48}],54:[function(t,e,n){var s=t("../internal/baseMerge"),a=t("../internal/createAssigner"),r=a(s);e.exports=r},{"../internal/baseMerge":19,"../internal/createAssigner":25}],55:[function(t,e,n){function s(t){return t=a(t),t&&o.test(t)?t.replace(i,r):t}var a=t("../internal/baseToString"),r=t("../internal/escapeHtmlChar"),i=/[&<>"'`]/g,o=RegExp(i.source);e.exports=s},{"../internal/baseToString":22,"../internal/escapeHtmlChar":29}],56:[function(t,e,n){function s(t,e,n){var s=_.imports._.templateSettings||_;n&&f(t,e,n)&&(e=n=void 0),t=l(t),e=r(o({},n||e),s,a);var w,k,S=r(o({},e.imports),s.imports,a),E=p(S),C=c(S,E),L=0,A=e.interpolate||y,O="__p += '",T=RegExp((e.escape||y).source+"|"+A.source+"|"+(A===m?v:y).source+"|"+(e.evaluate||y).source+"|$","g"),j="sourceURL"in e?"//# sourceURL="+e.sourceURL+"\n":"";t.replace(T,function(e,n,s,a,r,i){return s||(s=a),O+=t.slice(L,i).replace(x,u),n&&(w=!0,O+="' +\n__e("+n+") +\n'"),r&&(k=!0,O+="';\n"+r+";\n__p += '"),s&&(O+="' +\n((__t = ("+s+")) == null ? '' : __t) +\n'"),L=i+e.length,e}),O+="';\n";var I=e.variable;I||(O="with (obj) {\n"+O+"\n}\n"),O=(k?O.replace(g,""):O).replace(h,"$1").replace(b,"$1;"),O="function("+(I||"obj")+") {\n"+(I?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(w?", __e = _.escape":"")+(k?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+O+"return __p\n}";var N=i(function(){return Function(E,j+"return "+O).apply(void 0,C)});if(N.source=O,d(N))throw N;return N}var a=t("../internal/assignOwnDefaults"),r=t("../internal/assignWith"),i=t("../utility/attempt"),o=t("../internal/baseAssign"),l=t("../internal/baseToString"),c=t("../internal/baseValues"),u=t("../internal/escapeStringChar"),d=t("../lang/isError"),f=t("../internal/isIterateeCall"),p=t("../object/keys"),m=t("../internal/reInterpolate"),_=t("./templateSettings"),g=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,b=/(__e\(.*?\)|\b__t\)) \+\n'';/g,v=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,y=/($^)/,x=/['\n\r\u2028\u2029\\]/g;e.exports=s},{"../internal/assignOwnDefaults":11,"../internal/assignWith":12,"../internal/baseAssign":13,"../internal/baseToString":22,"../internal/baseValues":23,"../internal/escapeStringChar":30,"../internal/isIterateeCall":35,"../internal/reInterpolate":40,"../lang/isError":45,"../object/keys":52,"../utility/attempt":58,"./templateSettings":57}],57:[function(t,e,n){var s=t("./escape"),a=t("../internal/reEscape"),r=t("../internal/reEvaluate"),i=t("../internal/reInterpolate"),o={escape:a,evaluate:r,interpolate:i,variable:"",imports:{_:{escape:s}}};e.exports=o},{"../internal/reEscape":38,"../internal/reEvaluate":39,"../internal/reInterpolate":40,"./escape":55}],58:[function(t,e,n){var s=t("../lang/isError"),a=t("../function/restParam"),r=a(function(t,e){try{return t.apply(void 0,e)}catch(n){return s(n)?n:new Error(n)}});e.exports=r},{"../function/restParam":7,"../lang/isError":45}],59:[function(t,e,n){function s(t){return t}e.exports=s},{}],60:[function(t,e,n){var s,a="",r="wav",i=.5;e.exports={init:function(t){return s=document.createElement("audio"),s.setAttribute("autoplay",!0),document.body.appendChild(s),t&&(a=t),this},play:function(t,e){t&&(s.src=a+t+"."+r),e?s.setAttribute("loop",!0):s.removeAttribute("loop"),s.volume=i,s.play()},stop:function(){s.pause(),s.currentTime=0}}},{}],61:[function(t,e,n){function s(){return C}function a(t){return C?S.info("Cobrowsing already initiated"):(b(document,"keyup",f),b(document,"keydown",f),b(document,"keypress",f),b(document,"mouseup",f),b(document,"click",f),b(document,"change",f),y="string"==typeof t.widget?document.querySelector(t.widget):t.widget,O=t.entity,x=t.emit,T=t.path,C=!0,S.log("cobrowsing module initiated with parameters: ",t),void x("cobrowsing/init"))}function r(){return L?S.info("Browser already shared"):(b(document,"scroll",f),b(document,"select",f),b(document,"mousemove",f),o(),L=!0,S.log("browser shared"),void x("cobrowsing/shared",{entity:O}))}function i(){return L?(v(document,"scroll",f),v(document,"select",f),v(document,"mousemove",f),c(),L=!1,x("cobrowsing/unshared",{entity:O}),void S.log("browser unshared")):S.info("Browser already unshared")}function o(){var t=document.body;A||(A=document.createElement("img"),A.className="wc-rmt-ptr",A.setAttribute("src",T+"images/pointer.png"),A.style.position="absolute",t.firstChild?t.insertBefore(A,t.firstChild):t.appendChild(A),l())}function l(){A.style.left=N,A.style.top=R,w=window.requestAnimationFrame(l)}function c(){A&&(cancelAnimationFrame(w),A.parentNode.removeChild(A),A=null)}function u(t){var e=0;if(document.selection){t.focus();var n=document.selection.createRange();n.moveStart("character",-t.value.length),e=n.text.length}else e=(!t.type||"email"!==t.type&&"number"!==t.type)&&(t.selectionStart||"0"==t.selectionStart)?t.selectionStart:null;return e}function d(t){x("cobrowsing/event",{entity:O,events:t})}function f(t){var e=t||window.event,n=e.type,s=e.target,a=s.nodeName,r=document.body,i={},o=null,l=document.getElementsByTagName(s.nodeName),c=document.documentElement.scrollTop||document.body.scrollTop,d=document.documentElement.scrollLeft||document.body.scrollLeft,f=0;if(3===s.nodeType&&(s=s.parentNode),"user"!==O||!h(y,s)){for(f=0;f<E.length;f++)if(E[f].event==n)return void E.splice(f,1);for(f=0;f<l.length;f++)l[f]==s&&(o=f);if(i.event=n,i.entity=O,i.tn=a,i.tni=o,i.w=r.offsetWidth,i.h=r.offsetHeight,i.sx=d,i.sy=c,"mousemove"===n||"mouseover"===n||"mouseout"===n){var p=e.pageX||e.clientX+c,m=e.pageY||e.clientY+d;i.x=p,i.y=m}else if("scroll"===n);else if("keyup"==n||"keydown"==n||"keypress"==n){var _=e.charCode||e.keyCode||e.which,g=u(s);if("INPUT"===a&&"password"===s.type)return;if("keyup"==n){if(null!==g&&(86!=_||!e.metaKey&&!e.ctrlKey))return;var b=s.value;b&&(b=b.replace(/\n/g,"<br>"),i.value=b)}else if("keydown"==n){if(null===g||8!=_&&46!=_&&190!=_)return;if(!s.value)return;i.pos=g,i.code=_}else if("keypress"===n){if(null===g||8==_||46==_)return;i.pos=g,i.code=_}}else if("change"===n){if("INPUT"===a&&"password"===s.type)return;i.value=s.value}else if("mouseup"==n||"select"==n){var v=window.getSelection()||document.selection.createRange().text,x=v.anchorOffset,w=v.focusOffset,k=0,S="",C=0,L="",A=0,T="",j=0,N="",R=!1;if(null!==v.anchorNode){for(L=v.anchorNode.parentNode,f=0;f<L.childNodes.length;f++)L.childNodes[f]==v.anchorNode&&(C=f);for(S=L.nodeName.toLowerCase(),l=document.getElementsByTagName(S),f=0;f<l.length;f++)l[f]===L&&(k=f);for(N=v.focusNode.parentNode,f=0;f<N.childNodes.length;f++)N.childNodes[f]==v.focusNode&&(j=f);for(T=N.nodeName.toLowerCase(),l=document.getElementsByTagName(T),f=0;f<l.length;f++)l[f]===N&&(A=f);S===T&&k===A&&C===j&&x>w&&(R=!0),i.sn=S,i.sni=k,i.schi=C,i.en=T,i.eni=A,i.echi=j,i.so=R?w:x,i.eo=R?x:w}}else"click"==n&&(i.scx=e.screenX,i.scy=e.screenY);I(i)}}function p(t){var e,n=document.documentElement,s={};if(t.events){if(s=t.events,s.timestamp<j)return;if(s.entity===O)return;if(s.url){var a=s.url,r=document.URL;r.indexOf("chatSessionId")!==-1&&(r=r.substr(0,r.indexOf("chatSessionId")-1)),a!=r&&g(a)}if(s.w&&"user"===s.entity){var i=document.body,o=i.offsetWidth;o!==s.w&&(document.body.style.width=s.w+"px")}if("mousemove"===s.event)A&&(N=s.x+"px",R=s.y+"px");else if("scroll"===s.event)void 0!==s.tn&&(e="#document"===s.tn?n:document.getElementsByTagName(s.tn)[s.tni],e&&(e.scrollTop=s.sy,e.scrollLeft=s.sx),console.log("scroll event: ",e,s.sy));else if("mouseup"===s.event||"select"===s.event){if(s.sn){var l=document.getElementsByTagName(s.sn)[s.sni],c=document.getElementsByTagName(s.en)[s.eni];if(document.createRange&&void 0!==l&&void 0!==c){var u=document.createRange();u.setStart(l.childNodes[s.schi],s.so),u.setEnd(c.childNodes[s.echi],s.eo);var d=window.getSelection();d.removeAllRanges(),d.addRange(u)}}}else if("keyup"===s.event||"keydown"===s.event||"keypress"===s.event){if(void 0!==s.tn&&void 0!==s.tni&&(e=document.getElementsByTagName(s.tn)[s.tni])){var f,p=e.value;if(8==s.code){if(s.pos==p.length-1)f=p.substr(0,s.pos-1);else{if(0===s.pos)return;f=p.substr(0,s.pos-1)+p.substr(s.pos)}e.value=f}else if(46==s.code)f=p.substr(0,s.pos)+p.substr(s.pos+1),e.value=f;else if(190==s.code)f=p.substr(0,s.pos)+"."+p.substr(s.pos),e.value=f;else if(void 0!==s.value){var h=s.value;h=h.replace(/<br>/g,"\n"),e.value=h}else{var b=String.fromCharCode(s.code);f=p?p.substr(0,s.pos)+b+p.substr(s.pos):b,e.value=f}}}else if("change"===s.event)e=document.getElementsByTagName(s.tn)[s.tni],e.value=s.value;else if("click"===s.event)e=document.getElementsByTagName(s.tn)[s.tni],e&&e.click();else if(e=document.getElementsByTagName(s.tn)[s.tni]){var v=m(s.event,s.x,s.y,s.x,s.y);_(e,v)}"click"!==s.event&&"scroll"!==s.event||E.push(s)}t.timestamp&&(j=t.timestamp)}function m(t,e,n,s,a){var r,i={bubbles:!0,cancelable:"mousemove"!=t,view:window,detail:0,screenX:e,screenY:n,clientX:s,clientY:a,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};if("function"==typeof document.createEvent)r=document.createEvent("MouseEvents"),r.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,document.body.parentNode);else if(document.createEventObject){r=document.createEventObject();for(var o in i)r[o]=i[o];r.button={0:1,1:4,2:2}[r.button]||r.button}return r}function _(t,e){return t.dispatchEvent?t.dispatchEvent(e):t.fireEvent&&t.fireEvent("on"+type,e),e}function g(t){var e=document.URL;e!==t&&(document.location.href=t)}function h(t,e){for(var n=e.parentNode;null!=n;){if(n==t)return!0;n=n.parentNode}return!1}function b(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function v(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent("on"+e,n)}var y,x,w,k=t("./lodash-fns"),S=t("./debug"),E=[],C=!1,L=!1,A=null,O="",T="",j=0,I=k.throttle(d,100,{trailing:!0,leading:!0}),N=0,R=0;e.exports={init:a,isInitiated:s,share:r,unshare:i,emitEvents:d,updateEvents:p}},{"./debug":63,"./lodash-fns":64}],62:[function(t,e,n){(function(n){function s(t){return this.options=t||{},this.options.serverUrl=this.options.server+"/ipcc/$$$",this.session={},this.options.wsServer||this.options.pageid?(g=this.options.wsServer?this.options.wsServer:_,g+=("/"!==g[g.length-1]?"/":"")+this.options.pageid,this.createWebsocket(),this.on("session/create",this.onSessionCreate.bind(this)),this.on("Error",this.onError),this):console.error("Cannot initiate module: pageid is undefined")}function a(t){var e=1e3*(Math.pow(2,t)-1);return e>3e4&&(e=3e4),Math.random()*e}function r(t){var e=t;return"ua"===t?e="uk":"us"!==t&&"gb"!==t||(e="en"),e}function i(t){var e=new FormData;return Object.keys(t).map(function(n){if("file"===n)e.append(n,t[n],t.filename||"");else{if("filename"===n)return n;e.append(n,t[n])}return n}),u.log("toFormData: ",t,e.get("filename")),e}var o=t("events").EventEmitter,l=t("./storage"),c=t("./request"),u=t("./debug"),d=n.location,f=t("./lodash-fns"),p=t("inherits"),m=1,_="main.ringotel.net/chatbot/WebChat/",g="",h=!1,b=null;p(s,o),e.exports=s,s.prototype.onError=function(t){u.log("Error: ",t)},s.prototype.onSessionCreate=function(t){this.session=f.merge(this.session,t),l.saveState("sid",t.sid)},s.prototype.setSessionTimeout=function(){var t=this.session.sessionTimeout;clearTimeout(b),t&&(b=setTimeout(this.onSessionTimeout.bind(this),1e3*t))},s.prototype.onSessionTimeout=function(){this.emit("session/timeout")},s.prototype.sendData=function(t){this.websocket&&this.websocket.send(JSON.stringify(t))},s.prototype.onWebsocketMessage=function(t){var e=JSON.parse(t.data);e.method;if(e.method)if("session"===e.method)this.emit("session/create",e.params);else if("messages"===e.method)e.params.list&&e.params.list.map(function(t){return this.emit("message/new",t),t}.bind(this));else if("message"===e.method)e.params.typing?this.emit("message/typing"):(this.emit("message/new",e.params),this.setSessionTimeout());else if("openShare"===e.method){if(this.session.sharedId===e.params.id)return;if(e.params.url&&d.href!==e.params.url)return window.location=e.params.url;e.params.id&&(this.session.sharedId=e.params.id,this.emit("session/joined",{url:d.href}),this.shareOpened(e.params.id,d.href))}else"shareOpened"===e.method?e.params.id&&(this.session.sharedId=e.params.id,this.emit("session/joined",{url:d.href})):"shareClosed"===e.method?(clearInterval(this.openShareInteval),this.session.sharedId="",this.emit("session/disjoin")):"events"===e.method&&this.emit("cobrowsing/update",e.params)},s.prototype.init=function(){h=!0;var t=l.getState("entity","session"),e=l.getState("sid");if(strIndex=d.href.indexOf("chatSessionId"),u.log("initModule: ",this.session,t,e),strIndex!==-1){e=this.getSidFromUrl(d.href),t="agent";var n=d.href.substr(0,strIndex);n="?"===n[n.length-1]?n.substr(0,n.length-1):n,l.saveState("sid",e),this.joinSession(n)}else"agent"===t?(e=l.getState("sid"),this.joinSession(d.href)):(t="user",
this.createSession({sid:e,url:d.href}));this.session.sid=e,this.session.entity=t,l.saveState("entity",t,"session")},s.prototype.createSession=function(t){var e={method:"createSession",params:{url:t.url||d.href,lang:this.detectLanguage()}};return t.sid&&(e.params.sid=t.sid),this.websocket?this.sendData(e):void c.post(this.options.serverUrl,e,function(e,n){return e?void this.emit("Error",e,{method:"createSession",params:t}):void this.emit("session/create",n.result)}.bind(this))},s.prototype.joinSession=function(t){this.openShareInteval=setInterval(function(){this.openShare(t)}.bind(this),3e3),n.onclose=function(){this.shareClosed()}.bind(this)},s.prototype.updateEvents=function(t,e){if(this.session.sharedId)return data={method:"events",params:{sid:this.session.sid,id:this.session.sharedId,timestamp:l.getState("eventTimestamp","cache"),events:t}},this.websocket?this.sendData(data):void c.post(this.options.serverUrl,data,function(t,n){return t?(this.emit("Error",t,data),e(t)):void(n.result.timestamp>l.getState("eventTimestamp","cache")?(l.saveState("eventTimestamp",n.result.timestamp,"cache"),e&&e(null,n.result)):e&&e(null,{events:[]}))}.bind(this))},s.prototype.getLanguages=function(t){u.log("this.session: ",this.session),t(null,this.session.langs)},s.prototype.chatRequest=function(t,e){t.sid=this.session.sid,u.log("chatRequest params: ",t);var n={method:"chatRequest",params:t};return this.setSessionTimeout(),this.websocket?this.sendData(n):void c.post(this.options.serverUrl,n,function(n,s){return n?(this.emit("Error",n,{method:"chatRequest",params:t}),void(e&&e(n))):(t.url=d.href,this.emit("chat/start",f.merge(t,s.result)),void(e&&e(null,s)))}.bind(this))},s.prototype.getMessages=function(t){c.post(this.options.serverUrl,{method:"getMessages",params:{sid:this.session.sid,timestamp:l.getState("msgTimestamp")}},function(e,n){return e?(this.emit("Error",e,{method:"getMessages"}),t(e)):(n.result.timestamp>l.getState("msgTimestamp")&&(l.saveState("msgTimestamp",n.result.timestamp),n.result.messages&&this.emit("message/new",n.result)),n.result.typing&&this.emit("message/typing",n.result),void(t&&t(null,n.result)))}.bind(this))},s.prototype.closeChat=function(t){var e={method:"closeChat",params:{sid:this.session.sid}};return t&&(e.params.rating=t),this.websocket?this.sendData(e):void c.post(this.options.serverUrl,e,function(n,s){return n?void this.emit("Error",n,e):(l.saveState("chat",!1),void this.emit("chat/close",{rating:t,url:d.href}))}.bind(this))},s.prototype.sendMessage=function(t,e){var n={method:"message",params:{sid:this.session.sid,content:t.message}};if(this.setSessionTimeout(),this.websocket)return void(t.file?(n=i({file:t.file,filename:t.message,sid:this.session.sid}),c.upload("https://"+g,n,function(t,e){console.error("sendMessage: ",t,e)})):(n.params.content=t.message,this.sendData(n)))},s.prototype.sendEmail=function(t,e){t.sid=this.session.sid;var n={method:"sendMail",params:t};return this.websocket?this.sendData(n):void c.post(this.options.serverUrl,n,function(n,s){return n?(this.emit("Error",n,{method:"sendEmail",params:t}),void(e&&e(n))):(this.emit("chat/send",t),void(e&&e(null,s)))}.bind(this))},s.prototype.requestCallback=function(t,e){t.sid=this.session.sid;var n={method:"requestCallback",params:t};return this.websocket?this.sendData(n):void c.post(this.options.serverUrl,n,function(n,s){return n?(this.emit("Error",n,{method:"requestCallback",params:t}),e(n)):void(e&&e(null,s.result))}.bind(this))},s.prototype.disjoinSession=function(t){var e={method:"disjoinSession",params:{sid:t}};return this.websocket?this.sendData(e):void c.post(this.options.serverUrl,e,function(e,n){return e?void this.emit("Error",e,{method:"disjoinSession",params:{sid:t}}):void this.emit("session/disjoin",{url:d.href})}.bind(this))},s.prototype.shareOpened=function(){var t={method:"shareOpened",params:{id:this.session.sharedId,url:d.href}};if(this.websocket)return this.sendData(t)},s.prototype.shareClosed=function(){var t={method:"shareClosed",params:{id:this.session.sharedId,url:d.href}};if(this.websocket)return this.sendData(t)},s.prototype.openShare=function(t){var e={method:"openShare",params:{sid:this.session.sid,url:t}};return this.websocket?this.sendData(e):void c.post(this.options.serverUrl,e,function(t,e){if(t)return void this.emit("Error",t,{method:"openShare",params:{state:state}})}.bind(this))},s.prototype.setChatTimeout=function(t){return setTimeout(function(){this.emit("chat/timeout")}.bind(this),1e3*t)},s.prototype.userIsTyping=function(){var t={method:"typing",params:{sid:this.session.sid}};return this.websocket?this.sendData(t):void c.post(this.options.serverUrl,t,function(t){if(t)return void this.emit("Error",t,{method:"setChatTimeout"})}.bind(this))},s.prototype.updateUrl=function(t){var e={method:"updateUrl",params:{sid:this.session.sid,url:t}};return this.websocket?this.sendData(e):void c.post(this.options.serverUrl,e,function(e,n){if(e)return void this.emit("Error",e,{method:"updateUrl",params:{url:t}})}.bind(this))},s.prototype.linkFollowed=function(t){var e={method:"linkFollowed",params:{sid:this.session.sid,url:t}};return this.websocket?this.sendData(e):void c.post(this.options.serverUrl,e,function(e,n){if(e)return void this.emit("Error",e,{method:"linkFollowed",params:{url:t}})}.bind(this))},s.prototype.detectLanguage=function(t){var e,n=l.getState("lang","session"),s=[];for(var a in t)s.push(a);return n?e=n:this.session.lang?e=this.session.lang:this.session.properties&&this.session.properties.lang?e=this.session.properties.lang:(this.session.langFromUrl||this.session.properties&&this.session.properties.langFromUrl)&&d.pathname.split("/").map(function(t){return t=r(t),s.indexOf(t)!==-1&&(e=t),t}),e||(e=(navigator.language||navigator.userLanguage).split("-")[0]),s.indexOf(e)===-1&&(e="en"),u.log("detected lang: ",s,n,this.session.lang,this.session.langFromUrl,e),this.session.lang=e,e},s.prototype.getSidFromUrl=function(t){var e=t.substring(t.indexOf("chatSessionId="));return e=e.substring(e.indexOf("=")+1)},s.prototype.createWebsocket=function(t){var e="wss:",s=new WebSocket(e+"//"+g,"json.api.smile-soft.com");s.onopen=function(t){u.log("WebSocket opened: ",t),m=1,h||this.init()}.bind(this),s.onmessage=this.onWebsocketMessage.bind(this),s.onclose=this.onWebsocketClose.bind(this),s.onerror=this.onError,n.onbeforeunload=function(){s.onclose=function(){},s.close()},this.websocket=s},s.prototype.onWebsocketClose=function(t){u.log("WebSocket closed",t);var e=a(m);setTimeout(function(){m++,this.createWebsocket()}.bind(this),e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./debug":63,"./lodash-fns":64,"./request":66,"./storage":67,events:2,inherits:3}],63:[function(t,e,n){(function(t){function n(e,n){if(t.localStorage.getItem("swc.debug"))return void[].forEach.call(e,function(e){t.console[n]?t.console[n](e):t.console.log(e)})}e.exports={log:function(){n(arguments,"log")},info:function(){n(arguments,"info")},warn:function(){n(arguments,"warn")},error:function(){n(arguments,"error")}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],64:[function(t,e,n){function s(t,e,n){var s;return function(){var a=this,r=arguments,i=function(){s=null,n||t.apply(a,r)},o=n&&!s;clearTimeout(s),s=setTimeout(i,e),o&&t.apply(a,r)}}function a(t,e){for(var n=e.charAt(0);t&&t!==document;t=t.parentNode)if("."===n){if(t.classList.contains(e.substr(1)))return t}else if("#"===n){if(t.id===e.substr(1))return t}else if("["===n){if(t.hasAttribute(e.substr(1,e.length-2)))return t}else if(t.nodeName===e.toUpperCase())return t;return!1}function r(t,e,n,s,a){var r=Number(new Date)+(s||2e3);a=a||300,function i(){t()?e():Number(new Date)<r?setTimeout(i,a):n(new Error("timed out for "+t+": "+arguments))}()}var i=t("lodash/string/template"),o=t("lodash/collection/foreach"),l=t("lodash/object/merge"),c=t("lodash/function/throttle");e.exports={template:i,forEach:o,merge:l,throttle:c,debounce:s,poll:r,findParent:a}},{"lodash/collection/foreach":4,"lodash/function/throttle":8,"lodash/object/merge":54,"lodash/string/template":56}],65:[function(t,e,n){var s=t("./widget.js");t("./core.js");e.exports=s.module},{"./core.js":62,"./widget.js":70}],66:[function(t,e,n){function s(t,e,n){o("POST",t,e,function(t,e){return l.log("post respose: ",t,e),t?n(t):void n(null,e)})}function a(t,e,n){return t&&c[t]?n(null,c[t]):void o("GET",e,null,function(e,s){return e?n(e):(t&&(c[t]=s),void n(null,s))})}function r(t,e,n){o("PUT",t,e,function(t,e){return l.log("put respose: ",t,e),t?n(t):void n(null,e)})}function i(t,e,n){o("POST",t,e,function(t,e){return l.log("post respose: ",t,e),t?n(t):void n(null,e)})}function o(t,e,n,s){var a,r,i;a=new XMLHttpRequest,a.open(t,e,!0),i=setTimeout(function(){a.abort()},6e4),a.onreadystatechange=function(){if(4==a.readyState&&(clearTimeout(i),a.response)){if(r="POST"===t?JSON.parse(a.response):a.response,r.error)return s(r.error);s(null,r)}},l.log("XmlHttpRequest: ",n),"POST"===t&&("object"!=typeof n||n instanceof FormData||(n=JSON.stringify(n),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"))),n?a.send(n):a.send()}var l=t("./debug"),c={};e.exports={post:s,get:a,put:r,upload:i}},{"./debug":63}],67:[function(t,e,n){(function(t){function n(t,e){return"session"===e?JSON.parse(c.getItem(u+d+t)):JSON.parse(l.getItem(u+d+t))}function s(t,e,n){return"session"===n?c.setItem(u+d+t,JSON.stringify(e)):l.setItem(u+d+t,JSON.stringify(e)),e}function a(t,e){"session"===e?c.removeItem(u+d+t):l.removeItem(u+d+t)}function r(t,e){return e?"cache"===e?f[t]:n(t,e):void 0!==f[t]&&null!==f[t]?f[t]:n(t)}function i(t,e,n){return f[t]=e,"cache"!==n&&s(t,e,n),e}function o(t,e){delete f[t],a(t)}var l=t.localStorage,c=t.sessionStorage,u="swc",d=".",f={sid:null,eventTimestamp:0,msgTimestamp:0,entity:null,chat:null};e.exports={get:n,set:s,remove:a,getState:r,saveState:i,removeState:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],68:[function(require,module,exports){var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(t){return t?String(t).replace(escapeRegexp,function(t){return escapeMap[t]}):""},exports.email=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){var prefix=defaults.prefix;__p+='\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml">\n    <head>\n        <meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />\n        <!--[if !mso]><!-->\n            <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n        <!--<![endif]-->\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title></title>\n        <!--[if (gte mso 9)|(IE)]>\n        <style type="text/css">\n            table {border-collapse: collapse;}\n        </style>\n        <![endif]-->\n        <style type="text/css">\n            /* Basics */\n            body {\n            Margin: 0;\n                padding: 0;\n                min-width: 100%;\n                background-color: #ffffff;\n            }\n            table {\n                border-spacing: 0;\n                font-family: sans-serif;\n                color: #333333;\n            }\n            td {\n                padding: 0;\n            }\n            img {\n                border: 0;\n            }\n            .wrapper {\n                width: 100%;\n                table-layout: fixed;\n                -webkit-text-size-adjust: 100%;\n                -ms-text-size-adjust: 100%;\n                background-color: #F1F1F1;\n            }\n            .webkit {\n                max-width: 500px;\n            }\n            .outer {\n            Margin: 0 auto;\n                height: 100%;\n                width: 95%;\n                max-width: 500px;\n                padding: 10px;\n            }\n            p {\n                Margin: 0;\n            }\n            a {\n                color: #ee6a56;\n                text-decoration: underline;\n            }\n            .h1 {\n                font-size: 21px;\n                font-weight: bold;\n                Margin-bottom: 18px;\n            }\n            .h2 {\n                font-size: 18px;\n                font-weight: bold;\n                Margin-bottom: 12px;\n            }\n             \n            /* One column layout */\n            .one-column .contents {\n                text-align: left;\n                color:#505050;\n                font-family:Arial;\n                font-size:14px;\n                line-height:150%;\n            }\n            .one-column p {\n                font-size: 14px;\n                Margin-bottom: 10px;\n            }\n            .'+__e(prefix)+"-message {\n                display: block;\n                margin-bottom: 10px;\n                padding: 10px;\n                background-color: #FFFFFF;\n                border-bottom: 4px solid #CCCCCC;\n            }\n            ."+__e(prefix)+"-message img {\n                width: 100%;\n                max-width: 500px;\n                height: auto;\n            }\n            ."+__e(prefix)+"-message span {\n                font-weight: bold;\n                color: #999999;\n            }\n            ."+__e(prefix)+"-agent-msg ."+__e(prefix)+"-message-from {\n                color: #555555;\n            }\n            ."+__e(prefix)+"-user-msg ."+__e(prefix)+"-message-from {\n                color: #F75B5D;\n            }\n\n            ."+__e(prefix)+"-message ."+__e(prefix)+'-message-time {\n                position: relative;\n                float: right;\n            }\n            .copyright {\n                margin-top: 5px;\n                font-size: 12px;\n                font-style: italic;\n                color: #CCCCCC;\n                text-align: right;\n            }\n\n        </style>\n    </head>\n    <body>\n        <center class="wrapper">\n            <div class="webkit">\n                <!--[if (gte mso 9)|(IE)]>\n                <table width="500" align="center" cellpadding="0" cellspacing="0" border="0">\n                <tr>\n                <td>\n                <![endif]-->\n                <table class="outer" align="center" cellpadding="0" cellspacing="0" border="0">\n                    <tr>\n                        <td class="one-column">\n                            <table width="100%">\n                                <tr>\n                                    <td class="inner contents">\n                                        '+(null==(__t=content)?"":__t)+"\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                </table>\n                <!--[if (gte mso 9)|(IE)]>\n                </td>\n                </tr>\n                </table>\n                <![endif]-->\n            </div>\n        </center>\n    </body>\n</html>"}return __p};var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(t){return t?String(t).replace(escapeRegexp,function(t){return escapeMap[t]}):""},exports.forms=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="'+__e(defaults.prefix)+"-message "+__e(defaults.prefix)+"-"+__e(message.entity)+'-msg">\n\t<span class="'+__e(defaults.prefix)+'-message-from">'+__e(message.from)+'</span>\n\t<div class="'+__e(defaults.prefix)+'-message-content" ',"user"===message.entity&&(__p+=" style=\"border-color:'"+__e(defaults.styles.primary.backgroundColor)+'" '),__p+='>\n\t\t<form id="'+__e(defaults.prefix)+"-"+__e(form.name)+'" name="'+__e(form.name)+'" ',form.autocomplete&&(__p+='autocomplete="on"'),__p+=' data-validate-form="true">\n\t\t\t',form.description&&(__p+='\n\t\t\t\t<p style="margin: 10px 0">'+(null==(__t=frases.FORMS.DESCRIPTIONS[form.description]||form.description)?"":__t)+"</p>\n\t\t\t"),__p+="\n\t\t\t",_.forEach(form.fields,function(t){__p+="\n\t\t\t\t","select"===t.type?(__p+='\n\t\t\t\t\t<select name="'+__e(t.name)+'">\n\t\t\t\t\t\t',_.forEach(t.options,function(t){__p+='\n\t\t\t\t\t\t\t<option value="'+__e(t.value)+'" ',t.selected&&(__p+=" selected "),__p+=" >\n\t\t\t\t\t\t\t\t"+__e(frases.FORMS.PLACEHOLDERS[t.text]||t.text)+"\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t</select>\n\t\t\t\t"):"textarea"===t.type?(__p+='\n\t\t\t\t\t<textarea \n\t\t\t\t\t\tname="'+__e(t.name)+'"\n\t\t\t\t\t\tplaceholder="'+(null==(__t=frases.FORMS.PLACEHOLDERS[t.placeholder]||frases.FORMS.PLACEHOLDERS[t.name])?"":__t)+" ",t.required&&(__p+="*"),__p+='"\n\t\t\t\t\t></textarea>\n\t\t\t\t'):(__p+='\n\t\t\t\t\t<input \n\t\t\t\t\t\ttype="'+(null==(__t=t.type||"text")?"":__t)+'"\n\t\t\t\t\t\tplaceholder="'+(null==(__t=frases.FORMS.PLACEHOLDERS[t.placeholder]||frases.FORMS.PLACEHOLDERS[t.name])?"":__t)+" ",t.required&&(__p+="*"),__p+='"\n\t\t\t\t\t\tname="'+__e(t.name)+'" ',t.value&&(__p+='\n\t\t\t\t\t\tvalue="'+__e(credentials[t.value])+'" '),__p+=" ",t.required&&(__p+="required"),__p+="\n\t\t\t\t\t/>\n\t\t\t\t"),__p+="\n\t\t\t"}),__p+='\n\t\t\t<button \n\t\t\t\ttype="submit"\n\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block"\n\t\t\t\tstyle="background-color: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+"; border: 1px solid "+__e(defaults.styles.primary.backgroundColor)+';">'+__e(frases.FORMS.send)+'</button>\n\t\t\t<button\n\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block"\n\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="rejectForm">'+__e(frases.FORMS.cancel)+'</button>\n\t\t</form>\n\t</div>\n\t<span class="'+__e(defaults.prefix)+'-message-time"> '+__e(message.time)+"</span>\n</div>";return __p};var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(t){return t?String(t).replace(escapeRegexp,function(t){return escapeMap[t]}):""},exports.message=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="'+__e(defaults.prefix)+"-message "+__e(defaults.prefix)+"-"+__e(message.entity)+'-msg">\n\t<span class="'+__e(defaults.prefix)+'-message-from">'+__e(message.from)+'</span>\n\t<div class="'+__e(defaults.prefix)+'-message-content"\n\t\t',"user"!==message.entity&&(__p+=' \n\t\t\tstyle="border-color:'+(null==(__t=defaults.styles.primary.backgroundColor)?"":__t)+'" \n\t\t'),__p+=">\n\t\t<p>"+(null==(__t=message.content)?"":__t)+'</p>\n\t</div>\n\t<span class="'+__e(defaults.prefix)+'-message-time"> '+__e(message.time)+"</span>\n</div>";return __p};var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(t){return t?String(t).replace(escapeRegexp,function(t){return escapeMap[t]}):""},exports.widget=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){var frases=translations;__p+="\n";var panels=frases.PANELS;__p+="\n";var channels=defaults.channels;__p+="\n";var positionClass="right"===defaults.position?"position-right":"position-left";__p+='\n<div id="'+__e(defaults.prefix)+'-wg-cont" class="'+__e(defaults.prefix)+"-wg-cont "+__e(positionClass)+'">\n\n\t<!-- ***** Panes container ***** -->\n\t<div \n\t\tid="'+__e(defaults.prefix)+'-wg-panes" \n\t\tclass="'+__e(defaults.prefix)+'-wg-panes" \n\t\tstyle="',defaults.styles.width&&(__p+="width: "+__e(defaults.styles.width)+";"),__p+='">\n\n\t\t<!-- ***** Top bar ***** -->\n\t\t<div \n\t\t\tclass="'+__e(defaults.prefix)+'-top-bar" \n\t\t\tstyle="background: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+';">\n\n\t\t\t<!-- Main title -->\n\t\t\t<h4 class="'+__e(defaults.prefix)+"-wg-title "+__e(defaults.prefix)+'-uppercase">\n\t\t\t\t'+__e(defaults.title||frases.TOP_BAR.title)+'\n\t\t\t</h4>\n\n\t\t\t<div class="'+__e(defaults.prefix)+'-wg-state-cont">\n\t\t\t\t<!-- <span class="'+__e(defaults.prefix)+'-wg-state-icon"> </span> -->\n\t\t\t\t<span class="'+__e(defaults.prefix)+'-wg-state"></span>\n\t\t\t</div>\n\n\t\t\t<!-- Action buttons (minimize, close) -->\n\t\t\t<div class="'+__e(defaults.prefix)+'-wg-minimize">\n\n\t\t\t\t<!--<a \n\t\t\t\t\thref="#" \n\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="closeWidget">\n\t\t\t\t\t\n\t\t\t\t\t<span style="font-weight: bold">_</span>\n\t\t\t\t\n\t\t\t\t</a>-->\n\t\t\t\t\n\t\t\t\t<a \n\t\t\t\t\thref="#" \n\t\t\t\t\tstyle="color: '+__e(defaults.styles.primary.color)+'"\n\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="closeWidget"\n\t\t\t\t\t<span class="'+__e(defaults.prefix)+'-icon-close"></span>\n\n\t\t\t\t</a>\n\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Top bar ends ***** -->\n\n\t\t<!-- ***** Connection types pane ***** -->\n\t\t<div \n\t\t\tclass="'+__e(defaults.prefix)+'-wg-pane" \n\t\t\tdata-'+__e(defaults.prefix)+'-pane="chooseConnection">\n\t\t\t\n\t\t\t<!-- Panel\'s image container -->\n\t\t\t<div \n\t\t\t\tclass="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-dark" \n\t\t\t\t',defaults.styles.intro.backgroundImage&&(__p+=' \n\t\t\t\t\tstyle="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.intro.backgroundImage)+')" \n\t\t\t\t'),__p+='>\n\n\t\t\t\t<!-- The text displayed on image -->\n\t\t\t\t<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-white">\n\t\t\t\t\t<br>\n\t\t\t\t\t<p>'+__e(panels.CONNECTION_TYPES.choose_conn_type)+'</p>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\n\t\t\t\t<form \n\t\t\t\t\tid="'+__e(defaults.prefix)+'-init-form" \n\t\t\t\t\tname="'+__e(defaults.prefix)+'InitForm">\n\n\t\t\t\t\t',channels.webrtc&&(__p+=" \n\t\t\t\t\t\t<!-- Display call button if WebRTC is enabled and supported by the browser -->\n\t\t\t\t\t\t",defaults.webrtcEnabled?__p+=' \n\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\ttype="button" \n\t\t\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n\t\t\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\t\t\tbackground: '+__e(defaults.styles.primary.backgroundColor)+"; \n\t\t\t\t\t\t\t\t\tcolor: "+__e(defaults.styles.primary.color)+"; \n\t\t\t\t\t\t\t\t\tborder: 1px solid "+__e(defaults.styles.primary.color)+';"\n\t\t\t\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="initCall">\n\n\t\t\t\t\t\t\t\t'+__e(panels.CONNECTION_TYPES.call_agent_btn)+"\n\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<!-- If WebRTC is not supported and fallback is set -->\n\t\t\t\t\t\t":channels.webrtc.fallback&&channels.webrtc.fallback.sipCall&&(__p+='\n\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\ttype="button" \n\t\t\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n\t\t\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\t\t\tbackground: '+__e(defaults.styles.primary.backgroundColor)+"; \n\t\t\t\t\t\t\t\t\tcolor: "+__e(defaults.styles.primary.color)+"; \n\t\t\t\t\t\t\t\t\tborder: 1px solid "+__e(defaults.styles.primary.color)+';"\n\t\t\t\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="initFallbackCall">\n\n\t\t\t\t\t\t\t\t'+__e(panels.CONNECTION_TYPES.call_agent_btn)+"\n\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t"),__p+="\n\n\t\t\t\t\t<!-- Display callback button if callback task is configured in the settings -->\n\t\t\t\t\t",channels.callback&&channels.callback.task&&(__p+='\n\t\t\t\t\t\t<button \n\t\t\t\t\t\t\ttype="button" \n\t\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n\t\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\t\tbackground: '+__e(defaults.styles.primary.backgroundColor)+"; \n\t\t\t\t\t\t\t\tcolor: "+__e(defaults.styles.primary.color)+"; \n\t\t\t\t\t\t\t\tborder: 1px solid "+__e(defaults.styles.primary.color)+';"\n\t\t\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="initCallback">\n\n\t\t\t\t\t\t\t'+__e(panels.CONNECTION_TYPES.callback_btn)+"\n\n\t\t\t\t\t\t</button>\n\t\t\t\t\t"),__p+="\n\n\t\t\t\t\t<!-- Init chat button -->\n\t\t\t\t\t",defaults.chat&&(__p+='\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype="button" \n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n\t\t\t\t\t\tstyle="background: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+"; border: 1px solid "+__e(defaults.styles.primary.color)+';"\n\t\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="initChat">\n\t\t\t\t\t\t'+__e(panels.CONNECTION_TYPES.chat_agent_btn)+"\n\t\t\t\t\t</button>\n\t\t\t\t\t"),__p+='\n\n\t\t\t\t\t<!-- Close widget button -->\n\t\t\t\t\t<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.CONNECTION_TYPES.cancel)+"</a>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Connection types pane ends ***** -->\n\n\t\t<!-- ***** Intro pane. Displayed if configured in the settings object. ***** -->\n\t\t",defaults.intro&&defaults.intro.length&&(__p+='\n\t\t\t<div \n\t\t\t\tclass="'+__e(defaults.prefix)+'-wg-pane" \n\t\t\t\tdata-'+__e(defaults.prefix)+'-pane="credentials">\n\n\t\t\t\t<!-- Panel\'s image container -->\n\t\t\t\t<div \n\t\t\t\t\tclass="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-dark" \n\t\t\t\t\t',defaults.styles.intro.backgroundImage&&(__p+=' \n\t\t\t\t\t\tstyle="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.intro.backgroundImage)+')" \n\t\t\t\t\t'),__p+='>\n\n\t\t\t\t\t<!-- The text displayed on image -->\n\t\t\t\t\t<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-white">\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t<p>'+__e(defaults.introMessage||panels.INTRO.intro_message)+'</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\n\t\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\t\t\t\t\t<form \n\t\t\t\t\t\tid="'+__e(defaults.prefix)+'-intro-form" \n\t\t\t\t\t\tname="'+__e(defaults.prefix)+'IntroForm" \n\t\t\t\t\t\tdata-validate-form="true">\n\n\t\t\t\t\t\t<!-- Iterating over intro array, which is a list of objects -->\n\t\t\t\t\t\t',_.forEach(defaults.intro,function(t){__p+="\n\t\t\t\t\t\t\t","lang"===t.name?(__p+='\n\t\t\t\t\t\t\t\t<select name="lang">\n\t\t\t\t\t\t\t\t\t',_.forEach(languages,function(t){__p+='\n\t\t\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\t\t\tvalue="'+__e(t)+'" \n\t\t\t\t\t\t\t\t\t\t\t',t===currLang&&(__p+=" selected "),__p+=" >\n\t\t\t\t\t\t\t\t\t\t\t"+__e(translations[t].lang)+"\n\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t"):"message"===t.name?(__p+='\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tname="message"\n\t\t\t\t\t\t\t\t\tplaceholder="'+(null==(__t=t.placeholder||panels.INTRO.PLACEHOLDERS[t.name])?"":__t)+" ",t.required&&(__p+=" * "),__p+='"\n\t\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t\t'):"checkbox"===t.type?(__p+='\n\t\t\t\t\t\t\t\t<label for="'+__e(defaults.sid)+"-"+__e(t.name)+'">\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\ttype="checkbox" \n\t\t\t\t\t\t\t\t\tid="'+__e(defaults.sid)+"-"+__e(t.name)+'"\n\t\t\t\t\t\t\t\t\tname="'+__e(t.name)+'" \n\t\t\t\t\t\t\t\t\t',t.required&&(__p+=" required "),__p+=">\n\t\t\t\t\t\t\t\t\t"+__e(t.placeholder)+"\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t"):(__p+='\n\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\ttype="'+(null==(__t=t.type||"text")?"":__t)+'" \n\t\t\t\t\t\t\t\t\tplaceholder="'+(null==(__t=t.placeholder||panels.INTRO.PLACEHOLDERS[t.name])?"":__t)+" ",t.required&&(__p+=" * "),__p+='" \n\t\t\t\t\t\t\t\t\tname="'+__e(t.name)+'" \n\t\t\t\t\t\t\t\t\t',t.save&&(__p+=' value="'+__e(credentials[t.name])+'" '),__p+=" \n\t\t\t\t\t\t\t\t\t",t.required&&(__p+=" required "),__p+=">\n\t\t\t\t\t\t\t"),__p+="\n\n\t\t\t\t\t\t"}),__p+='\n\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t<!-- Init chat with intro properties -->\n\t\t\t\t\t\t<button \n\t\t\t\t\t\t\ttype="submit" \n\t\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n\t\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\t\tbackground: '+__e(defaults.styles.primary.backgroundColor)+"; \n\t\t\t\t\t\t\t\tcolor: "+__e(defaults.styles.primary.color)+"; \n\t\t\t\t\t\t\t\tborder: 1px solid "+__e(defaults.styles.primary.color)+';">\n\n\t\t\t\t\t\t\t'+__e(panels.INTRO.start_dialog_button)+'\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<!-- Close widget button -->\n\t\t\t\t\t\t<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.INTRO.cancel)+"</a>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"),__p+='\n\t\t<!-- ***** Intro pane ends ***** -->\n\n\t\t<!-- ***** Messages pane ***** -->\n\t\t<div  class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="messages">\n\t\t\t\n\t\t\t<!-- Messages container -->\n\t\t\t<ul \n\t\t\t\tid="'+__e(defaults.prefix)+'-messages-cont" \n\t\t\t\tclass="'+__e(defaults.prefix)+'-messages-cont" \n\t\t\t\tstyle="\n\t\t\t\t\t',defaults.styles.height&&(__p+="\n\t\t\t\t\t\theight: "+__e(defaults.styles.height)+";\n\t\t\t\t\t"),__p+='">\n\t\t\t\t\t\n\t\t\t</ul>\n\n\t\t\t<div class="'+__e(defaults.prefix)+'-write-cont">\n\t\t\t\t\n\t\t\t\t<!-- End dialog button -->\n\t\t\t\t<div class="'+__e(defaults.prefix)+'-action-btns">\n\t\t\t\t\t<a href="#" class="'+__e(defaults.prefix)+'-end-dialog-btn" data-'+__e(defaults.prefix)+'-handler="finish">'+__e(panels.MESSAGES.end_dialog)+'</a>\n\t\t\t\t\t<a href="#" class="'+__e(defaults.prefix)+'-trigger-sounds-btn" data-'+__e(defaults.prefix)+'-handler="triggerSounds">\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tclass="',__p+=defaults.sounds?__e(defaults.prefix)+"-icon-bell":__e(defaults.prefix)+"-icon-bell-slash",__p+='">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- "Agent is typing" indicator -->\n\t\t\t\t<div class="'+__e(defaults.prefix)+'-loader">\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<span></span>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- "Attach file" button -->\n\t\t\t\t<label \n\t\t\t\t\tclass="'+__e(defaults.prefix)+'-sendfile-cont" \n\t\t\t\t\tfor="'+__e(defaults.prefix)+'-file-select">\n\n\t\t\t\t\t<input \n\t\t\t\t\t\ttype="file" \n\t\t\t\t\t\tid="'+__e(defaults.prefix)+'-file-select">\n\t\t\t\t\t\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+'-icon-upload" \n\t\t\t\t\t\tstyle="color: '+__e(defaults.styles.primary.backgroundColor)+'">\n\t\t\t\t\t</span>\n\n\t\t\t\t</label>\n\n\t\t\t\t<div id="'+__e(defaults.prefix)+'-message-text-clone"  class="'+__e(defaults.prefix)+'-msg-textarea-clone" ></div>\n\n\t\t\t\t<!-- Field for typing the user message -->\n\t\t\t\t<textarea \n\t\t\t\t\tid="'+__e(defaults.prefix)+'-message-text" \n\t\t\t\t\tclass="'+__e(defaults.prefix)+'-msg-textarea" \n\t\t\t\t\tplaceholder="'+__e(panels.MESSAGES.PLACEHOLDERS.message)+'" \n\t\t\t\t\tmaxlength="1000"></textarea>\n\t\t\t\t\n\t\t\t\t<!-- "Send a message" button -->\n\t\t\t\t<a \n\t\t\t\t\thref="#" \n\t\t\t\t\tclass="'+__e(defaults.prefix)+"-sendmsg-btn "+__e(defaults.prefix)+'-button" \n\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="sendMessage">\n\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+'-icon-paper-plane" \n\t\t\t\t\t\tstyle="color: '+__e(defaults.styles.primary.backgroundColor)+'">\n\t\t\t\t\t</span>\n\t\t\t\t</a>\n\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Messages pane ends ***** -->\n\n\t\t<!-- ***** Offline pane ***** -->\n\t\t<div \n\t\t\tclass="'+__e(defaults.prefix)+'-wg-pane" \n\t\t\tdata-'+__e(defaults.prefix)+'-pane="sendemail">\n\n\t\t\t<!-- Panel\'s image container -->\n\t\t\t<div \n\t\t\t\tclass="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-dark" \n\t\t\t\t',
defaults.styles.sendmail.backgroundImage&&(__p+=' \n\t\t\t\t\tstyle="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.sendmail.backgroundImage)+')" \n\t\t\t\t'),__p+='>\n\n\t\t\t\t<!-- The text displayed on image -->\n\t\t\t\t<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-dark">\n\t\t\t\t\t<p>'+__e(panels.OFFLINE.offline_message)+'</p>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\t\t\t\t<h4 class="'+__e(defaults.prefix)+'-uppercase">'+__e(panels.OFFLINE.send_message_header)+'</h4>\n\t\t\t\t<form id="'+__e(defaults.prefix)+'-sendmail-form" data-validate-form="true">\n\t\t\t\t\t<input type="text" name="uname" placeholder="'+__e(panels.OFFLINE.PLACEHOLDERS.uname)+'">\n\t\t\t\t\t<input type="email" name="email" placeholder="'+__e(panels.OFFLINE.PLACEHOLDERS.email)+' *" required>\n\t\t\t\t\t<textarea name="text" placeholder="'+__e(panels.OFFLINE.PLACEHOLDERS.message)+'" maxlength="1500"></textarea>\n\n\t\t\t\t\t<!--<input type="file" name="file" id="'+__e(defaults.prefix)+'-contactfile" class="'+__e(defaults.prefix)+'-inputfile" />\n\t\t\t\t\t<label for="'+__e(defaults.prefix)+'-contactfile">'+__e(panels.OFFLINE.choose_file)+'</label> -->\n\n\t\t\t\t\t<!-- "Send offline message" button -->\n\t\t\t\t\t<button \n\t\t\t\t\t\ttype="submit" \n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\tbackground: '+__e(defaults.styles.primary.backgroundColor)+"; \n\t\t\t\t\t\t\tcolor: "+__e(defaults.styles.primary.color)+"; \n\t\t\t\t\t\t\tborder: 1px solid "+__e(defaults.styles.primary.color)+';">\n\n\t\t\t\t\t\t'+__e(panels.OFFLINE.send_message_button)+'\n\t\t\t\t\t\t\t\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<!-- Close widget button -->\n\t\t\t\t\t<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.OFFLINE.close)+'</a>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Offline pane ends ***** -->\n\n\t\t<!-- ***** Close chat pane ***** -->\n\t\t<div \n\t\t\tclass="'+__e(defaults.prefix)+'-wg-pane" \n\t\t\tdata-'+__e(defaults.prefix)+'-pane="closechat">\n\n\t\t\t<!-- Panel\'s image container -->\n\t\t\t<div \n\t\t\t\tclass="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-white" \n\t\t\t\t',defaults.styles.closeChat.backgroundImage&&(__p+=' \n\t\t\t\t\tstyle="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.closeChat.backgroundImage)+')" \n\t\t\t\t'),__p+='>\n\n\t\t\t\t<!-- The text displayed on image -->\n\t\t\t\t<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-white">\n\t\t\t\t\t<br>\n\t\t\t\t\t<p>'+__e(panels.CLOSE_CHAT.close_chat_header)+'</p>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\t\t\t\t<form id="'+__e(defaults.prefix)+'-closechat-form" data-validate-form="true">\n\t\t\t\t\t<label for="'+__e(defaults.prefix)+'-send-dialog">\n\t\t\t\t\t\t<input type="checkbox" name="sendDialog" id="'+__e(defaults.prefix)+'-send-dialog" />\n\t\t\t\t\t\t<span>'+__e(panels.CLOSE_CHAT.send_dialog_label)+'</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<input type="email" name="email" placeholder="'+__e(panels.CLOSE_CHAT.PLACEHOLDERS.email)+'">\n\t\t\t\t\t<select name="rating">\n\t\t\t\t\t\t<option value="">--- '+__e(panels.CLOSE_CHAT.rate_agent)+' ---</option>\n\t\t\t\t\t\t<option value="5">'+__e(frases.AGENT_RATES.excellent)+'</option>\n\t\t\t\t\t\t<option value="4">'+__e(frases.AGENT_RATES.good)+'</option>\n\t\t\t\t\t\t<option value="3">'+__e(frases.AGENT_RATES.fair)+'</option>\n\t\t\t\t\t\t<option value="2">'+__e(frases.AGENT_RATES.bad)+'</option>\n\t\t\t\t\t</select>\n\t\t\t\t\t<textarea placeholder="'+__e(panels.CLOSE_CHAT.PLACEHOLDERS.comment)+'" name="text" maxlength="1500"></textarea>\n\n\t\t\t\t\t<!-- End chat and close widget button -->\n\t\t\t\t\t<button \n\t\t\t\t\t\ttype="submit" \n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\tbackground: '+__e(defaults.styles.primary.backgroundColor)+"; \n\t\t\t\t\t\t\tcolor: "+__e(defaults.styles.primary.color)+"; \n\t\t\t\t\t\t\tborder: 1px solid "+__e(defaults.styles.primary.color)+';">\n\n\t\t\t\t\t\t'+__e(panels.CLOSE_CHAT.finish_dialog_button)+'\n\t\t\t\t\t\t\t\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<!-- "Back to the chat" button -->\n\t\t\t\t\t<a href="#messages" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CLOSE_CHAT.back)+'</a>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Close chat pane ends ***** -->\n\n\t\t<!-- ***** Audio call pane ***** -->\n\t\t<div class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="callAgent">\n\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\t\t\t\t<div id="'+__e(defaults.prefix)+'-call-spinner" class="'+__e(defaults.prefix)+'-spinner-pane">\n\t\t\t\t\t<h3 class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.AUDIO_CALL.confirm_access)+'</h3>\n\t\t\t\t\t<h3 class="'+__e(defaults.prefix)+"-text-center "+__e(defaults.prefix)+"-loader "+__e(defaults.prefix)+'-shown" style="position: relative;">\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t</h3>\n\t\t\t\t</div>\n\t\t\t\t<div id="'+__e(defaults.prefix)+'-call-info" class="'+__e(defaults.prefix)+'-hidden">\n\t\t\t\t\t<h3 class="'+__e(defaults.prefix)+'-text-center" id="'+__e(defaults.prefix)+'-call-state">'+__e(panels.AUDIO_CALL.calling_agent)+'</h3>\n\t\t\t\t\t<h3 class="'+__e(defaults.prefix)+'-text-center" id="'+__e(defaults.prefix)+'-call-timer">00:00</h3>\n\t\t\t\t</div>\n\t\t\t\t<form id="'+__e(defaults.prefix)+'-call-control">\n\t\t\t\t\t<hr>\n\t\t\t\t\t<button\n\t\t\t\t\t\tid="'+__e(defaults.prefix)+'-tryagain-btn"\n\t\t\t\t\t\ttype="button"\n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+"-block "+__e(defaults.prefix)+'-hidden"\n\t\t\t\t\t\tstyle="background: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+"; border: 1px solid "+__e(defaults.styles.primary.color)+';"\n\t\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="initCall">\n\t\t\t\t\t\t'+__e(panels.AUDIO_CALL.try_again)+'\n\t\t\t\t\t</button>\t\n\t\t\t\t\t<button \n\t\t\t\t\t\ttype="button"\n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-warn "+__e(defaults.prefix)+'-block"\n\t\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="endCall">\n\n\t\t\t\t\t\t'+__e(panels.AUDIO_CALL.end_call)+'\n\n\t\t\t\t\t</button>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Audio call pane ends ***** -->\n\n\t\t<!-- ***** Audio call fallback pane ***** -->\n\t\t<div class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="callAgentFallback">\n\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\t\t\t\t<div class="'+__e(defaults.prefix)+'-text-center">\n\t\t\t\t\t<h3>'+__e(panels.AUDIO_CALL_FALLBACK.DOWNLOAD_MSG)+"</h3>\n\t\t\t\t\t<br>\n\t\t\t\t\t",channels.webrtc&&channels.webrtc.fallback&&(__p+='\n\t\t\t\t\t\t<a href="'+__e(channels.webrtc.fallback.sipCall)+'">call.jnlp</a>\n\t\t\t\t\t'),__p+='\n\t\t\t\t</div>\n\t\t\t\t<form>\n\t\t\t\t\t<hr>\n\t\t\t\t\t<a href="#chooseConnection" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CALLBACK.back)+'</a>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Audio call fallback pane ends ***** -->\n\n\t\t<!-- ***** Callback pane ***** -->\n\t\t<div \n\t\t\tclass="'+__e(defaults.prefix)+'-wg-pane" \n\t\t\tdata-'+__e(defaults.prefix)+'-pane="callback">\n\n\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\t\t\t\t<div id="'+__e(defaults.prefix)+'-callback-spinner" class="'+__e(defaults.prefix)+"-hidden "+__e(defaults.prefix)+'-spinner-pane">\n\t\t\t\t\t<h3 class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.sending_request)+'</h3>\n\t\t\t\t\t<h3 class="'+__e(defaults.prefix)+"-text-center "+__e(defaults.prefix)+"-loader "+__e(defaults.prefix)+'-shown" style="position: relative;">\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t</h3>\n\t\t\t\t</div>\n\t\t\t\t<form id="'+__e(defaults.prefix)+'-callback-settings">\n\t\t\t\t\t',__p+=channels.callback&&channels.callback.time!==!1?'\n\t\t\t\t\t\t<p class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.title)+"</p>\n\t\t\t\t\t":'\n\t\t\t\t\t\t<p class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.title_asap)+"</p>\n\t\t\t\t\t",__p+="\n\t\t\t\t\t<hr>\n\t\t\t\t\t<label>"+__e(panels.CALLBACK.LABELS.phone)+'</label>\n\t\t\t\t\t<input type="tel" name="phone" placeholder="'+__e(panels.CALLBACK.PLACEHOLDERS.phone)+'" required>\n\t\t\t\t\t',channels.callback&&channels.callback.time!==!1&&(__p+="\n\t\t\t\t\t\t<label>"+__e(panels.CALLBACK.LABELS.time)+'</label>\n\t\t\t\t\t\t<select name="time">\n\t\t\t\t\t\t\t',_.forEach(panels.CALLBACK.TIME_POINTS,function(t){__p+='\n\t\t\t\t\t\t\t\t<option value="'+__e(t.minutes)+'">'+__e(t.label)+"</option>\n\t\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t</select>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t",channels.callback&&channels.callback.message!==undefined&&(__p+="\n\t\t\t\t\t\t<label>"+__e(panels.CALLBACK.LABELS.message)+'</label>\n\t\t\t\t\t\t<textarea name="message" placeholder="'+__e(panels.CALLBACK.PLACEHOLDERS.message)+'" maxlength="1500"></textarea>\n\t\t\t\t\t'),__p+='\n\t\t\t\t\t<hr>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype="submit"\n\t\t\t\t\t\tclass="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block"\n\t\t\t\t\t\tstyle="\n\t\t\t\t\t\t\tbackground: '+__e(defaults.styles.primary.backgroundColor)+"; \n\t\t\t\t\t\t\tcolor: "+__e(defaults.styles.primary.color)+"; \n\t\t\t\t\t\t\tborder: 1px solid "+__e(defaults.styles.primary.color)+';"\n\t\t\t\t\t\tdata-'+__e(defaults.prefix)+'-handler="setCallback">\n\n\t\t\t\t\t\t'+__e(panels.CALLBACK.confirm_callback)+'\n\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<a href="#chooseConnection" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CALLBACK.back)+'</a>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Callback pane ends ***** -->\n\n\t\t<!-- ***** Callback sent pane ***** -->\n\t\t<div class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="callbackSent">\n\t\t\t<div class="'+__e(defaults.prefix)+'-pane-body">\n\t\t\t\t<div id="'+__e(defaults.prefix)+'-callback-sent">\n\t\t\t\t\t<h3 class="'+__e(defaults.prefix)+"-text-center "+__e(defaults.prefix)+"-icon-check "+__e(defaults.prefix)+'-text-success"></h3>\n\t\t\t\t\t',__p+=channels.callback&&channels.callback.time!==!1?'\n\t\t\t\t\t\t<p class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.request_sent)+"</p>\n\t\t\t\t\t":'\n\t\t\t\t\t\t<p class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.request_sent_asap)+"</p>\n\t\t\t\t\t",__p+='\n\t\t\t\t\t<form>\n\t\t\t\t\t\t<hr>\n\t\t\t\t\t\t<a href="#chooseConnection" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CALLBACK.back)+'</a>\n\t\t\t\t\t\t<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.CALLBACK.close)+'</a>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- ***** Callback sent pane ends ***** -->\n\n\t</div>\n\t<!-- ***** Panes container ends ***** -->\n\n\t<!-- ***** Floating button container ***** -->\n\t<div id="'+__e(defaults.prefix)+'-btn-cont" class="'+__e(defaults.prefix)+'-btn-cont">\n\t\t<div class="'+__e(defaults.prefix)+'-wg-btn">\n\t\t\t<div class="'+__e(defaults.prefix)+'-lastmsg-cont">\n\t\t\t\t<span class="'+__e(defaults.prefix)+'-unnotify-btn" id="'+__e(defaults.prefix)+'-unnotify-btn"><span class="'+__e(defaults.prefix)+'-icon-close"></span></span>\n\t\t\t\t<!-- <span class="'+__e(defaults.prefix)+'-unnotify-btn" id="'+__e(defaults.prefix)+'-unnotify-btn">'+__e(frases.FLOATING_BUTTON.close)+'</span> -->\n\t\t\t\t<div id="'+__e(defaults.prefix)+'-lastmsg" class="'+__e(defaults.prefix)+'-lastmsg">\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t<a href="#" class="'+__e(defaults.prefix)+'-btn-link">\n\t\t\t\t<span class="'+__e(defaults.prefix)+'-btn-icon"></span>\n\t\t\t</a>\n\t\t</div>\n\t</div>\n\t<!-- ***** Floating button container ends ***** -->\n\n</div>'}return __p}},{}],69:[function(t,e,n){(function(n){function s(){var t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia,n=window.mozRTCIceCandidate||window.RTCIceCandidate;return!!t&&!!e&&!!n}function a(){g.on("connected",function(t){v.log("sip connected event: ",t)}),g.on("disconnected",function(t){v.log("sip disconnected event: ",t)}),g.on("newMessage",function(t){v.log("sip newMessage event: ",t)}),g.on("newRTCSession",function(t){v.log("sip newRTCSession event: ",t),y.emit("webrtc/newRTCSession",t),h=t.session}),g.on("registered",function(t){v.log("sip registered event: ",t)}),g.on("unregistered",function(t){v.log("sip unregistered event: ",t)}),g.on("registrationFailed",function(t){v.log("sip registrationFailed event: ",t)}),b={progress:function(t){v.log("call progress event: ",t),y.emit("webrtc/progress",t)},failed:function(t){v.log("call failed event:",t),y.emit("webrtc/failed",t)},ended:function(t){v.log("call ended event: ",t),y.emit("webrtc/ended",t)},confirmed:function(t){v.log("call confirmed event: ",t),y.emit("webrtc/confirmed",t)},addstream:function(t){v.log("call addstream event: ",t),y.emit("webrtc/addstream",t);var e=t.stream;_.audioRemote=x.rtcninja.attachMediaStream(_.audioRemote,e)}}}function r(){return h.isEstablished()}function i(){return h.isInProgress()}function o(){return h.isEnded()}function l(){g.stop()}function c(t){h=g.call(t,{eventHandlers:b,mediaConstraints:{audio:!0,video:!1}})}function u(){h.terminate({status_code:200})}function d(){v.log("answer: ",g),h.answer()}function f(){v.log("hold: ",h.isOnHold()),h&&h.isOnHold().local?h.unhold():h.hold()}function p(){var t=document.createElement("audio");return t.setAttribute("autoplay","autoplay"),document.body.appendChild(t),t}function m(t){v.log("Initiating WebRTC module:",t),_=t,void 0===_.sip.register&&(_.sip.register=!1);var e=new x.WebSocketInterface(_.sip.ws_servers);_.sip.sockets=[e],y.emit=t.emit,y.on=t.on,_.audioRemote=p(),g=new x.UA(_.sip),a(),g.start()}var _,g,h,b,v=t("./debug"),y={},x=n.JsSIP;e.exports={lib:x,init:m,unregister:l,audiocall:c,terminate:u,answer:d,hold:f,isInProgress:i,isEstablished:r,isEnded:o,isSupported:s}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./debug":63}],70:[function(t,e,n){(function(n){function s(t){return he.initiated?ke:(ce.merge(_e,t||{}),Vt=new re(_e).on("session/create",i).on("session/timeout",z).on("session/join",u).on("session/joined",f).on("session/disjoin",p).on("session/init",l),oe.get("forms_json",_e.clientPath+"forms.json",function(t,e){return t?Vt.emit("Error",t):void(Xt=JSON.parse(e).forms)}),qt(),me.init(_e.clientPath+"sounds/"),ke)}function a(){return Vt.init(),ke}function r(t){le.log("initWebrtcModule: ",t),pe.init(t)}function i(){h(),ce.poll(function(){return le.log("poll: ",ue),null!==ue},function(){o(),_e.external||Vt.updateUrl(window.location.href)},function(){return we<2?(we++,void s(_e)):Vt.emit("Error","Module wasn't initiated due to network errors")},6e4)}function o(){return!!(_e.chat||_e.webrtcEnabled||_e.channels.callback.task)&&(Vt.session.properties&&ce.merge(_e,Vt.session.properties),_e.sid=Vt.session.sid,_e.isIpcc=void 0!==Vt.session.langs||void 0!==Vt.session.categories,le.log("initSession: ",Vt,_e),_e.widget&&Vt.on("chat/close",q).on("chat/timeout",W).on("message/new",T).on("message/new",O).on("message/typing",H).on("callback/create",Y).on("form/submit",Ot).on("form/reject",Tt).on("widget/load",v),pe.isSupported()&&_e.channels.webrtc&&_e.channels.webrtc.sip&&void 0!==_e.channels.webrtc.sip.ws_servers&&("https:"===window.location.protocol?(_e.webrtcEnabled=!0,Vt.on("webrtc/newRTCSession",function(){X("newRTCSession")}),Vt.on("webrtc/progress",function(t){X(180===t.response.status_code?"ringing":"confirmed")}),Vt.on("webrtc/addstream",function(){X("connected")}),Vt.on("webrtc/ended",function(){X("ended")}),Vt.on("webrtc/failed",function(t){X("Canceled"===t.cause?"canceled":"failed")}),r({sip:_e.channels.webrtc.sip,emit:ke.emit,on:ke.on})):(le.warn("WebRTC feature is disabled"),le.warn("getUserMedia() no longer works on insecure origins. To use this feature, you should consider switching your application to a secure origin, such as HTTPS. See https://goo.gl/rStTGz for more details."))),g(),_e.buttonSelector&&at(_e.buttonSelector),_e.themeColor&&(_e.styles.primary.backgroundColor=_e.themeColor,_e.styles.primary.color=Wt(_e.themeColor)),le.log("initSession: ",_e.widget,he.initiated,Gt()),_e.sounds=void 0!==ie.getState("sounds")?ie.getState("sounds","session"):_e.sounds,_e.widget&&!he.initiated&&Gt()&&y(_e),Et("timeout")&&Ct("timeout"),void Vt.emit("session/init",{session:Vt.session,options:_e,url:n.location.href}))}function l(t){ie.saveState("init",!0,"session"),te&&!te.closed&&te.sessionStorage.setItem(_e.prefix+".init",!0)}function c(){O({from:ie.getState("aname","session"),time:Date.now(),content:"{request_browser_access}"})}function u(t){le.log("onSessionJoinRequest",ie.getState("shared","session")),ie.getState("shared","session")?d(t):c()}function d(t){Vt.shareOpened(),f(t)}function f(t){m({url:t.url,entity:Vt.session.entity})}function p(){de.unshare()}function m(t){_e.external||de.isInitiated()||(Vt.on("cobrowsing/init",function(){de.share()}),Vt.on("cobrowsing/update",function(t){de.updateEvents(t)}),Vt.on("cobrowsing/event",function(t){Vt.updateEvents(t.events)}),Vt.on("cobrowsing/shared",function(){ie.saveState("shared",!0,"session")}),Vt.on("cobrowsing/unshared",function(t){ie.saveState("shared",!1,"session")}),de.init({widget:t.widget,entity:t.entity,emit:ke.emit,path:_e.clientPath}))}function _(){return Zt}function g(){Vt.getLanguages(function(t,e){le.log("getLanguages: ",t,e),t||e&&b(e)})}function h(){oe.get("frases",(_e.translationsPath||_e.clientPath)+"translations.json",function(t,e){return t?Vt.emit("Error",t):(ue=JSON.parse(e),void(ue=ue[Vt.detectLanguage(ue)]))})}function b(t){t.length?"online":"offline";ye=t,Vt.emit("chat/languages",t)}function v(){var t,e="";he.initiated=!0,wt(),st(Zt),yt({state:xt()}),_e.hideOfflineButton&&St("no-button"),_e.offer&&x(),ie.getState("chat","session")===!0&&(C(ie.getState("credentials","session")||{}),ie.getState("opened","session")&&Lt()),_e.webrtcEnabled&&St("webrtc-enabled"),Zt&&_e.intro&&_e.intro.length&&(ye.forEach(function(n){ue&&ue.lang&&(t=n===Vt.session.lang?"selected":"",e+='<option value="'+n+'" '+t+" >"+ue.lang+"</option>")}),n[_e.prefix+"IntroForm"].lang.innerHTML=e),Vt.emit("widget/init")}function y(t){compiled=It("widget",{defaults:t,languages:ye,translations:ue,credentials:ie.getState("credentials","session")||{},_:ce}),Zt=ae(compiled),document.body.appendChild(Zt),Vt.emit("widget/load",Zt),le.log("loadWidget",t)}function x(){setTimeout(function(){w({from:_e.offer.from||ue.TOP_BAR.title,time:Date.now(),content:_e.offer.text||ue.default_offer})},_e.offer.inSeconds?1e3*_e.offer.inSeconds:3e4)}function w(t){"online"!==he.state||S()||O(t)}function k(){ie.getState("interacted","session")||ie.saveState("interacted",!0,"session")}function S(){return ie.getState("interacted","session")}function E(){Lt(),ie.getState("chat","cache")||(dt()?vt("sendemail"):_e.intro&&_e.intro.length?ie.getState("chat","session")||ie.getState("credentials","session")?C(ie.getState("credentials","session")||{}):vt("credentials"):C({lang:Vt.session.lang}))}function C(t){var e=ie.getState("chat","session"),n=ie.getState("aid","session"),s=t.message,a={};n&&(t.agentid=n),t.lang||(t.lang=Vt.session.lang),a=Kt({},t),delete a.message,ie.saveState("credentials",a,"session"),Vt.chatRequest(t),setTimeout(function(){le.log("requestChat: ",t.message,e),s&&!e&&A({message:t.message})},500),L(Vt.session),Nt(),vt("messages")}function L(t){var e=t.answerTimeout;ie.saveState("chat",!0,"session"),le.log("startChat timeout: ",e),e&&(Qt=setTimeout(W,1e3*e)),St("chat")}function A(t){Vt.sendMessage(t),O({from:ie.getState("credentials","session").uname||Vt.session.sid,time:Date.now(),content:t.message})}function O(t){le.log("new messages arrived!",t);var e,s,a=!1,r=ie.getState("credentials","session")||{},i=ie.getState("aname","session"),o=r.uname?r.uname:Vt.session.sid,l=document.getElementById(_e.prefix+"-messages-cont");if(t.entity=t.entity||(t.from===o||void 0===t.from?"user":"agent"),t.from="user"===t.entity?"":t.from,t.time=Rt(t.time?t.time:Date.now()),e=Mt(t.content,t.file,t.entity),"form"===e.type)s=It("forms",{defaults:_e,message:t,form:e.content,credentials:r,frases:ue,_:ce}),n[e.content.name]&&Tt({formName:e.content.name}),l.insertAdjacentHTML("beforeend","<li>"+s+"</li>"),l.scrollTop=l.scrollHeight;else{if(!t.content)return;t.content=e.content,s=It("message",{defaults:_e,message:t}),l.insertAdjacentHTML("beforeend","<li "+(t.className?'class="'+t.className+'"':"")+">"+s+"</li>"),N(s),t.hidden||(be.push(s),ve.push(t))}"agent"===t.entity&&(i!==t.from&&ie.saveState("aname",t.from,"session"),t.agentid&&ie.saveState("aid",t.agentid,"session"),t.from&&clearTimeout(Qt)),"user"!==t.entity&&(a=!0),l.scrollTop=l.scrollHeight,a&&I()}function T(){var t=[].slice.call(document.querySelectorAll("."+_e.prefix+"-msg-undelivered"));t&&t.length&&t.forEach(function(t){t.classList.add(_e.prefix+"-hidden")})}function j(){var t=document.querySelector("."+_e.prefix+"-trigger-sounds-btn span");_e.sounds=!_e.sounds,t.className=_e.sounds?_e.prefix+"-icon-bell":_e.prefix+"-icon-bell-slash",ie.saveState("sounds",_e.sounds,"session")}function I(){_e.sounds&&me.play("new_message")}function N(t){var e;he.active||(e=document.getElementById(_e.prefix+"-lastmsg"),e.innerHTML=t,St("notified"),kt("notified"))}function R(t,e){var n=It("email",{defaults:_e,content:t,frases:ue,_:ce});if(e)return e(null,n)}function M(t){var e=t.text.join("");R(e,function(e,n){e||(t.text=n,Vt.sendEmail(t))})}function F(t){var e=[],n=It("message",{defaults:_e,message:{from:ue.EMAIL_SUBJECTS.complain+" "+t.email,content:t.text,entity:"",time:""}});e=e.concat(n,'<br><p class="h1">'+ue.EMAIL_SUBJECTS.dialog+" "+_e.host+"</p><br>",be).reduce(function(t,e){return t.concat(e)}),R(e,function(e,n){e||(t.text=n,Vt.sendEmail(t))})}function P(t,e){It("message",{defaults:_e,message:{from:ue.EMAIL_SUBJECTS.request+" "+t.uname+" ("+t.email+")",content:t.text,entity:"",time:""}});Vt.sendEmail(t),e&&e()}function D(t,e){var n;return e.email?(e.subject=ue.EMAIL_SUBJECTS.request+" "+e.email,void(e.file?n=jt(t.file,function(n,s){n?le.warn("File wasn't sent"):(e.filename=s.filename,e.filedata=s.filedata),delete e.file,P(e,function(){t.reset(),At()})}):P(e,function(){t.reset(),At()}))):void alert(ue.ERRORS.email)}function B(t,e){var n=e&&e.rating?parseInt(e.rating,10):null;if(e&&e.sendDialog){if(!e.email)return void alert(ue.ERRORS.email);M({to:e.email,subject:ue.EMAIL_SUBJECTS.dialog+" "+_e.host,text:be})}if(e&&e.text){if(!e.email)return void alert(ue.ERRORS.email);F({email:e.email,subject:ue.EMAIL_SUBJECTS.complain+" "+e.email,text:e.text})}t&&t.reset(),U(n),At()}function U(t){ie.saveState("chat",!1,"session"),Vt.closeChat(t),Ct("chat"),ie.getState("shared","session")&&(Vt.shareClosed(n.location.href),de.unshare())}function q(){ie.getState("shared","session")&&de.unshare()}function W(){le.log("chat timeout!"),O({from:"",time:Date.now(),content:"{queue_overload}"});var t=n.queue_overload;t&&(t.text.value=ve.reduce(function(t,e){return"user"===e.entity&&(t+=e.content+"\n"),t},""))}function H(){ee||St("agent-typing"),clearTimeout(ee),ee=setTimeout(function(){ee=null,Ct("agent-typing")},5e3)}function z(){le.log("Session timeout:"),ie.getState("chat","session")===!0&&U(),vt("closechat")}function K(){vt("callAgent"),pe.audiocall(_e.channels.webrtc.hotline)}function J(){vt("callAgentFallback")}function $(){vt("callback")}function G(){var t=document.getElementById(_e.prefix+"-callback-settings"),e=Bt(t);document.getElementById(_e.prefix+"-callback-spinner"),document.getElementById(_e.prefix+"-callback-sent");if(e.phone=e.phone?$t(e.phone):null,!e.phone||e.phone.length<10)return alert(ue.ERRORS.tel);if(e.time){if(e.time=parseFloat(e.time),e.time<=0)return;e.time=Date.now()+60*e.time*1e3}e.task=_e.channels.callback.task,le.log("setCallback data: ",e),Vt.requestCallback(e),vt("callbackSent"),t.reset()}function Y(){var t=document.getElementById(_e.prefix+"-callback-settings"),e=document.getElementById(_e.prefix+"-callback-spinner");e.classList.add(_e.prefix+"-hidden"),t.classList.remove(_e.prefix+"-hidden"),err||vt("callbackSent")}function X(t){le.log("initCallState: ",t);var e=document.getElementById(_e.prefix+"-call-spinner"),n=document.getElementById(_e.prefix+"-call-info"),s=document.getElementById(_e.prefix+"-call-state"),a=document.getElementById(_e.prefix+"-call-timer"),r=document.getElementById(_e.prefix+"-tryagain-btn");"newRTCSession"===t?X("oncall"):"confirmed"===t?(s.innerText=ue.PANELS.AUDIO_CALL.calling_agent,n.classList.remove(_e.prefix+"-hidden"),e.classList.add(_e.prefix+"-hidden"),r.classList.add(_e.prefix+"-hidden")):"ringing"===t?(V(a,"init",0),a.classList.remove(_e.prefix+"-hidden")):"connected"===t?(s.innerText=ue.PANELS.AUDIO_CALL.connected_with_agent,V(a,"start",0),me.stop()):"ended"===t?(s.innerText=ue.PANELS.AUDIO_CALL.call_ended,V(a,"stop"),X("oncallend")):"failed"===t||"canceled"===t?("failed"===t?s.innerText=ue.PANELS.AUDIO_CALL.call_failed:s.innerText=ue.PANELS.AUDIO_CALL.call_canceled,n.classList.remove(_e.prefix+"-hidden"),e.classList.add(_e.prefix+"-hidden"),a.classList.add(_e.prefix+"-hidden"),r.classList.remove(_e.prefix+"-hidden"),X("oncallend"),me.play("busy")):"oncall"===t?(window.onbeforeunload=function(){return"Your connection is in progress. Do you realy want to close it?"},ie.saveState("call",!0,"cache"),St("webrtc-call")):"oncallend"===t?(window.onbeforeunload=null,ie.saveState("call",!1,"cache"),Ct("webrtc-call")):(n.classList.add(_e.prefix+"-hidden"),e.classList.remove(_e.prefix+"-hidden"),r.classList.add(_e.prefix+"-hidden"))}function V(t,e,n){var s=n;"start"===e?se=setInterval(function(){s+=1,t.textContent=Jt(s)},1e3):"stop"===e?clearInterval(se):"init"===e&&(t.textContent=Jt(0))}function Q(){pe.isEstablished()||pe.isInProgress()?pe.terminate():(At(),X("init"))}function Z(t){t&&t.preventDefault();var e={};te&&!te.closed||(e=ce.merge(e,_e),e.widget=!0,e.external=!0,te=window.open("","wchat",_e.widgetWindowOptions),te=tt(te),ce.poll(function(){return void 0!==te.Wchat},function(){te.Module=te.Wchat(e),te.Module.on("widget/init",function(){te.Module.initWidgetState()}),ce.forEach(Vt._events,function(t,e,s){te.Module.on(e,function(t){t.url=n.location.href,Vt.emit("window/"+e,t)})})},function(){console.warn("Wchat module was not initiated due to network connection issues.")},12e4),te.onbeforeunload=function(){ie.getState("chat","session")&&U()}),te.focus&&te.focus()}function tt(t){var e,n,s,a,r=t.document.createElement("div"),i=et(t,"swc-loader-styles"),o=t.document.getElementsByTagName("head")[0],l=t.document.getElementsByTagName("body")[0];return r.className="swc-widget-loader",r.innerHTML="<span></span><span></span><span></span>",s=t.document.createElement("meta"),s.name="viewport",s.content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0",n=t.document.createElement("meta"),n.setAttribute("charset","utf-8"),a=t.document.createElement("title"),a.textContent=ue.TOP_BAR.title,e=t.document.createElement("script"),e.src=_e.clientPath+"wchat.min.js",e.charset="UTF-8",o.appendChild(s),o.appendChild(n),o.appendChild(a),o.appendChild(i),o.appendChild(e),l.id="swc-wg-window",l.appendChild(r),nt(o.getElementsByTagName("style")[0]),t}function et(t,e){var n=t.document.createElement("style");return n.type="text/css",e&&(n.id=e),n.appendChild(t.document.createTextNode("")),n}function nt(t){var e=["body { margin:0; background-color: #eee; }","@keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-webkit-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-moz-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-ms-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-o-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}",".swc-widget-loader {","position: absolute;","width: 100%;","top: 50%;","margin-top: -18px;","text-align: center;","}",".swc-widget-loader span {","display: inline-block;","width: 18px;","height: 18px;","border-radius: 50%;","background-color: #fff;","margin: 3px;","}",".swc-widget-loader span:nth-last-child(1) { -webkit-animation: preloading .8s .1s linear infinite; -moz-animation: preloading .8s .1s linear infinite; -ms-animation: preloading .8s .1s linear infinite; -o-animation: preloading .8s .1s linear infinite; animation: preloading .8s .1s linear infinite; }",".swc-widget-loader span:nth-last-child(2) { -webkit-animation: preloading .8s .3s linear infinite; -moz-animation: preloading .8s .3s linear infinite; -ms-animation: preloading .8s .3s linear infinite; -o-animation: preloading .8s .3s linear infinite; animation: preloading .8s .3s linear infinite; }",".swc-widget-loader span:nth-last-child(3) { -webkit-animation: preloading .8s .5s linear infinite; -moz-animation: preloading .8s .5s linear infinite; -ms-animation: preloading .8s .5s linear infinite; -o-animation: preloading .8s .5s linear infinite; animation: preloading .8s .5s linear infinite; }"].join(" ");
t.innerHTML=e}function st(t){var e=document.getElementById(_e.prefix+"-file-select"),s=document.getElementById(_e.prefix+"-message-text"),a=[].slice.call(t.querySelectorAll("."+_e.prefix+"-inputfile")),r=document.getElementById(_e.prefix+"-btn-cont");[].slice.call(t.querySelectorAll("."+_e.prefix+"-wg-pane")),document.getElementById(_e.prefix+"-messages-cont");a.forEach(function(t){var e=t.nextElementSibling,n=e.textContent;Yt(t,"change",function(t){var s=t.target.value.split("\\").pop();s?e.textContent=s:e.textContent=n})}),Yt(r,"click",lt),Yt(t,"click",ot),Yt(t,"submit",ht),Yt(e,"change",bt),Yt(s,"keypress",mt),Yt(s,"focus",_t),Yt(s,"blur",gt),Yt(n,"DOMMouseScroll",ct),Yt(n,"wheel",ct),Yt(t,"mouseenter",rt),Yt(t,"mouseleave",it)}function at(t){var e=_e.widget?ft:Z,n=[].slice.call(document.querySelectorAll(t));n.map(function(t){return Yt(t,"click",e),t})}function rt(){xe=!0}function it(){xe=!1}function ot(t){var e,n,s,a,r=t.target;"A"!==r.parentNode.tagName&&"BUTTON"!==r.parentNode.tagName||(r=r.parentNode),e=r.getAttribute("data-"+_e.prefix+"-handler"),a=r.getAttribute("data-"+_e.prefix+"-link"),"closeWidget"===e?At():"finish"===e?(U(),At()):"triggerSounds"===e?j():"sendMessage"===e?pt():"openWindow"===e?Z():"rejectForm"===e?Vt.emit("form/reject",{formName:ce.findParent(r,"form").name}):"initCall"===e?K():"initFallbackCall"===e?J():"initCallback"===e?$():"setCallback"===e?G():"initChat"===e?E():"endCall"===e&&Q(),"A"===r.tagName&&(s=r.href,a?Vt.linkFollowed(a):s.indexOf("#")!==-1&&(t.preventDefault(),n=s.substring(r.href.indexOf("#")+1),n&&vt(n)))}function lt(t){t.preventDefault();var e=t.target,n=_e.prefix+"-unnotify-btn";return currTarg=t.currentTarget,e.id===n||e.parentNode.id===n?(Ct("notified"),void kt(he.state)):void(currTarg.id===_e.prefix+"-btn-cont"&&ft())}function ct(t){var e=document.getElementById(_e.prefix+"-messages-cont"),n=ut(t);xe&&(0===e.scrollTop&&"up"===n?(t.stopPropagation(),t.preventDefault()):e.scrollTop>=e.scrollHeight-e.clientHeight&&"down"===n&&(t.stopPropagation(),t.preventDefault()))}function ut(t){var e;return e=t.wheelDelta?t.wheelDelta:-1*t.deltaY,e<0?"down":e>0?"up":void 0}function dt(){var t=xt();return"offline"===t}function ft(t){t&&t.preventDefault();var e=ie.getState("chat","session"),n=(ie.getState("opened","session"),ie.getState("call","cache"));le.log("initWidgetState"),k(),Et("timeout")?a():e?Lt():dt()?(vt("sendemail"),Lt()):_e.webrtcEnabled?n?Lt():(_e.chat||_e.channels.callback.task?vt("chooseConnection"):K(),Lt()):_e.channels.callback.task?_e.chat||_e.webrtcEnabled?(vt("chooseConnection"),Lt()):(vt("callback"),Lt()):E()}function pt(){var t,e=document.getElementById(_e.prefix+"-message-text");t=e.value.trim(),t&&(ie.getState("chat","session")||E(),A({message:t}),e.value="",Ct("type-extend"))}function mt(t){var e=t.target,n=document.getElementById("swc-message-text-clone");10===t.keyCode||13===t.keyCode?(t.preventDefault(),pt()):ne||(ne=setTimeout(function(){ne=null,Vt.userIsTyping()},1e3)),n.innerText=e.value,e.style.height=n.clientHeight+"px"}function _t(t){var e=t.target;e.style.borderColor=_e.styles.primary.backgroundColor}function gt(t){var e=t.target;e.style.borderColor="#fff"}function ht(t){var e=t.target;t.preventDefault(),"FORM"===e.tagName&&Vt.emit("form/submit",{formElement:e,formData:Bt(e)})}function bt(t){var e=t.target;jt(e,function(t,e){le.log("wgSendFile: ",t,e),t?alert("File was not sent"):A({message:e.filename,file:e.filedata})})}function vt(t){var e="data-"+_e.prefix+"-pane",n=[].slice.call(Zt.querySelectorAll("."+_e.prefix+"-wg-pane"));n.forEach(function(n){n.getAttribute(e)===t?n.classList.add("active"):n.classList.remove("active")})}function yt(t){if(le.log("changeWgState: ",t),Zt&&he.state!==t.state){"offline"===t.state?(U(),Ct("online"),vt("sendemail")):"online"===t.state&&Ct("offline");var e=document.querySelector("."+_e.prefix+"-wg-state");e&&(e.textContent=ue.TOP_BAR.STATUS[t.state]),he.state=t.state,St(t.state),kt(t.state),Vt.emit("widget/statechange",{state:t.state})}}function xt(){var t="";return t=_e.isIpcc?he.state?he.state:ye.length?"online":"offline":he.state?he.state:Vt.session.state?"online":"offline"}function wt(){var t=Zt.querySelector("."+_e.prefix+"-wg-btn");le.log("setStyles: ",t,_e.buttonStyles),t.style.borderRadius=_e.buttonStyles.borderRadius,t.style.boxShadow=_e.buttonStyles.boxShadow}function kt(t){if(Zt&&void 0!==_e.buttonStyles[t]){var e=Zt.querySelector("."+_e.prefix+"-wg-btn"),n=Zt.querySelector("."+_e.prefix+"-btn-icon");e.style.background=_e.buttonStyles[t].backgroundColor,n.style.color=_e.buttonStyles[t].color||_e.buttonStyles.color}}function St(t){Zt&&Zt.classList.add(t)}function Et(t){return!!Zt&&Zt.classList.contains(t)}function Ct(t){Zt&&Zt.classList.remove(t)}function Lt(){var t=document.getElementById(_e.prefix+"-messages-cont");he.active=!0,ie.saveState("opened",!0,"session"),St("active"),Ct("notified"),kt(he.state),t.scrollTop=t.scrollHeight}function At(){window.opener?window.close():(he.active=!1,ie.saveState("opened",!1,"session"),Ct("active"))}function Ot(t){var e=t.formElement,s=t.formData;if(le.log("onFormSubmit: ",e,s),e.getAttribute("data-validate-form")){var a=Ut(e);if(!a)return}e.id===_e.prefix+"-closechat-form"?B(e,s):e.id===_e.prefix+"-sendmail-form"?D(e,s):e.id===_e.prefix+"-intro-form"?C(s):e.id===_e.prefix+"-call-btn-form"?K():e.id===_e.prefix+"-chat-btn-form"?E():e.id===_e.prefix+"-queue_overload"?(P(s),Tt({formName:e.name},!0)):e.id===_e.prefix+"-request_browser_access"?(d({url:n.location.href}),Tt({formName:e.name},!0),At()):Tt({formName:e.name},!0)}function Tt(t,e){var s=n[t.formName];return!!s&&void(e?s.outerHTML='<p class="'+_e.prefix+'-text-center"><i class="'+_e.prefix+"-text-success "+_e.prefix+'-icon-check"></i><span> '+ue.FORMS.submitted+"</span></p>":s.outerHTML='<p class="'+_e.prefix+'-text-center"><i class="'+_e.prefix+"-text-danger "+_e.prefix+'-icon-remove"></i><span> '+ue.FORMS.canceled+"</span></p>")}function jt(t,e){var s,a=t.files;if(a.length){if(!n.FileReader)return void(e&&e("OBSOLETE_BROWSER"));s=a[0];var r=new Blob([s],{type:s.type});return e(null,{filedata:r,filename:s.name})}}function It(t,e){var n=fe[t];return n(e)}function Nt(){var t=document.getElementById(_e.prefix+"-messages-cont"),e=t.cloneNode();t.parentNode.replaceChild(e,t)}function Rt(t){var e=new Date("string"==typeof t?parseInt(t,10):t),n=e.getHours(),s=e.getMinutes(),a=(n<10?"0"+n:n)+":"+(s<10?"0"+s:s);return a}function Mt(t,e,n){var s,a;return e?(s=t.substring(t.indexOf("_")+1),Dt(e)?{type:"image",content:'<a href="'+Vt.options.server+"/ipcc/"+t+'" download="'+s+'"><img src="'+Vt.options.server+"/ipcc/"+t+'" alt="file preview" /></a>'}:{type:"file",content:'<a href="'+Vt.options.server+"/ipcc/"+t+'" download="'+s+'">'+s+"</a>"}):"agent"===n&&Pt(t)&&Dt(t)?(s=t.substring(t.indexOf("_")+1),{type:"image",content:'<a href="'+t+'" target="_blank"><img src="'+t+'" alt="'+s+'" /></a>'}):"agent"===n&&new RegExp("^{.+}$").test(t)?(Xt.forEach(function(e){e.name===t.substring(1,t.length-1)&&(a=e)}),{type:a?"form":"text",content:a?a:t}):{type:"text",content:t.replace(/\n/g," <br> ").split(" ").map(Ft).join(" ").replace(" <br> ","<br>")}}function Ft(t){var e=0,n=t;if(Pt(t)){for(;!n.charAt(n.length-1).match(/[a-z0-9\/]/i);)n=n.slice(0,-1),e+=1;return'<a href="'+n+'" target="_blank" data-'+_e.prefix+'-link="'+n+'">'+n+"</a>"+t.substr(t.length-e)}return t}function Pt(t){var e=new RegExp("^http://|^https://");return e.test(t)}function Dt(t){var e=new RegExp("png|PNG|jpg|JPG|JPEG|jpeg|gif|GIF"),n=t.substring(t.lastIndexOf(".")+1);return e.test(n)}function Bt(t){var e={};return[].slice.call(t.elements).forEach(function(t){"checkbox"===t.type?e[t.name]=t.checked:t.value&&(e[t.name]=t.value)}),e}function Ut(t){var e=!0;return[].slice.call(t.elements).every(function(t){return!t.hasAttribute("required")||""!==t.value&&null!==t.value||(alert(ue.ERRORS[t.type]||ue.ERRORS.required),e=!1,!1)}),e}function qt(){var t=document.createElement("link");t.rel="stylesheet",t.href=_e.stylesPath||_e.clientPath+"main.css",document.head.appendChild(t)}function Wt(t){var e=zt(_e.themeColor);return le.log("getThemeTextColor: ",e,Ht(e.r,e.g,e.b)),Ht(e.r,e.g,e.b)>.5?"#333":"#f1f1f1"}function Ht(t,e,n){var s=t/255,a=e/255,r=n/255,i=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),o=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),l=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4),c=.2126*i+.7152*o+.0722*l;return c}function zt(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,n,s){return e+e+n+n+s+s});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null}function Kt(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Jt(t){var e=Math.floor(t/60),n=t%60,s=(e>9?e:"0"+e)+":"+(n>9?n:"0"+n);return s}function $t(t){return t.replace(/\D+/g,"")}function Gt(){return void 0!==document.body.classList}function Yt(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}var Xt,Vt,Qt,Zt,te,ee,ne,se,ae=t("domify"),re=t("./core"),ie=t("./storage"),oe=t("./request"),le=t("./debug"),ce=t("./lodash-fns"),ue=null,de=t("./cobrowsing"),fe=t("./templates"),pe=t("./webrtc"),me=t("./audio-control"),_e={prefix:"swc",autoStart:!0,intro:!1,introMessage:"",widget:!0,chat:!0,sounds:!0,channels:{webrtc:{},callback:{}},cobrowsing:!1,buttonSelector:"",reCreateSession:!0,title:"",lang:"",langFromUrl:!0,position:"right",hideOfflineButton:!1,offer:!1,themeColor:"",styles:{primary:{backgroundColor:"#74b9ff",color:"#FFFFFF"},intro:{},sendmail:{},closeChat:{}},buttonStyles:{online:{backgroundColor:"rgba(175,229,255)",color:""},offline:{backgroundColor:"rgba(241,241,241)",color:""},timeout:{backgroundColor:"rgba(241,241,241)",color:""},notified:{backgroundColor:"rgba(253,250,129)",color:""},color:"rgb(70,70,70)"},widgetWindowOptions:"left=10,top=10,width=350,height=550,resizable",path:"/ipcc/webchat/",clientPath:"https://cdn.smile-soft.com/wchat/v1/",stylesPath:"",translationsPath:"",host:window.location.host,webrtcEnabled:!1},ge="WchatSettings",he={initiated:!1,active:!1,state:"",share:!1,sounds:!0},be=[],ve=[],ye=[],xe=!1,we=1,ke={initModule:a,initWidgetState:ft,openWidget:Z,initChat:E,initCall:K,getWidgetElement:_,isWebrtcSupported:pe.isSupported,getWidgetState:function(){return he},getEntity:function(){return ie.getState("entity","session")},on:function(t,e){return Vt.on(t,e),this},emit:function(t,e){return Vt.emit(t,e),this},setDefaultCredentials:function(t){return _e.credentials=t,this}};e.exports={module:s,api:ke},n[ge]&&n[ge].autoStart!==!1&&_e.autoStart&&("complete"===document.readyState||"interactive"===document.readyState?s(n[ge]):document.addEventListener("DOMContentLoaded",function(){s(n[ge])},!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./audio-control":60,"./cobrowsing":61,"./core":62,"./debug":63,"./lodash-fns":64,"./request":66,"./storage":67,"./templates":68,"./webrtc":69,domify:1}]},{},[65])(65)});