!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Wchat=e()}}(function(){return function e(t,n,a){function r(i,o){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(s)return s(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return r(n?n:e)},u,u.exports,e,t,n,a)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(e,t,n){function a(e,t){if("string"!=typeof e)throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var a=n[1];if("body"==a){var r=t.createElement("html");return r.innerHTML=e,r.removeChild(r.lastChild)}var s=i[a]||i._default,o=s[0],l=s[1],c=s[2],r=t.createElement("div");for(r.innerHTML=l+e+c;o--;)r=r.lastChild;if(r.firstChild==r.lastChild)return r.removeChild(r.firstChild);for(var u=t.createDocumentFragment();r.firstChild;)u.appendChild(r.removeChild(r.firstChild));return u}t.exports=a;var r,s=!1;"undefined"!=typeof document&&(r=document.createElement("div"),r.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',s=!r.getElementsByTagName("link").length,r=void 0);var i={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:s?[1,"X<div>","</div>"]:[0,"",""]};i.td=i.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],i.option=i.optgroup=[1,'<select multiple="multiple">',"</select>"],i.thead=i.tbody=i.colgroup=i.caption=i.tfoot=[1,"<table>","</table>"],i.polyline=i.ellipse=i.polygon=i.circle=i.text=i.line=i.path=i.rect=i.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"]},{}],2:[function(e,t,n){function a(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function s(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0,a.defaultMaxListeners=10,a.prototype.setMaxListeners=function(e){if(!s(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},a.prototype.emit=function(e){var t,n,a,s,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(i(n))for(s=Array.prototype.slice.call(arguments,1),c=n.slice(),a=c.length,l=0;a>l;l++)c[l].apply(this,s);return!0},a.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(n=o(this._maxListeners)?a.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},a.prototype.on=a.prototype.addListener,a.prototype.once=function(e,t){function n(){this.removeListener(e,n),a||(a=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var a=!1;return n.listener=t,this.on(e,n),this},a.prototype.removeListener=function(e,t){var n,a,s,o;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,a=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(o=s;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=o;break}if(0>a)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(a,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},a.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},a.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},a.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},a.listenerCount=function(e,t){return e.listenerCount(t)}},{}],3:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],4:[function(e,t,n){var a=e("../internal/arrayEach"),r=e("../internal/baseEach"),s=e("../internal/createForEach"),i=s(a,r);t.exports=i},{"../internal/arrayEach":10,"../internal/baseEach":16,"../internal/createForEach":33}],5:[function(e,t,n){var a=e("../internal/getNative"),r=a(Date,"now"),s=r||function(){return(new Date).getTime()};t.exports=s},{"../internal/getNative":40}],6:[function(e,t,n){function a(e,t,n){function a(){h&&clearTimeout(h),p&&clearTimeout(p),v=0,p=h=b=void 0}function l(t,n){n&&clearTimeout(n),p=h=b=void 0,t&&(v=s(),m=e.apply(g,f),h||p||(f=g=void 0))}function c(){var e=t-(s()-_);0>=e||e>t?l(b,p):h=setTimeout(c,e)}function u(){l(x,h)}function d(){if(f=arguments,_=s(),g=this,b=x&&(h||!w),y===!1)var n=w&&!h;else{p||w||(v=_);var a=y-(_-v),r=0>=a||a>y;r?(p&&(p=clearTimeout(p)),v=_,m=e.apply(g,f)):p||(p=setTimeout(u,a))}return r&&h?h=clearTimeout(h):h||t===y||(h=setTimeout(c,t)),n&&(r=!0,m=e.apply(g,f)),!r||h||p||(f=g=void 0),m}var f,p,m,_,g,h,b,v=0,y=!1,x=!0;if("function"!=typeof e)throw new TypeError(i);if(t=0>t?0:+t||0,n===!0){var w=!0;x=!1}else r(n)&&(w=!!n.leading,y="maxWait"in n&&o(+n.maxWait||0,t),x="trailing"in n?!!n.trailing:x);return d.cancel=a,d}var r=e("../lang/isObject"),s=e("../date/now"),i="Expected a function",o=Math.max;t.exports=a},{"../date/now":5,"../lang/isObject":60}],7:[function(e,t,n){function a(e,t){if("function"!=typeof e)throw new TypeError(r);return t=s(void 0===t?e.length-1:+t||0,0),function(){for(var n=arguments,a=-1,r=s(n.length-t,0),i=Array(r);++a<r;)i[a]=n[t+a];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,n[0],i);case 2:return e.call(this,n[0],n[1],i)}var o=Array(t+1);for(a=-1;++a<t;)o[a]=n[a];return o[t]=i,e.apply(this,o)}}var r="Expected a function",s=Math.max;t.exports=a},{}],8:[function(e,t,n){function a(e,t,n){var a=!0,o=!0;if("function"!=typeof e)throw new TypeError(i);return n===!1?a=!1:s(n)&&(a="leading"in n?!!n.leading:a,o="trailing"in n?!!n.trailing:o),r(e,t,{leading:a,maxWait:+t,trailing:o})}var r=e("./debounce"),s=e("../lang/isObject"),i="Expected a function";t.exports=a},{"../lang/isObject":60,"./debounce":6}],9:[function(e,t,n){function a(e,t){var n=-1,a=e.length;for(t||(t=Array(a));++n<a;)t[n]=e[n];return t}t.exports=a},{}],10:[function(e,t,n){function a(e,t){for(var n=-1,a=e.length;++n<a&&t(e[n],n,e)!==!1;);return e}t.exports=a},{}],11:[function(e,t,n){function a(e,t){for(var n=-1,a=e.length;++n<a;)if(t(e[n],n,e))return!0;return!1}t.exports=a},{}],12:[function(e,t,n){function a(e,t,n,a){return void 0!==e&&s.call(a,n)?e:t}var r=Object.prototype,s=r.hasOwnProperty;t.exports=a},{}],13:[function(e,t,n){function a(e,t,n){for(var a=-1,s=r(t),i=s.length;++a<i;){var o=s[a],l=e[o],c=n(l,t[o],o,e,t);(c===c?c===l:l!==l)&&(void 0!==l||o in e)||(e[o]=c)}return e}var r=e("../object/keys");t.exports=a},{"../object/keys":65}],14:[function(e,t,n){function a(e,t){return null==t?e:r(t,s(t),e)}var r=e("./baseCopy"),s=e("../object/keys");t.exports=a},{"../object/keys":65,"./baseCopy":15}],15:[function(e,t,n){function a(e,t,n){n||(n={});for(var a=-1,r=t.length;++a<r;){var s=t[a];n[s]=e[s]}return n}t.exports=a},{}],16:[function(e,t,n){var a=e("./baseForOwn"),r=e("./createBaseEach"),s=r(a);t.exports=s},{"./baseForOwn":19,"./createBaseEach":31}],17:[function(e,t,n){var a=e("./createBaseFor"),r=a();t.exports=r},{"./createBaseFor":32}],18:[function(e,t,n){function a(e,t){return r(e,t,s)}var r=e("./baseFor"),s=e("../object/keysIn");t.exports=a},{"../object/keysIn":66,"./baseFor":17}],19:[function(e,t,n){function a(e,t){return r(e,t,s)}var r=e("./baseFor"),s=e("../object/keys");t.exports=a},{"../object/keys":65,"./baseFor":17}],20:[function(e,t,n){function a(e,t,n,o,l,c){return e===t?!0:null==e||null==t||!s(e)&&!i(t)?e!==e&&t!==t:r(e,t,a,n,o,l,c)}var r=e("./baseIsEqualDeep"),s=e("../lang/isObject"),i=e("./isObjectLike");t.exports=a},{"../lang/isObject":60,"./baseIsEqualDeep":21,"./isObjectLike":45}],21:[function(e,t,n){function a(e,t,n,a,f,_,g){var h=o(e),b=o(t),v=u,y=u;h||(v=m.call(e),v==c?v=d:v!=d&&(h=l(e))),b||(y=m.call(t),y==c?y=d:y!=d&&(b=l(t)));var x=v==d,w=y==d,k=v==y;if(k&&!h&&!x)return s(e,t,v);if(!f){var E=x&&p.call(e,"__wrapped__"),S=w&&p.call(t,"__wrapped__");if(E||S)return n(E?e.value():e,S?t.value():t,a,f,_,g)}if(!k)return!1;_||(_=[]),g||(g=[]);for(var C=_.length;C--;)if(_[C]==e)return g[C]==t;_.push(e),g.push(t);var L=(h?r:i)(e,t,n,a,f,_,g);return _.pop(),g.pop(),L}var r=e("./equalArrays"),s=e("./equalByTag"),i=e("./equalObjects"),o=e("../lang/isArray"),l=e("../lang/isTypedArray"),c="[object Arguments]",u="[object Array]",d="[object Object]",f=Object.prototype,p=f.hasOwnProperty,m=f.toString;t.exports=a},{"../lang/isArray":55,"../lang/isTypedArray":62,"./equalArrays":34,"./equalByTag":35,"./equalObjects":36}],22:[function(e,t,n){function a(e,t,n,f,p){if(!l(e))return e;var m=o(t)&&(i(t)||u(t)),_=m?void 0:d(t);return r(_||t,function(r,i){if(_&&(i=r,r=t[i]),c(r))f||(f=[]),p||(p=[]),s(e,t,i,a,n,f,p);else{var o=e[i],l=n?n(o,r,i,e,t):void 0,u=void 0===l;u&&(l=r),void 0===l&&(!m||i in e)||!u&&(l===l?l===o:o!==o)||(e[i]=l)}}),e}var r=e("./arrayEach"),s=e("./baseMergeDeep"),i=e("../lang/isArray"),o=e("./isArrayLike"),l=e("../lang/isObject"),c=e("./isObjectLike"),u=e("../lang/isTypedArray"),d=e("../object/keys");t.exports=a},{"../lang/isArray":55,"../lang/isObject":60,"../lang/isTypedArray":62,"../object/keys":65,"./arrayEach":10,"./baseMergeDeep":23,"./isArrayLike":41,"./isObjectLike":45}],23:[function(e,t,n){function a(e,t,n,a,d,f,p){for(var m=f.length,_=t[n];m--;)if(f[m]==_)return void(e[n]=p[m]);var g=e[n],h=d?d(g,_,n,e,t):void 0,b=void 0===h;b&&(h=_,o(_)&&(i(_)||c(_))?h=i(g)?g:o(g)?r(g):[]:l(_)||s(_)?h=s(g)?u(g):l(g)?g:{}:b=!1),f.push(_),p.push(h),b?e[n]=a(h,_,d,f,p):(h===h?h!==g:g===g)&&(e[n]=h)}var r=e("./arrayCopy"),s=e("../lang/isArguments"),i=e("../lang/isArray"),o=e("./isArrayLike"),l=e("../lang/isPlainObject"),c=e("../lang/isTypedArray"),u=e("../lang/toPlainObject");t.exports=a},{"../lang/isArguments":54,"../lang/isArray":55,"../lang/isPlainObject":61,"../lang/isTypedArray":62,"../lang/toPlainObject":63,"./arrayCopy":9,"./isArrayLike":41}],24:[function(e,t,n){function a(e){return function(t){return null==t?void 0:t[e]}}t.exports=a},{}],25:[function(e,t,n){function a(e){return null==e?"":e+""}t.exports=a},{}],26:[function(e,t,n){function a(e,t){for(var n=-1,a=t.length,r=Array(a);++n<a;)r[n]=e[t[n]];return r}t.exports=a},{}],27:[function(e,t,n){function a(e,t,n){if("function"!=typeof e)return r;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,a,r){return e.call(t,n,a,r)};case 4:return function(n,a,r,s){return e.call(t,n,a,r,s)};case 5:return function(n,a,r,s,i){return e.call(t,n,a,r,s,i)}}return function(){return e.apply(t,arguments)}}var r=e("../utility/identity");t.exports=a},{"../utility/identity":73}],28:[function(e,t,n){function a(e,t){for(var n=-1,a=e.length;++n<a&&t.indexOf(e.charAt(n))>-1;);return n}t.exports=a},{}],29:[function(e,t,n){function a(e,t){for(var n=e.length;n--&&t.indexOf(e.charAt(n))>-1;);return n}t.exports=a},{}],30:[function(e,t,n){function a(e){return i(function(t,n){var a=-1,i=null==t?0:n.length,o=i>2?n[i-2]:void 0,l=i>2?n[2]:void 0,c=i>1?n[i-1]:void 0;for("function"==typeof o?(o=r(o,c,5),i-=2):(o="function"==typeof c?c:void 0,i-=o?1:0),l&&s(n[0],n[1],l)&&(o=3>i?void 0:o,i=1);++a<i;){var u=n[a];u&&e(t,u,o)}return t})}var r=e("./bindCallback"),s=e("./isIterateeCall"),i=e("../function/restParam");t.exports=a},{"../function/restParam":7,"./bindCallback":27,"./isIterateeCall":43}],31:[function(e,t,n){function a(e,t){return function(n,a){var o=n?r(n):0;if(!s(o))return e(n,a);for(var l=t?o:-1,c=i(n);(t?l--:++l<o)&&a(c[l],l,c)!==!1;);return n}}var r=e("./getLength"),s=e("./isLength"),i=e("./toObject");t.exports=a},{"./getLength":39,"./isLength":44,"./toObject":51}],32:[function(e,t,n){function a(e){return function(t,n,a){for(var s=r(t),i=a(t),o=i.length,l=e?o:-1;e?l--:++l<o;){var c=i[l];if(n(s[c],c,s)===!1)break}return t}}var r=e("./toObject");t.exports=a},{"./toObject":51}],33:[function(e,t,n){function a(e,t){return function(n,a,i){return"function"==typeof a&&void 0===i&&s(n)?e(n,a):t(n,r(a,i,3))}}var r=e("./bindCallback"),s=e("../lang/isArray");t.exports=a},{"../lang/isArray":55,"./bindCallback":27}],34:[function(e,t,n){function a(e,t,n,a,s,i,o){var l=-1,c=e.length,u=t.length;if(c!=u&&!(s&&u>c))return!1;for(;++l<c;){var d=e[l],f=t[l],p=a?a(s?f:d,s?d:f,l):void 0;if(void 0!==p){if(p)continue;return!1}if(s){if(!r(t,function(e){return d===e||n(d,e,a,s,i,o)}))return!1}else if(d!==f&&!n(d,f,a,s,i,o))return!1}return!0}var r=e("./arraySome");t.exports=a},{"./arraySome":11}],35:[function(e,t,n){function a(e,t,n){switch(n){case r:case s:return+e==+t;case i:return e.name==t.name&&e.message==t.message;case o:return e!=+e?t!=+t:e==+t;case l:case c:return e==t+""}return!1}var r="[object Boolean]",s="[object Date]",i="[object Error]",o="[object Number]",l="[object RegExp]",c="[object String]";t.exports=a},{}],36:[function(e,t,n){function a(e,t,n,a,s,o,l){var c=r(e),u=c.length,d=r(t),f=d.length;if(u!=f&&!s)return!1;for(var p=u;p--;){var m=c[p];if(!(s?m in t:i.call(t,m)))return!1}for(var _=s;++p<u;){m=c[p];var g=e[m],h=t[m],b=a?a(s?h:g,s?g:h,m):void 0;if(!(void 0===b?n(g,h,a,s,o,l):b))return!1;_||(_="constructor"==m)}if(!_){var v=e.constructor,y=t.constructor;if(v!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y))return!1}return!0}var r=e("../object/keys"),s=Object.prototype,i=s.hasOwnProperty;t.exports=a},{"../object/keys":65}],37:[function(e,t,n){function a(e){return r[e]}var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};t.exports=a},{}],38:[function(e,t,n){function a(e){return"\\"+r[e]}var r={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};t.exports=a},{}],39:[function(e,t,n){var a=e("./baseProperty"),r=a("length");t.exports=r},{"./baseProperty":24}],40:[function(e,t,n){function a(e,t){var n=null==e?void 0:e[t];return r(n)?n:void 0}var r=e("../lang/isNative");t.exports=a},{"../lang/isNative":59}],41:[function(e,t,n){function a(e){return null!=e&&s(r(e))}var r=e("./getLength"),s=e("./isLength");t.exports=a},{"./getLength":39,"./isLength":44}],42:[function(e,t,n){function a(e,t){return e="number"==typeof e||r.test(e)?+e:-1,t=null==t?s:t,e>-1&&e%1==0&&t>e}var r=/^\d+$/,s=9007199254740991;t.exports=a},{}],43:[function(e,t,n){function a(e,t,n){if(!i(n))return!1;var a=typeof t;if("number"==a?r(n)&&s(t,n.length):"string"==a&&t in n){var o=n[t];return e===e?e===o:o!==o}return!1}var r=e("./isArrayLike"),s=e("./isIndex"),i=e("../lang/isObject");t.exports=a},{"../lang/isObject":60,"./isArrayLike":41,"./isIndex":42}],44:[function(e,t,n){function a(e){return"number"==typeof e&&e>-1&&e%1==0&&r>=e}var r=9007199254740991;t.exports=a},{}],45:[function(e,t,n){function a(e){return!!e&&"object"==typeof e}t.exports=a},{}],46:[function(e,t,n){function a(e){return 160>=e&&e>=9&&13>=e||32==e||160==e||5760==e||6158==e||e>=8192&&(8202>=e||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}t.exports=a},{}],47:[function(e,t,n){var a=/<%-([\s\S]+?)%>/g;t.exports=a},{}],48:[function(e,t,n){var a=/<%([\s\S]+?)%>/g;t.exports=a},{}],49:[function(e,t,n){var a=/<%=([\s\S]+?)%>/g;t.exports=a},{}],50:[function(e,t,n){function a(e){for(var t=l(e),n=t.length,a=n&&e.length,c=!!a&&o(a)&&(s(e)||r(e)),d=-1,f=[];++d<n;){var p=t[d];(c&&i(p,a)||u.call(e,p))&&f.push(p)}return f}var r=e("../lang/isArguments"),s=e("../lang/isArray"),i=e("./isIndex"),o=e("./isLength"),l=e("../object/keysIn"),c=Object.prototype,u=c.hasOwnProperty;t.exports=a},{"../lang/isArguments":54,"../lang/isArray":55,"../object/keysIn":66,"./isIndex":42,"./isLength":44}],51:[function(e,t,n){function a(e){return r(e)?e:Object(e)}var r=e("../lang/isObject");t.exports=a},{"../lang/isObject":60}],52:[function(e,t,n){function a(e){for(var t=-1,n=e.length;++t<n&&r(e.charCodeAt(t)););return t}var r=e("./isSpace");t.exports=a},{"./isSpace":46}],53:[function(e,t,n){function a(e){for(var t=e.length;t--&&r(e.charCodeAt(t)););return t}var r=e("./isSpace");t.exports=a},{"./isSpace":46}],54:[function(e,t,n){function a(e){return s(e)&&r(e)&&o.call(e,"callee")&&!l.call(e,"callee")}var r=e("../internal/isArrayLike"),s=e("../internal/isObjectLike"),i=Object.prototype,o=i.hasOwnProperty,l=i.propertyIsEnumerable;t.exports=a},{"../internal/isArrayLike":41,"../internal/isObjectLike":45}],55:[function(e,t,n){var a=e("../internal/getNative"),r=e("../internal/isLength"),s=e("../internal/isObjectLike"),i="[object Array]",o=Object.prototype,l=o.toString,c=a(Array,"isArray"),u=c||function(e){return s(e)&&r(e.length)&&l.call(e)==i};t.exports=u},{"../internal/getNative":40,"../internal/isLength":44,"../internal/isObjectLike":45}],56:[function(e,t,n){function a(e,t,n,a){n="function"==typeof n?s(n,a,3):void 0;var i=n?n(e,t):void 0;return void 0===i?r(e,t,n):!!i}var r=e("../internal/baseIsEqual"),s=e("../internal/bindCallback");t.exports=a},{"../internal/baseIsEqual":20,"../internal/bindCallback":27}],57:[function(e,t,n){function a(e){return r(e)&&"string"==typeof e.message&&o.call(e)==s}var r=e("../internal/isObjectLike"),s="[object Error]",i=Object.prototype,o=i.toString;t.exports=a},{"../internal/isObjectLike":45}],58:[function(e,t,n){function a(e){return r(e)&&o.call(e)==s}var r=e("./isObject"),s="[object Function]",i=Object.prototype,o=i.toString;t.exports=a},{"./isObject":60}],59:[function(e,t,n){function a(e){return null==e?!1:r(e)?u.test(l.call(e)):s(e)&&i.test(e)}var r=e("./isFunction"),s=e("../internal/isObjectLike"),i=/^\[object .+?Constructor\]$/,o=Object.prototype,l=Function.prototype.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=a},{"../internal/isObjectLike":45,"./isFunction":58}],60:[function(e,t,n){function a(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=a},{}],61:[function(e,t,n){function a(e){var t;if(!i(e)||u.call(e)!=o||s(e)||!c.call(e,"constructor")&&(t=e.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var n;return r(e,function(e,t){n=t}),void 0===n||c.call(e,n)}var r=e("../internal/baseForIn"),s=e("./isArguments"),i=e("../internal/isObjectLike"),o="[object Object]",l=Object.prototype,c=l.hasOwnProperty,u=l.toString;t.exports=a},{"../internal/baseForIn":18,"../internal/isObjectLike":45,"./isArguments":54}],62:[function(e,t,n){function a(e){return s(e)&&r(e.length)&&!!O[T.call(e)]}var r=e("../internal/isLength"),s=e("../internal/isObjectLike"),i="[object Arguments]",o="[object Array]",l="[object Boolean]",c="[object Date]",u="[object Error]",d="[object Function]",f="[object Map]",p="[object Number]",m="[object Object]",_="[object RegExp]",g="[object Set]",h="[object String]",b="[object WeakMap]",v="[object ArrayBuffer]",y="[object Float32Array]",x="[object Float64Array]",w="[object Int8Array]",k="[object Int16Array]",E="[object Int32Array]",S="[object Uint8Array]",C="[object Uint8ClampedArray]",L="[object Uint16Array]",A="[object Uint32Array]",O={};O[y]=O[x]=O[w]=O[k]=O[E]=O[S]=O[C]=O[L]=O[A]=!0,O[i]=O[o]=O[v]=O[l]=O[c]=O[u]=O[d]=O[f]=O[p]=O[m]=O[_]=O[g]=O[h]=O[b]=!1;var j=Object.prototype,T=j.toString;t.exports=a},{"../internal/isLength":44,"../internal/isObjectLike":45}],63:[function(e,t,n){function a(e){return r(e,s(e))}var r=e("../internal/baseCopy"),s=e("../object/keysIn");t.exports=a},{"../internal/baseCopy":15,"../object/keysIn":66}],64:[function(e,t,n){var a=e("../internal/assignWith"),r=e("../internal/baseAssign"),s=e("../internal/createAssigner"),i=s(function(e,t,n){return n?a(e,t,n):r(e,t)});t.exports=i},{"../internal/assignWith":13,"../internal/baseAssign":14,"../internal/createAssigner":30}],65:[function(e,t,n){var a=e("../internal/getNative"),r=e("../internal/isArrayLike"),s=e("../lang/isObject"),i=e("../internal/shimKeys"),o=a(Object,"keys"),l=o?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&r(e)?i(e):s(e)?o(e):[]}:i;t.exports=l},{"../internal/getNative":40,"../internal/isArrayLike":41,"../internal/shimKeys":50,"../lang/isObject":60}],66:[function(e,t,n){function a(e){if(null==e)return[];l(e)||(e=Object(e));var t=e.length;t=t&&o(t)&&(s(e)||r(e))&&t||0;for(var n=e.constructor,a=-1,c="function"==typeof n&&n.prototype===e,d=Array(t),f=t>0;++a<t;)d[a]=a+"";for(var p in e)f&&i(p,t)||"constructor"==p&&(c||!u.call(e,p))||d.push(p);return d}var r=e("../lang/isArguments"),s=e("../lang/isArray"),i=e("../internal/isIndex"),o=e("../internal/isLength"),l=e("../lang/isObject"),c=Object.prototype,u=c.hasOwnProperty;t.exports=a},{"../internal/isIndex":42,"../internal/isLength":44,"../lang/isArguments":54,"../lang/isArray":55,"../lang/isObject":60}],67:[function(e,t,n){var a=e("../internal/baseMerge"),r=e("../internal/createAssigner"),s=r(a);t.exports=s},{"../internal/baseMerge":22,"../internal/createAssigner":30}],68:[function(e,t,n){function a(e){return e=r(e),e&&o.test(e)?e.replace(i,s):e}var r=e("../internal/baseToString"),s=e("../internal/escapeHtmlChar"),i=/[&<>"'`]/g,o=RegExp(i.source);t.exports=a},{"../internal/baseToString":25,"../internal/escapeHtmlChar":37}],69:[function(e,t,n){function a(e,t,n){var a=_.imports._.templateSettings||_;n&&f(e,t,n)&&(t=n=void 0),e=l(e),t=s(o({},n||t),a,r);var w,k,E=s(o({},t.imports),a.imports,r),S=p(E),C=c(E,S),L=0,A=t.interpolate||y,O="__p += '",j=RegExp((t.escape||y).source+"|"+A.source+"|"+(A===m?v:y).source+"|"+(t.evaluate||y).source+"|$","g"),T="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";e.replace(j,function(t,n,a,r,s,i){return a||(a=r),O+=e.slice(L,i).replace(x,u),n&&(w=!0,O+="' +\n__e("+n+") +\n'"),s&&(k=!0,O+="';\n"+s+";\n__p += '"),a&&(O+="' +\n((__t = ("+a+")) == null ? '' : __t) +\n'"),L=i+t.length,t}),O+="';\n";var I=t.variable;I||(O="with (obj) {\n"+O+"\n}\n"),O=(k?O.replace(g,""):O).replace(h,"$1").replace(b,"$1;"),O="function("+(I||"obj")+") {\n"+(I?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(w?", __e = _.escape":"")+(k?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+O+"return __p\n}";var N=i(function(){return Function(S,T+"return "+O).apply(void 0,C)});if(N.source=O,d(N))throw N;return N}var r=e("../internal/assignOwnDefaults"),s=e("../internal/assignWith"),i=e("../utility/attempt"),o=e("../internal/baseAssign"),l=e("../internal/baseToString"),c=e("../internal/baseValues"),u=e("../internal/escapeStringChar"),d=e("../lang/isError"),f=e("../internal/isIterateeCall"),p=e("../object/keys"),m=e("../internal/reInterpolate"),_=e("./templateSettings"),g=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,b=/(__e\(.*?\)|\b__t\)) \+\n'';/g,v=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,y=/($^)/,x=/['\n\r\u2028\u2029\\]/g;t.exports=a},{"../internal/assignOwnDefaults":12,"../internal/assignWith":13,"../internal/baseAssign":14,"../internal/baseToString":25,"../internal/baseValues":26,"../internal/escapeStringChar":38,"../internal/isIterateeCall":43,"../internal/reInterpolate":49,"../lang/isError":57,"../object/keys":65,"../utility/attempt":72,"./templateSettings":70}],70:[function(e,t,n){var a=e("./escape"),r=e("../internal/reEscape"),s=e("../internal/reEvaluate"),i=e("../internal/reInterpolate"),o={escape:r,evaluate:s,interpolate:i,variable:"",imports:{_:{escape:a}}};t.exports=o},{"../internal/reEscape":47,"../internal/reEvaluate":48,"../internal/reInterpolate":49,"./escape":68}],71:[function(e,t,n){function a(e,t,n){var a=e;return(e=r(e))?(n?o(a,t,n):null==t)?e.slice(l(e),c(e)+1):(t+="",e.slice(s(e,t),i(e,t)+1)):e}var r=e("../internal/baseToString"),s=e("../internal/charsLeftIndex"),i=e("../internal/charsRightIndex"),o=e("../internal/isIterateeCall"),l=e("../internal/trimmedLeftIndex"),c=e("../internal/trimmedRightIndex");t.exports=a},{"../internal/baseToString":25,"../internal/charsLeftIndex":28,"../internal/charsRightIndex":29,"../internal/isIterateeCall":43,"../internal/trimmedLeftIndex":52,"../internal/trimmedRightIndex":53}],72:[function(e,t,n){var a=e("../lang/isError"),r=e("../function/restParam"),s=r(function(e,t){try{return e.apply(void 0,t)}catch(n){return a(n)?n:new Error(n)}});t.exports=s},{"../function/restParam":7,"../lang/isError":57}],73:[function(e,t,n){function a(e){return e}t.exports=a},{}],74:[function(e,t,n){var a,r="",s="wav",i=.5;t.exports={init:function(e){return a=document.createElement("audio"),a.setAttribute("autoplay",!0),e&&(r=e),this},play:function(e,t){e&&(a.src=r+e+"."+s),t?a.setAttribute("loop",!0):a.removeAttribute("loop"),a.volume=i,a.play()},stop:function(){a.pause(),a.currentTime=0}}},{}],75:[function(e,t,n){function a(){return L}function r(e){return L?E.info("Cobrowsing already initiated"):(b(document,"keyup",f),b(document,"keydown",f),b(document,"keypress",f),b(document,"mouseup",f),b(document,"click",f),b(document,"change",f),y="string"==typeof e.widget?document.querySelector(e.widget):e.widget,j=e.entity,x=e.emit,T=e.path,L=!0,E.log("cobrowsing module initiated with parameters: ",e),void x("cobrowsing/init"))}function s(){return A?E.info("Browser already shared"):(b(document,"scroll",f),b(document,"select",f),b(document,"mousemove",f),o(),A=!0,E.log("browser shared"),void x("cobrowsing/shared",{entity:j}))}function i(){return A?(v(document,"scroll",f),v(document,"select",f),v(document,"mousemove",f),c(),A=!1,x("cobrowsing/unshared",{entity:j}),void E.log("browser unshared")):E.info("Browser already unshared")}function o(){var e=document.body;O||(O=document.createElement("img"),O.className="wc-rmt-ptr",O.setAttribute("src",T+"images/pointer.png"),O.style.position="absolute",e.firstChild?e.insertBefore(O,e.firstChild):e.appendChild(O),l())}function l(){O.style.left=N,O.style.top=R,w=window.requestAnimationFrame(l)}function c(){O&&(cancelAnimationFrame(w),O.parentNode.removeChild(O),O=null)}function u(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else t=(!e.type||"email"!==e.type&&"number"!==e.type)&&(e.selectionStart||"0"==e.selectionStart)?e.selectionStart:null;return t}function d(){x("cobrowsing/event",{entity:j,events:C}),C=[]}function f(e){var t=e||window.event,n=t.type,a=t.target,r=a.nodeName,s=document.body,i={},o=null,l=document.getElementsByTagName(a.nodeName),c=document.documentElement.scrollTop||document.body.scrollTop,f=document.documentElement.scrollLeft||document.body.scrollLeft,p=0;if(3===a.nodeType&&(a=a.parentNode),"user"!==j||!h(y,a)){for(p=0;p<S.length;p++)if(S[p].event==n)return void S.splice(p,1);for(p=0;p<l.length;p++)l[p]==a&&(o=p);if(i.event=n,i.entity=j,i.tn=r,i.tni=o,i.w=s.offsetWidth,i.h=s.offsetHeight,i.sx=f,i.sy=c,"mousemove"===n||"mouseover"===n||"mouseout"===n){var m=t.pageX||t.clientX+c,_=t.pageY||t.clientY+f;i.x=m,i.y=_}else if("scroll"===n);else if("keyup"==n||"keydown"==n||"keypress"==n){var g=t.charCode||t.keyCode||t.which,b=u(a);if("INPUT"===r&&"password"===a.type)return;if("keyup"==n){if(null!==b&&(86!=g||!t.metaKey&&!t.ctrlKey))return;var v=a.value;v&&(v=v.replace(/\n/g,"<br>"),i.value=v)}else if("keydown"==n){if(null===b||8!=g&&46!=g&&190!=g)return;if(!a.value)return;i.pos=b,i.code=g}else if("keypress"===n){if(null===b||8==g||46==g)return;i.pos=b,i.code=g}}else if("change"===n){if("INPUT"===r&&"password"===a.type)return;i.value=a.value}else if("mouseup"==n||"select"==n){var x=window.getSelection()||document.selection.createRange().text,w=x.anchorOffset,k=x.focusOffset,E=0,L="",A=0,O="",T=0,I="",N=0,R="",M=!1;if(null!==x.anchorNode){for(O=x.anchorNode.parentNode,p=0;p<O.childNodes.length;p++)O.childNodes[p]==x.anchorNode&&(A=p);for(L=O.nodeName.toLowerCase(),l=document.getElementsByTagName(L),p=0;p<l.length;p++)l[p]===O&&(E=p);for(R=x.focusNode.parentNode,p=0;p<R.childNodes.length;p++)R.childNodes[p]==x.focusNode&&(N=p);for(I=R.nodeName.toLowerCase(),l=document.getElementsByTagName(I),p=0;p<l.length;p++)l[p]===R&&(T=p);L===I&&E===T&&A===N&&w>k&&(M=!0),i.sn=L,i.sni=E,i.schi=A,i.en=I,i.eni=T,i.echi=N,i.so=M?k:w,i.eo=M?w:k}}else"click"==n&&(i.scx=t.screenX,i.scy=t.screenY);C.push(i),d()}}function p(e){var t,n=document.documentElement,a={};if(e.events&&e.events.length)for(var r=0;r<e.events.length;r++)if(a=e.events[r],!(a.timestamp<I)&&a.entity!==j){if(a.url){var s=a.url,i=document.URL;-1!==i.indexOf("chatSessionId")&&(i=i.substr(0,i.indexOf("chatSessionId")-1)),s!=i&&g(s)}if(a.w&&"user"===a.entity){var o=document.body,l=o.offsetWidth;l!==a.w&&(document.body.style.width=a.w+"px")}if("mousemove"===a.event)O&&(N=a.x+"px",R=a.y+"px");else if("scroll"===a.event)void 0!==a.tn&&(t="#document"===a.tn?n:document.getElementsByTagName(a.tn)[a.tni],t&&(t.scrollTop=a.sy,t.scrollLeft=a.sx),console.log("scroll event: ",t,a.sy));else if("mouseup"===a.event||"select"===a.event){if(a.sn){var c=document.getElementsByTagName(a.sn)[a.sni],u=document.getElementsByTagName(a.en)[a.eni];if(document.createRange&&void 0!==c&&void 0!==u){var d=document.createRange();d.setStart(c.childNodes[a.schi],a.so),d.setEnd(u.childNodes[a.echi],a.eo);var f=window.getSelection();f.removeAllRanges(),f.addRange(d)}}}else if("keyup"===a.event||"keydown"===a.event||"keypress"===a.event){if(void 0!==a.tn&&void 0!==a.tni&&(t=document.getElementsByTagName(a.tn)[a.tni])){var p,h=t.value;if(8==a.code){if(a.pos==h.length-1)p=h.substr(0,a.pos-1);else{if(0===a.pos)return;p=h.substr(0,a.pos-1)+h.substr(a.pos)}t.value=p}else if(46==a.code)p=h.substr(0,a.pos)+h.substr(a.pos+1),t.value=p;else if(190==a.code)p=h.substr(0,a.pos)+"."+h.substr(a.pos),t.value=p;else if(void 0!==a.value){var b=a.value;b=b.replace(/<br>/g,"\n"),t.value=b}else{var v=String.fromCharCode(a.code);p=h?h.substr(0,a.pos)+v+h.substr(a.pos):v,t.value=p}}}else if("change"===a.event)t=document.getElementsByTagName(a.tn)[a.tni],t.value=a.value;else if("click"===a.event)t=document.getElementsByTagName(a.tn)[a.tni],t&&t.click();else if(t=document.getElementsByTagName(a.tn)[a.tni]){var y=m(a.event,a.x,a.y,a.x,a.y);
_(t,y)}"click"!==a.event&&"scroll"!==a.event||S.push(a)}e.timestamp&&(I=e.timestamp)}function m(e,t,n,a,r){var s,i={bubbles:!0,cancelable:"mousemove"!=e,view:window,detail:0,screenX:t,screenY:n,clientX:a,clientY:r,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};if("function"==typeof document.createEvent)s=document.createEvent("MouseEvents"),s.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,document.body.parentNode);else if(document.createEventObject){s=document.createEventObject();for(var o in i)s[o]=i[o];s.button={0:1,1:4,2:2}[s.button]||s.button}return s}function _(e,t){return e.dispatchEvent?e.dispatchEvent(t):e.fireEvent&&e.fireEvent("on"+type,t),t}function g(e){var t=document.URL;t!==e&&(document.location.href=e)}function h(e,t){for(var n=t.parentNode;null!=n;){if(n==e)return!0;n=n.parentNode}return!1}function b(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function v(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}var y,x,w,k=e("./lodash"),E=e("./debug"),S=[],C=[],L=!1,A=!1,O=null,j="",T="",I=0,N=(k.debounce(d,300),0),R=0;t.exports={init:r,isInitiated:a,share:s,unshare:i,emitEvents:d,updateEvents:p}},{"./debug":77,"./lodash":78}],76:[function(e,t,n){(function(n){function a(e){return this.options=u.assign(g,e||{}),this.options.serverUrl=this.options.server+"/ipcc/$$$",this.session={},this.options.pageid?(m=p+this.options.pageid,this.createWebsocket(),this.on("session/create",function(e){this.session=e,i.saveState("sid",e.sid)}.bind(this)),this.on("chat/close",function(e){i.saveState("chat",!1)}),this.on("Error",this.onError),this):console.error("Cannot initiate module: pageid is undefined")}function r(e){var t=1e3*(Math.pow(2,e)-1);return t>3e4&&(t=3e4),Math.random()*t}var s=e("events").EventEmitter,i=e("./storage"),o=e("./request"),l=e("./debug"),c=n.location,u=e("./lodash"),d=e("inherits"),f=1,p="main.ringotel.net/chatbot/WebChat/",m="",_=!1,g={server:""};d(a,s),t.exports=a,a.prototype.onError=function(e){l.error(e),404===e.code&&this.emit("session/timeout")},a.prototype.sendData=function(e){this.websocket&&this.websocket.send(JSON.stringify(e))},a.prototype.onWebsocketMessage=function(e){var t=JSON.parse(e.data);t.method;l.log("onWebsocketMessage: ",t),t.method&&("session"===t.method?this.emit("session/create",t.params):"messages"===t.method?t.params.list&&t.params.list.map(function(e){return this.emit("message/new",e),e}.bind(this)):"message"===t.method?t.params.typing?this.emit("message/typing"):this.emit("message/new",t.params):"openShare"===t.method?t.params.id&&(i.saveState("sharedId",t.params.id,"cache"),this.emit("session/join",{url:c.href}),this.shareOpened(t.params.id,c.href)):"shareOpened"===t.method?t.params.id&&(clearInterval(this.openShareInteval),i.saveState("sharedId",t.params.id,"cache"),this.emit("session/join",{url:c.href})):"shareClosed"===t.method?this.emit("session/disjoin"):"events"===t.method&&this.emit("cobrowsing/update",{events:t.params.events}))},a.prototype.init=function(){_=!0;var e=i.getState("entity","session"),t=i.getState("sid");l.log("initModule: ",e,t),-1!==c.href.indexOf("chatSessionId")?(t=this.getSidFromUrl(c.href),i.saveState("entity","agent","session"),i.saveState("sid",t,"session"),this.session.sid=t,this.joinSession(c.href)):"agent"===e?(t=i.getState("sid","session"),this.session.sid=t,this.joinSession(c.href)):(i.saveState("entity","user","session"),this.session.sid=t,t?(i.saveState("sid",t),this.createSession({sid:t,url:c.href})):this.createSession({url:c.href}))},a.prototype.createSession=function(e){var t={method:"createSession",params:{url:e.url||c.href}};return e.sid&&(t.params.sid=e.sid),this.websocket?this.sendData(t):void o.post(this.options.serverUrl,t,function(t,n){return t?void this.emit("Error",t,{method:"createSession",params:e}):void this.emit("session/create",n.result)}.bind(this))},a.prototype.joinSession=function(e){this.openShareInteval=setInterval(function(){this.switchShareState("openShare",e)}.bind(this),500),n.onclose=function(){this.switchShareState("shareClosed",e)}.bind(this)},a.prototype.updateEvents=function(e,t){return data={method:"events",params:{sid:this.session.sid,id:i.getState("sharedId","cache"),timestamp:i.getState("eventTimestamp","cache"),events:e}},this.websocket?this.sendData(data):void o.post(this.options.serverUrl,data,function(e,n){return e?(this.emit("Error",e,data),t(e)):void(n.result.timestamp>i.getState("eventTimestamp","cache")?(i.saveState("eventTimestamp",n.result.timestamp,"cache"),t&&t(null,n.result)):t&&t(null,{events:[]}))}.bind(this))},a.prototype.getLanguages=function(e){l.log("this.session: ",this.session),e(null,this.session.langs)},a.prototype.chatRequest=function(e,t){e.sid=this.session.sid,l.log("chatRequest params: ",e);var n={method:"chatRequest",params:e};return this.websocket?this.sendData(n):void o.post(this.options.serverUrl,n,function(n,a){return n?(this.emit("Error",n,{method:"chatRequest",params:e}),void(t&&t(n))):(e.url=c.href,this.emit("chat/start",u.merge(e,a.result)),void(t&&t(null,a)))}.bind(this))},a.prototype.getMessages=function(e){o.post(this.options.serverUrl,{method:"getMessages",params:{sid:this.session.sid,timestamp:i.getState("msgTimestamp")}},function(t,n){return t?(this.emit("Error",t,{method:"getMessages"}),e(t)):(n.result.timestamp>i.getState("msgTimestamp")&&(i.saveState("msgTimestamp",n.result.timestamp),n.result.messages&&this.emit("message/new",n.result)),n.result.typing&&this.emit("message/typing",n.result),void(e&&e(null,n.result)))}.bind(this))},a.prototype.closeChat=function(e){var t={method:"closeChat",params:{sid:this.session.sid}};return e&&(t.params.rating=e),this.websocket?this.sendData(t):void o.post(this.options.serverUrl,t,function(n,a){return n?void this.emit("Error",n,t):(i.saveState("chat",!1),void this.emit("chat/close",{rating:e,url:c.href}))}.bind(this))},a.prototype.sendMessage=function(e,t){var n={method:"message",params:{sid:this.session.sid,content:e.message}};return this.websocket?(e.file&&(n.params.content=e.file,n.params.file=e.message),this.sendData(n)):void o.post(this.options.serverUrl,n,function(e,a){return e?(this.emit("Error",e,{method:"sendMessage",params:n}),void(t&&t(e))):void(t&&t())})},a.prototype.sendEmail=function(e,t){e.sid=this.session.sid;var n={method:"sendMail",params:e};return this.websocket?this.sendData(n):void o.post(this.options.serverUrl,n,function(n,a){return n?(this.emit("Error",n,{method:"sendEmail",params:e}),void(t&&t(n))):(this.emit("chat/send",e),void(t&&t(null,a)))}.bind(this))},a.prototype.requestCallback=function(e,t){e.sid=this.session.sid;var n={method:"requestCallback",params:e};return this.websocket?this.sendData(n):void o.post(this.options.serverUrl,n,function(n,a){return n?(this.emit("Error",n,{method:"requestCallback",params:e}),t(n)):void(t&&t(null,a.result))}.bind(this))},a.prototype.disjoinSession=function(e){var t={method:"disjoinSession",params:{sid:e}};return this.websocket?this.sendData(t):void o.post(this.options.serverUrl,t,function(t,n){return t?void this.emit("Error",t,{method:"disjoinSession",params:{sid:e}}):void this.emit("session/disjoin",{url:c.href})}.bind(this))},a.prototype.shareOpened=function(e,t){var n={method:"shareOpened",params:{id:e,url:t}};return this.websocket?this.sendData(n):void 0},a.prototype.switchShareState=function(e,t){var n=e,a={method:n,params:{sid:this.session.sid,url:t}};return this.websocket?this.sendData(a):void o.post(this.options.serverUrl,a,function(t,n){return t?void this.emit("Error",t,{method:"switchShareState",params:{state:e}}):void 0}.bind(this))},a.prototype.setChatTimeout=function(e){return setTimeout(function(){this.emit("chat/timeout")}.bind(this),1e3*e)},a.prototype.userIsTyping=function(){var e={method:"typing",params:{sid:this.session.sid}};return this.websocket?this.sendData(e):void o.post(this.options.serverUrl,e,function(e){return e?void this.emit("Error",e,{method:"setChatTimeout"}):void 0}.bind(this))},a.prototype.updateUrl=function(e){var t={method:"updateUrl",params:{sid:this.session.sid,url:e}};return this.websocket?this.sendData(t):void o.post(this.options.serverUrl,t,function(t,n){return t?void this.emit("Error",t,{method:"updateUrl",params:{url:e}}):void 0}.bind(this))},a.prototype.linkFollowed=function(e){var t={method:"linkFollowed",params:{sid:this.session.sid,url:e}};return this.websocket?this.sendData(t):void o.post(this.options.serverUrl,t,function(t,n){return t?void this.emit("Error",t,{method:"linkFollowed",params:{url:e}}):void 0}.bind(this))},a.prototype.getSidFromUrl=function(e){var t=e.substring(e.indexOf("chatSessionId="));return t=t.substring(t.indexOf("=")+1)},a.prototype.createWebsocket=function(e){var t="wss:",a=new WebSocket(t+"//"+m,"json.api.smile-soft.com");a.onopen=function(e){console.log("WebSocket opened: ",e),f=1,_||this.init()}.bind(this),a.onmessage=this.onWebsocketMessage.bind(this),a.onclose=this.onWebsocketClose.bind(this),a.onerror=this.onError,n.onbeforeunload=function(){a.onclose=function(){},a.close()},this.websocket=a},a.prototype.onWebsocketClose=function(e){console.log("WebSocket closed",e);var t=r(f);setTimeout(function(){f++,this.createWebsocket()}.bind(this),t)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./debug":77,"./lodash":78,"./request":80,"./storage":81,events:2,inherits:3}],77:[function(e,t,n){(function(e){function n(t,n){return e.localStorage.getItem("swc.debug")?void[].forEach.call(t,function(t){e.console[n]?e.console[n](t):e.console.log(t)}):void 0}t.exports={log:function(){n(arguments,"log")},info:function(){n(arguments,"info")},warn:function(){n(arguments,"warn")},error:function(){n(arguments,"error")}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],78:[function(e,t,n){function a(e,t,n){var a;return function(){var r=this,s=arguments,i=function(){a=null,n||e.apply(r,s)},o=n&&!a;clearTimeout(a),a=setTimeout(i,t),o&&e.apply(r,s)}}function r(e,t){for(var n=t.charAt(0);e&&e!==document;e=e.parentNode)if("."===n){if(e.classList.contains(t.substr(1)))return e}else if("#"===n){if(e.id===t.substr(1))return e}else if("["===n){if(e.hasAttribute(t.substr(1,t.length-2)))return e}else if(e.nodeName===t.toUpperCase())return e;return!1}function s(e,t,n,a,r){var s=Number(new Date)+(a||2e3);r=r||300,function i(){e()?t():Number(new Date)<s?setTimeout(i,r):n(new Error("timed out for "+e+": "+arguments))}()}var i=e("lodash/string/template"),o=e("lodash/collection/forEach"),l=e("lodash/object/assign"),c=e("lodash/object/merge"),u=e("lodash/lang/isEqual"),d=e("lodash/string/trim"),f=e("lodash/function/throttle");e("lodash/function/debounce");t.exports={template:i,forEach:o,assign:l,merge:c,isEqual:u,trim:d,throttle:f,debounce:a,poll:s,findParent:r}},{"lodash/collection/forEach":4,"lodash/function/debounce":6,"lodash/function/throttle":8,"lodash/lang/isEqual":56,"lodash/object/assign":64,"lodash/object/merge":67,"lodash/string/template":69,"lodash/string/trim":71}],79:[function(e,t,n){var a=e("./widget.js");e("./core.js");t.exports=a.module},{"./core.js":76,"./widget.js":84}],80:[function(e,t,n){function a(e,t,n){var t=JSON.stringify(t);i("POST",e,t,function(e,t){return o.log("post respose: ",e,t),e?n(e):void n(null,t)})}function r(e,t,n){return e&&l[e]?n(null,l[e]):void i("GET",t,null,function(t,a){return t?n(t):(e&&(l[e]=a),void n(null,a))})}function s(e,t,n){i("PUT",e,t,function(e,t){return o.log("put respose: ",e,t),e?n(e):void n(null,t)})}function i(e,t,n,a){var r,s,i;r=new XMLHttpRequest,r.open(e,t,!0),i=setTimeout(function(){r.abort()},6e4),r.onreadystatechange=function(){if(4==r.readyState&&(clearTimeout(i),r.response)){if(s="POST"===e?JSON.parse(r.response):r.response,s.error)return a(s.error);a(null,s)}},"POST"===e&&r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n?r.send(n):r.send()}var o=e("./debug"),l={};t.exports={post:a,get:r,put:s}},{"./debug":77}],81:[function(e,t,n){(function(e){function n(e,t){return"session"===t?JSON.parse(c.getItem(u+d+e)):JSON.parse(l.getItem(u+d+e))}function a(e,t,n){return"session"===n?c.setItem(u+d+e,JSON.stringify(t)):l.setItem(u+d+e,JSON.stringify(t)),t}function r(e,t){"session"===t?c.removeItem(u+d+e):l.removeItem(u+d+e)}function s(e,t){return t?"cache"===t?f[e]:n(e,t):void 0!==f[e]&&null!==f[e]?f[e]:n(e)}function i(e,t,n){return f[e]=t,"cache"!==n&&a(e,t,n),t}function o(e,t){delete f[e],r(e)}var l=e.localStorage,c=e.sessionStorage,u="swc",d=".",f={sid:null,eventTimestamp:0,msgTimestamp:0,entity:void 0,chat:null};t.exports={get:n,set:a,remove:r,getState:s,saveState:i,removeState:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],82:[function(require,module,exports){var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(e){return e?String(e).replace(escapeRegexp,function(e){return escapeMap[e]}):""},exports.email=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj){var prefix=defaults.prefix;__p+='\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml">\n    <head>\n        <meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />\n        <!--[if !mso]><!-->\n            <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n        <!--<![endif]-->\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title></title>\n        <!--[if (gte mso 9)|(IE)]>\n        <style type="text/css">\n            table {border-collapse: collapse;}\n        </style>\n        <![endif]-->\n        <style type="text/css">\n            /* Basics */\n            body {\n            Margin: 0;\n                padding: 0;\n                min-width: 100%;\n                background-color: #ffffff;\n            }\n            table {\n                border-spacing: 0;\n                font-family: sans-serif;\n                color: #333333;\n            }\n            td {\n                padding: 0;\n            }\n            img {\n                border: 0;\n            }\n            .wrapper {\n                width: 100%;\n                table-layout: fixed;\n                -webkit-text-size-adjust: 100%;\n                -ms-text-size-adjust: 100%;\n                background-color: #F1F1F1;\n            }\n            .webkit {\n                max-width: 500px;\n            }\n            .outer {\n            Margin: 0 auto;\n                height: 100%;\n                width: 95%;\n                max-width: 500px;\n                padding: 10px;\n            }\n            p {\n                Margin: 0;\n            }\n            a {\n                color: #ee6a56;\n                text-decoration: underline;\n            }\n            .h1 {\n                font-size: 21px;\n                font-weight: bold;\n                Margin-bottom: 18px;\n            }\n            .h2 {\n                font-size: 18px;\n                font-weight: bold;\n                Margin-bottom: 12px;\n            }\n             \n            /* One column layout */\n            .one-column .contents {\n                text-align: left;\n                color:#505050;\n                font-family:Arial;\n                font-size:14px;\n                line-height:150%;\n            }\n            .one-column p {\n                font-size: 14px;\n                Margin-bottom: 10px;\n            }\n            .'+__e(prefix)+"-message {\n                display: block;\n                margin-bottom: 10px;\n                padding: 10px;\n                background-color: #FFFFFF;\n                border-bottom: 4px solid #CCCCCC;\n            }\n            ."+__e(prefix)+"-message img {\n                width: 100%;\n                max-width: 500px;\n                height: auto;\n            }\n            ."+__e(prefix)+"-message span {\n                font-weight: bold;\n                color: #999999;\n            }\n            ."+__e(prefix)+"-agent-msg ."+__e(prefix)+"-message-from {\n                color: #555555;\n            }\n            ."+__e(prefix)+"-user-msg ."+__e(prefix)+"-message-from {\n                color: #F75B5D;\n            }\n\n            ."+__e(prefix)+"-message ."+__e(prefix)+'-message-time {\n                position: relative;\n                float: right;\n            }\n            .copyright {\n                margin-top: 5px;\n                font-size: 12px;\n                font-style: italic;\n                color: #CCCCCC;\n                text-align: right;\n            }\n\n        </style>\n    </head>\n    <body>\n        <center class="wrapper">\n            <div class="webkit">\n                <!--[if (gte mso 9)|(IE)]>\n                <table width="500" align="center" cellpadding="0" cellspacing="0" border="0">\n                <tr>\n                <td>\n                <![endif]-->\n                <table class="outer" align="center" cellpadding="0" cellspacing="0" border="0">\n                    <tr>\n                        <td class="one-column">\n                            <table width="100%">\n                                <tr>\n                                    <td class="inner contents">\n                                        '+(null==(__t=content)?"":__t)+"\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                </table>\n                <!--[if (gte mso 9)|(IE)]>\n                </td>\n                </tr>\n                </table>\n                <![endif]-->\n            </div>\n        </center>\n    </body>\n</html>"}return __p};var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(e){return e?String(e).replace(escapeRegexp,function(e){return escapeMap[e]}):""},exports.forms=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="'+__e(defaults.prefix)+"-message "+__e(defaults.prefix)+"-"+__e(message.entity)+'-msg">\n	<span class="'+__e(defaults.prefix)+'-message-from">'+__e(message.from)+'</span>\n	<div class="'+__e(defaults.prefix)+'-message-content" ',"user"===message.entity&&(__p+=" style=\"border-color:'"+__e(defaults.styles.primary.backgroundColor)+'" '),__p+=">\n		",form.description&&(__p+="\n			<p>"+(null==(__t=frases.FORMS.DESCRIPTIONS[form.description]||form.description)?"":__t)+"</p>\n		"),__p+='\n		<form name="'+__e(form.name)+'" ',form.autocomplete&&(__p+='autocomplete="on"'),__p+=' data-validate-form="true">\n			',_.forEach(form.fields,function(e){__p+="\n				","select"!==e.type&&(__p+='\n					<input \n						type="'+(null==(__t=e.type||"text")?"":__t)+'"\n						placeholder="'+(null==(__t=frases.FORMS.PLACEHOLDERS[e.placeholder]||frases.FORMS.PLACEHOLDERS[e.name])?"":__t)+" ",e.required&&(__p+="*"),__p+='"\n						name="'+__e(e.name)+'" ',e.value&&(__p+='\n						value="'+__e(credentials[e.value])+'" '),__p+=" ",e.required&&(__p+="required"),__p+=">\n				"),__p+="\n				","select"===e.type&&(__p+='\n					<select name="'+__e(e.name)+'">\n						',_.forEach(e.options,function(e){__p+='\n							<option value="'+__e(e.value)+'" ',e.selected&&(__p+=" selected "),__p+=" >\n								"+__e(frases.FORMS.PLACEHOLDERS[e.text]||e.text)+"\n							</option>\n						"}),__p+="\n					</select>\n				"),__p+="\n			"}),__p+='\n			<button \n				type="submit"\n				class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block"\n				style="background-color: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+"; border: 1px solid "+__e(defaults.styles.primary.backgroundColor)+';">'+__e(frases.FORMS.send)+'</button>\n			<button\n				class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block"\n				data-'+__e(defaults.prefix)+'-handler="rejectForm">'+__e(frases.FORMS.cancel)+'</button>\n		</form>\n	</div>\n	<span class="'+__e(defaults.prefix)+'-message-time"> '+__e(message.time)+"</span>\n</div>";return __p};var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(e){return e?String(e).replace(escapeRegexp,function(e){return escapeMap[e]}):""},exports.message=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="'+__e(defaults.prefix)+"-message "+__e(defaults.prefix)+"-"+__e(message.entity)+'-msg">\n	<span class="'+__e(defaults.prefix)+'-message-from">'+__e(message.from)+'</span>\n	<div class="'+__e(defaults.prefix)+'-message-content" \n		',"user"===message.entity&&(__p+=' \n			style="border-color:',defaults.styles.primary.backgroundColor,__p+='" \n		'),__p+=">\n		<p>"+(null==(__t=message.content)?"":__t)+'</p>\n	</div>\n	<span class="'+__e(defaults.prefix)+'-message-time"> '+__e(message.time)+"</span>\n</div>";return __p};var _={},escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},escapeRegexp=new RegExp("["+Object.keys(escapeMap).join("")+"]","g");_.escape=function(e){return e?String(e).replace(escapeRegexp,function(e){return escapeMap[e]}):""},exports.widget=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj){var frases=translations[currLang];__p+="\n";var panels=frases.PANELS;__p+="\n";var channels=defaults.channels;__p+="\n";var positionClass="right"===defaults.position?"position-right":"position-left";__p+='\n<div id="'+__e(defaults.prefix)+'-wg-cont" class="'+__e(defaults.prefix)+"-wg-cont "+__e(positionClass)+'">\n\n	<!-- ***** Panes container ***** -->\n	<div \n		id="'+__e(defaults.prefix)+'-wg-panes" \n		class="'+__e(defaults.prefix)+'-wg-panes" \n		style="',defaults.styles.width&&(__p+="width: "+__e(defaults.styles.width)+";"),__p+='">\n\n		<!-- ***** Top bar ***** -->\n		<div \n			class="'+__e(defaults.prefix)+'-top-bar" \n			style="background: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+';">\n\n			<!-- Main title -->\n			<h4 class="'+__e(defaults.prefix)+"-wg-title "+__e(defaults.prefix)+'-uppercase">\n				'+__e(defaults.title||frases.TOP_BAR.title)+'\n			</h4>\n\n			<div class="'+__e(defaults.prefix)+'-wg-state-cont">\n				<span class="'+__e(defaults.prefix)+'-wg-state-icon"> </span>\n				<span class="'+__e(defaults.prefix)+'-wg-state"></span>\n			</div>\n\n			<!-- Action buttons (minimize, close) -->\n			<div class="'+__e(defaults.prefix)+'-wg-minimize">\n\n				<!--<a \n					href="#" \n					data-'+__e(defaults.prefix)+'-handler="closeWidget">\n					\n					<span style="font-weight: bold">_</span>\n				\n				</a>-->\n				\n				<a \n					href="#" \n					style="color: '+__e(defaults.styles.primary.color)+'"\n					data-'+__e(defaults.prefix)+'-handler="closeWidget"\n					<span class="'+__e(defaults.prefix)+'-icon-remove"></span>\n\n				</a>\n\n			</div>\n		</div>\n		<!-- ***** Top bar ends ***** -->\n\n		<!-- ***** Connection types pane ***** -->\n		<div \n			class="'+__e(defaults.prefix)+'-wg-pane" \n			data-'+__e(defaults.prefix)+'-pane="chooseConnection">\n			\n			<!-- Panel\'s image container -->\n			<div \n				class="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-dark" \n				',defaults.styles.intro.backgroundImage&&(__p+=' \n					style="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.intro.backgroundImage)+')" \n				'),__p+='>\n\n				<!-- The text displayed on image -->\n				<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-white">\n					<br>\n					<p>'+__e(panels.CONNECTION_TYPES.choose_conn_type)+'</p>\n				</div>\n\n			</div>\n			<div class="'+__e(defaults.prefix)+'-pane-body">\n\n				<form \n					id="'+__e(defaults.prefix)+'-init-form" \n					name="'+__e(defaults.prefix)+'InitForm">\n\n					',channels.webrtc&&(__p+=" \n						<!-- Display call button if WebRTC is enabled and supported by the browser -->\n						",defaults.webrtcEnabled?__p+=' \n							<button \n								type="button" \n								class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n								style="\n									background: '+__e(defaults.styles.primary.backgroundColor)+"; \n									color: "+__e(defaults.styles.primary.color)+"; \n									border: 1px solid "+__e(defaults.styles.primary.color)+';"\n								data-'+__e(defaults.prefix)+'-handler="initCall">\n\n								'+__e(panels.CONNECTION_TYPES.call_agent_btn)+"\n\n							</button>\n							<!-- If WebRTC is not supported and fallback is set -->\n						":channels.webrtc.fallback&&channels.webrtc.fallback.sipCall&&(__p+='\n							<button \n								type="button" \n								class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n								style="\n									background: '+__e(defaults.styles.primary.backgroundColor)+"; \n									color: "+__e(defaults.styles.primary.color)+"; \n									border: 1px solid "+__e(defaults.styles.primary.color)+';"\n								data-'+__e(defaults.prefix)+'-handler="initFallbackCall">\n\n								'+__e(panels.CONNECTION_TYPES.call_agent_btn)+"\n\n							</button>\n						"),__p+="\n					"),__p+="\n\n					<!-- Display callback button if callback task is configured in the settings -->\n					",channels.callback&&channels.callback.task&&(__p+='\n						<button \n							type="button" \n							class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n							style="\n								background: '+__e(defaults.styles.primary.backgroundColor)+"; \n								color: "+__e(defaults.styles.primary.color)+"; \n								border: 1px solid "+__e(defaults.styles.primary.color)+';"\n							data-'+__e(defaults.prefix)+'-handler="initCallback">\n\n							'+__e(panels.CONNECTION_TYPES.callback_btn)+"\n\n						</button>\n					"),__p+="\n\n					<!-- Init chat button -->\n					",defaults.chat&&(__p+='\n					<button\n						type="button" \n						class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n						style="background: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+"; border: 1px solid "+__e(defaults.styles.primary.color)+';"\n						data-'+__e(defaults.prefix)+'-handler="initChat">\n						'+__e(panels.CONNECTION_TYPES.chat_agent_btn)+"\n					</button>\n					"),__p+='\n\n					<!-- Close widget button -->\n					<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.CONNECTION_TYPES.cancel)+"</a>\n				</form>\n			</div>\n		</div>\n		<!-- ***** Connection types pane ends ***** -->\n\n		<!-- ***** Intro pane. Displayed if configured in the settings object. ***** -->\n		",defaults.intro.length&&(__p+='\n			<div \n				class="'+__e(defaults.prefix)+'-wg-pane" \n				data-'+__e(defaults.prefix)+'-pane="credentials">\n\n				<!-- Panel\'s image container -->\n				<div \n					class="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-dark" \n					',defaults.styles.intro.backgroundImage&&(__p+=' \n						style="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.intro.backgroundImage)+')" \n					'),__p+='>\n\n					<!-- The text displayed on image -->\n					<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-white">\n						<br>\n						<p>'+__e(panels.INTRO.intro_message)+'</p>\n					</div>\n\n				</div>\n\n				<div class="'+__e(defaults.prefix)+'-pane-body">\n					<form \n						id="'+__e(defaults.prefix)+'-intro-form" \n						name="'+__e(defaults.prefix)+'IntroForm" \n						data-validate-form="true">\n\n						<!-- Iterating over intro array, which is a list of fields and their properties -->\n						',_.forEach(defaults.intro,function(e){__p+="\n							","lang"!==e.name&&(__p+='\n								<input \n									type="'+(null==(__t=e.type||"text")?"":__t)+'" \n									placeholder="'+(null==(__t=e.placeholder||panels.INTRO.PLACEHOLDERS[e.name])?"":__t)+" ",e.required&&(__p+=" * "),__p+='" \n									name="'+__e(e.name)+'" \n									',e.save&&(__p+=' value="'+__e(credentials[e.name])+'" '),__p+=" \n									",e.required&&(__p+=" required "),__p+=">\n							"),__p+="\n\n							","lang"===e.name&&(__p+='\n								<select name="lang">\n									',_.forEach(languages,function(e){__p+='\n										<option \n											value="'+__e(e)+'" \n											',e===currLang&&(__p+=" selected "),__p+=" >\n											"+__e(translations[e].lang)+"\n										</option>\n									"}),__p+="\n								</select>\n							"),__p+="\n\n						"}),__p+='\n\n						<!-- Init chat with intro properties -->\n						<button \n							type="submit" \n							class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n							style="\n								background: '+__e(defaults.styles.primary.backgroundColor)+"; \n								color: "+__e(defaults.styles.primary.color)+"; \n								border: 1px solid "+__e(defaults.styles.primary.color)+';">\n\n							'+__e(panels.INTRO.start_dialog_button)+'\n									\n						</button>\n\n						<!-- Close widget button -->\n						<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.INTRO.cancel)+"</a>\n					</form>\n				</div>\n			</div>\n		"),__p+='\n		<!-- ***** Intro pane ends ***** -->\n\n		<!-- ***** Messages pane ***** -->\n		<div  class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="messages">\n			\n			<!-- Messages container -->\n			<ul \n				id="'+__e(defaults.prefix)+'-messages-cont" \n				class="'+__e(defaults.prefix)+'-messages-cont" \n				style="\n					',defaults.styles.height&&(__p+="\n						height: "+__e(defaults.styles.height)+";\n					"),__p+='">\n					\n			</ul>\n\n			<div class="'+__e(defaults.prefix)+'-write-cont">\n				\n				<!-- End dialog button -->\n				<div class="'+__e(defaults.prefix)+'-end-dialog-btn">\n					<a href="#" data-'+__e(defaults.prefix)+'-handler="finish">'+__e(panels.MESSAGES.end_dialog)+'</a>\n				</div>\n\n				<!-- "Agent is typing" indicator -->\n				<div class="'+__e(defaults.prefix)+'-loader">\n					<span></span>\n					<span></span>\n					<span></span>\n				</div>\n\n				<!-- "Attach file" button -->\n				<label \n					class="'+__e(defaults.prefix)+'-sendfile-cont" \n					for="'+__e(defaults.prefix)+'-file-select">\n\n					<input \n						type="file" \n						id="'+__e(defaults.prefix)+'-file-select">\n					\n					<span \n						class="'+__e(defaults.prefix)+'-icon-upload" \n						style="color: '+__e(defaults.styles.primary.backgroundColor)+'">\n					<span>\n\n				</label>\n\n				<div id="'+__e(defaults.prefix)+'-message-text-clone"  class="'+__e(defaults.prefix)+'-msg-textarea-clone" ></div>\n\n				<!-- Field for typing the user message -->\n				<textarea \n					id="'+__e(defaults.prefix)+'-message-text" \n					class="'+__e(defaults.prefix)+'-msg-textarea" \n					placeholder="'+__e(panels.MESSAGES.PLACEHOLDERS.message)+'" \n					maxlength="1000"></textarea>\n				\n				<!-- "Send a message" button -->\n				<a \n					href="#" \n					class="'+__e(defaults.prefix)+"-sendmsg-btn "+__e(defaults.prefix)+'-button" \n					data-'+__e(defaults.prefix)+'-handler="sendMessage">\n\n					<span \n						class="'+__e(defaults.prefix)+'-icon-paper-plane" \n						style="color: '+__e(defaults.styles.primary.backgroundColor)+'">\n					</span>\n				</a>\n\n			</div>\n		</div>\n		<!-- ***** Messages pane ends ***** -->\n\n		<!-- ***** Offline pane ***** -->\n		<div \n			class="'+__e(defaults.prefix)+'-wg-pane" \n			data-'+__e(defaults.prefix)+'-pane="sendemail">\n\n			<!-- Panel\'s image container -->\n			<div \n				class="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-dark" \n				',
defaults.styles.sendmail.backgroundImage&&(__p+=' \n					style="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.sendmail.backgroundImage)+')" \n				'),__p+='>\n\n				<!-- The text displayed on image -->\n				<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-dark">\n					<p>'+__e(panels.OFFLINE.offline_message)+'</p>\n				</div>\n\n			</div>\n\n			<div class="'+__e(defaults.prefix)+'-pane-body">\n				<h4 class="'+__e(defaults.prefix)+'-uppercase">'+__e(panels.OFFLINE.send_message_header)+'</h4>\n				<form id="'+__e(defaults.prefix)+'-sendmail-form" data-validate-form="true">\n					<input type="text" name="uname" placeholder="'+__e(panels.OFFLINE.PLACEHOLDERS.uname)+'">\n					<input type="email" name="email" placeholder="'+__e(panels.OFFLINE.PLACEHOLDERS.email)+' *" required>\n					<textarea name="text" placeholder="'+__e(panels.OFFLINE.PLACEHOLDERS.message)+'" maxlength="1500"></textarea>\n\n					<input type="file" name="file" id="'+__e(defaults.prefix)+'-contactfile" class="'+__e(defaults.prefix)+'-inputfile" />\n					<label for="'+__e(defaults.prefix)+'-contactfile">'+__e(panels.OFFLINE.choose_file)+'</label>\n\n					<!-- "Send offline message" button -->\n					<button \n						type="submit" \n						class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n						style="\n							background: '+__e(defaults.styles.primary.backgroundColor)+"; \n							color: "+__e(defaults.styles.primary.color)+"; \n							border: 1px solid "+__e(defaults.styles.primary.color)+';">\n\n						'+__e(panels.OFFLINE.send_message_button)+'\n							\n					</button>\n\n					<!-- Close widget button -->\n					<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.OFFLINE.close)+'</a>\n				</form>\n			</div>\n		</div>\n		<!-- ***** Offline pane ends ***** -->\n\n		<!-- ***** Close chat pane ***** -->\n		<div \n			class="'+__e(defaults.prefix)+'-wg-pane" \n			data-'+__e(defaults.prefix)+'-pane="closechat">\n\n			<!-- Panel\'s image container -->\n			<div \n				class="'+__e(defaults.prefix)+"-pane-header "+__e(defaults.prefix)+'-white" \n				',defaults.styles.closeChat.backgroundImage&&(__p+=' \n					style="background-image: url('+__e(defaults.clientPath)+__e(defaults.styles.closeChat.backgroundImage)+')" \n				'),__p+='>\n\n				<!-- The text displayed on image -->\n				<div class="'+__e(defaults.prefix)+"-backdrop-cont "+__e(defaults.prefix)+'-white">\n					<br>\n					<p>'+__e(panels.CLOSE_CHAT.close_chat_header)+'</p>\n				</div>\n\n			</div>\n\n			<div class="'+__e(defaults.prefix)+'-pane-body">\n				<form id="'+__e(defaults.prefix)+'-closechat-form" data-validate-form="true">\n					<label for="'+__e(defaults.prefix)+'-send-dialog">\n						<input type="checkbox" name="sendDialog" id="'+__e(defaults.prefix)+'-send-dialog" />\n						<span>'+__e(panels.CLOSE_CHAT.send_dialog_label)+'</span>\n					</label>\n					<input type="email" name="email" placeholder="'+__e(panels.CLOSE_CHAT.PLACEHOLDERS.email)+'">\n					<select name="rating">\n						<option value="">--- '+__e(panels.CLOSE_CHAT.rate_agent)+' ---</option>\n						<option value="5">'+__e(frases.AGENT_RATES.excellent)+'</option>\n						<option value="4">'+__e(frases.AGENT_RATES.good)+'</option>\n						<option value="3">'+__e(frases.AGENT_RATES.fair)+'</option>\n						<option value="2">'+__e(frases.AGENT_RATES.bad)+'</option>\n					</select>\n					<textarea placeholder="'+__e(panels.CLOSE_CHAT.PLACEHOLDERS.comment)+'" name="text" maxlength="1500"></textarea>\n\n					<!-- End chat and close widget button -->\n					<button \n						type="submit" \n						class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block" \n						style="\n							background: '+__e(defaults.styles.primary.backgroundColor)+"; \n							color: "+__e(defaults.styles.primary.color)+"; \n							border: 1px solid "+__e(defaults.styles.primary.color)+';">\n\n						'+__e(panels.CLOSE_CHAT.finish_dialog_button)+'\n							\n					</button>\n\n					<!-- "Back to the chat" button -->\n					<a href="#messages" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CLOSE_CHAT.back)+'</a>\n				</form>\n			</div>\n		</div>\n		<!-- ***** Close chat pane ends ***** -->\n\n		<!-- ***** Audio call pane ***** -->\n		<div class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="callAgent">\n			<div class="'+__e(defaults.prefix)+'-pane-body">\n				<div id="'+__e(defaults.prefix)+'-call-spinner" class="'+__e(defaults.prefix)+'-spinner-pane">\n					<h3 class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.AUDIO_CALL.confirm_access)+'</h3>\n					<h3 class="'+__e(defaults.prefix)+"-text-center "+__e(defaults.prefix)+"-loader "+__e(defaults.prefix)+'-shown" style="position: relative;">\n						<span></span>\n						<span></span>\n						<span></span>\n					</h3>\n				</div>\n				<div id="'+__e(defaults.prefix)+'-call-info" class="'+__e(defaults.prefix)+'-hidden">\n					<h3 class="'+__e(defaults.prefix)+'-text-center" id="'+__e(defaults.prefix)+'-call-state">'+__e(panels.AUDIO_CALL.calling_agent)+'</h3>\n					<h3 class="'+__e(defaults.prefix)+'-text-center" id="'+__e(defaults.prefix)+'-call-timer">00:00</h3>\n				</div>\n				<form id="'+__e(defaults.prefix)+'-call-control">\n					<hr>\n					<button\n						id="'+__e(defaults.prefix)+'-tryagain-btn"\n						type="button"\n						class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+"-block "+__e(defaults.prefix)+'-hidden"\n						style="background: '+__e(defaults.styles.primary.backgroundColor)+"; color: "+__e(defaults.styles.primary.color)+"; border: 1px solid "+__e(defaults.styles.primary.color)+';"\n						data-'+__e(defaults.prefix)+'-handler="initCall">\n						'+__e(panels.AUDIO_CALL.try_again)+'\n					</button>	\n					<button \n						type="button"\n						class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-warn "+__e(defaults.prefix)+'-block"\n						data-'+__e(defaults.prefix)+'-handler="endCall">\n\n						'+__e(panels.AUDIO_CALL.end_call)+'\n\n					</button>\n				</form>\n			</div>\n		</div>\n		<!-- ***** Audio call pane ends ***** -->\n\n		<!-- ***** Audio call fallback pane ***** -->\n		<div class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="callAgentFallback">\n			<div class="'+__e(defaults.prefix)+'-pane-body">\n				<div class="'+__e(defaults.prefix)+'-text-center">\n					<h3>'+__e(panels.AUDIO_CALL_FALLBACK.DOWNLOAD_MSG)+"</h3>\n					<br>\n					",defaults.webrtc&&defaults.webrtc.fallback&&(__p+='\n						<a href="'+__e(defaults.webrtc.fallback.sipCall)+'">call.jnlp</a>\n					'),__p+='\n				</div>\n				<form>\n					<hr>\n					<a href="#chooseConnection" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CALLBACK.back)+'</a>\n				</form>\n			</div>\n		</div>\n		<!-- ***** Audio call fallback pane ends ***** -->\n\n		<!-- ***** Callback pane ***** -->\n		<div \n			class="'+__e(defaults.prefix)+'-wg-pane" \n			data-'+__e(defaults.prefix)+'-pane="callback">\n\n			<div class="'+__e(defaults.prefix)+'-pane-body">\n				<div id="'+__e(defaults.prefix)+'-callback-spinner" class="'+__e(defaults.prefix)+"-hidden "+__e(defaults.prefix)+'-spinner-pane">\n					<h3 class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.sending_request)+'</h3>\n					<h3 class="'+__e(defaults.prefix)+"-text-center "+__e(defaults.prefix)+"-loader "+__e(defaults.prefix)+'-shown" style="position: relative;">\n						<span></span>\n						<span></span>\n						<span></span>\n					</h3>\n				</div>\n				<form id="'+__e(defaults.prefix)+'-callback-settings">\n					<p class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.title)+"</p>\n					<hr>\n					<label>"+__e(panels.CALLBACK.LABELS.phone)+'</label>\n					<input type="tel" name="phone" placeholder="'+__e(panels.CALLBACK.PLACEHOLDERS.phone)+'" required>\n					<label>'+__e(panels.CALLBACK.LABELS.time)+'</label>\n					<select name="time">\n						',_.forEach(panels.CALLBACK.TIME_POINTS,function(e){__p+='\n							<option value="'+__e(e.minutes)+'">'+__e(e.label)+"</option>\n						"}),__p+='\n					</select>\n					<hr>\n\n					<button\n						type="submit"\n						class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+"-button-primary "+__e(defaults.prefix)+'-block"\n						style="\n							background: '+__e(defaults.styles.primary.backgroundColor)+"; \n							color: "+__e(defaults.styles.primary.color)+"; \n							border: 1px solid "+__e(defaults.styles.primary.color)+';"\n						data-'+__e(defaults.prefix)+'-handler="setCallback">\n\n						'+__e(panels.CALLBACK.confirm_callback)+'\n\n					</button>\n\n					<a href="#chooseConnection" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CALLBACK.back)+'</a>\n				</form>\n			</div>\n		</div>\n		<!-- ***** Callback pane ends ***** -->\n\n		<!-- ***** Callback sent pane ***** -->\n		<div class="'+__e(defaults.prefix)+'-wg-pane" data-'+__e(defaults.prefix)+'-pane="callbackSent">\n			<div class="'+__e(defaults.prefix)+'-pane-body">\n				<div id="'+__e(defaults.prefix)+'-callback-sent">\n					<h3 class="'+__e(defaults.prefix)+"-text-center "+__e(defaults.prefix)+"-icon-check "+__e(defaults.prefix)+'-text-success"></h3>\n					<p class="'+__e(defaults.prefix)+'-text-center">'+__e(panels.CALLBACK.request_sent)+'</p>\n					<form>\n						<hr>\n						<a href="#chooseConnection" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block">'+__e(panels.CALLBACK.back)+'</a>\n						<a href="#" class="'+__e(defaults.prefix)+"-button "+__e(defaults.prefix)+'-block" data-'+__e(defaults.prefix)+'-handler="closeWidget">'+__e(panels.CALLBACK.close)+'</a>\n					</form>\n				</div>\n			</div>\n		</div>\n		<!-- ***** Callback sent pane ends ***** -->\n\n	</div>\n	<!-- ***** Panes container ends ***** -->\n\n	<!-- ***** Floating button container ***** -->\n	<div id="'+__e(defaults.prefix)+'-btn-cont" class="'+__e(defaults.prefix)+'-btn-cont">\n		<div class="'+__e(defaults.prefix)+'-wg-btn">\n			<div class="'+__e(defaults.prefix)+'-lastmsg-cont">\n				<span class="'+__e(defaults.prefix)+'-unnotify-btn" id="'+__e(defaults.prefix)+'-unnotify-btn">'+__e(frases.FLOATING_BUTTON.close)+'</span>\n				<div id="'+__e(defaults.prefix)+'-lastmsg" class="'+__e(defaults.prefix)+'-lastmsg">\n				</div>	\n			</div>\n			<a href="#" class="'+__e(defaults.prefix)+'-btn-link">\n				<span class="'+__e(defaults.prefix)+'-btn-icon"></span>\n			</a>\n		</div>\n	</div>\n	<!-- ***** Floating button container ends ***** -->\n\n</div>'}return __p}},{}],83:[function(e,t,n){(function(n){function a(){var e=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia,n=window.mozRTCIceCandidate||window.RTCIceCandidate;return!!e&&!!t&&!!n}function r(){g.on("connected",function(e){v.log("sip connected event: ",e)}),g.on("disconnected",function(e){v.log("sip disconnected event: ",e)}),g.on("newMessage",function(e){v.log("sip newMessage event: ",e)}),g.on("newRTCSession",function(e){v.log("sip newRTCSession event: ",e),y.emit("webrtc/newRTCSession",e),h=e.session}),g.on("registered",function(e){v.log("sip registered event: ",e)}),g.on("unregistered",function(e){v.log("sip unregistered event: ",e)}),g.on("registrationFailed",function(e){v.log("sip registrationFailed event: ",e)}),b={progress:function(e){v.log("call progress event: ",e),y.emit("webrtc/progress",e)},failed:function(e){v.log("call failed event:",e),y.emit("webrtc/failed",e)},ended:function(e){v.log("call ended event: ",e),y.emit("webrtc/ended",e)},confirmed:function(e){v.log("call confirmed event: ",e),y.emit("webrtc/confirmed",e)},addstream:function(e){v.log("call addstream event: ",e),y.emit("webrtc/addstream",e);var t=e.stream;_.audioRemote=x.rtcninja.attachMediaStream(_.audioRemote,t)}}}function s(){return h.isEstablished()}function i(){return h.isInProgress()}function o(){return h.isEnded()}function l(){g.stop()}function c(e){h=g.call(e,{eventHandlers:b,mediaConstraints:{audio:!0,video:!1}})}function u(){h.terminate({status_code:200})}function d(){v.log("answer: ",g),h.answer()}function f(){v.log("hold: ",h.isOnHold()),h&&h.isOnHold().local?h.unhold():h.hold()}function p(){var e=document.createElement("audio");return e.setAttribute("autoplay","autoplay"),document.body.appendChild(e),e}function m(e){v.log("Initiating WebRTC module:",e),_=e,void 0===_.sip.register&&(_.sip.register=!1),y.emit=e.emit,y.on=e.on,_.audioRemote=p(),g=new x.UA(_.sip),r(),g.start()}var _,g,h,b,v=e("./debug"),y={},x=n.JsSIP;t.exports={lib:x,init:m,unregister:l,audiocall:c,terminate:u,answer:d,hold:f,isInProgress:i,isEstablished:s,isEnded:o,isSupported:a}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./debug":77}],84:[function(e,t,n){(function(n){function a(e){return lt.initiated?mt:(et.merge(it,e||{}),Ze.log("Widget: ",e),it.clientPath=e.clientPath?e.clientPath:it.clientPath||it.server+it.path,Fe(),it.buttonSelector&&Q(it.buttonSelector),st.init(it.clientPath+"sounds/"),We=new Xe(e).on("session/create",o).on("session/continue",o).on("session/join",c).on("session/disjoin",u).on("session/init",l),it.widget&&We.on("chat/start",k).on("chat/close",M).on("chat/timeout",F).on("message/new",C).on("message/new",S).on("message/typing",P).on("callback/create",H).on("form/submit",we).on("form/reject",ke).on("widget/load",_),rt.isSupported()&&it.channels.webrtc&&it.channels.webrtc.sip&&void 0!==it.channels.webrtc.sip.ws_servers&&("https:"===window.location.protocol?(it.webrtcEnabled=!0,We.on("webrtc/newRTCSession",function(){z("newRTCSession")}),We.on("webrtc/progress",function(e){z(180===e.response.status_code?"ringing":"confirmed")}),We.on("webrtc/addstream",function(){z("connected")}),We.on("webrtc/ended",function(){z("ended")}),We.on("webrtc/failed",function(e){z("Canceled"===e.cause?"canceled":"failed")}),s({sip:it.channels.webrtc.sip,emit:mt.emit,on:mt.on})):(Ze.warn("WebRTC feature is disabled"),Ze.warn("getUserMedia() no longer works on insecure origins. To use this feature, you should consider switching your application to a secure origin, such as HTTPS. See https://goo.gl/rStTGz for more details."))),D(),Qe.get("frases",(it.translationsPath||it.clientPath)+"translations.json",function(e,t){return e?We.emit("Error",e):void(tt=JSON.parse(t))}),Qe.get("forms_json",it.clientPath+"forms.json",function(e,t){return e?We.emit("Error",e):void(qe=JSON.parse(t).forms)}),mt)}function r(){return We.init(),mt}function s(e){Ze.log("initWebrtcModule: ",e),rt.init(e)}function i(){return it.chat||it.webrtcEnabled||it.channels.callback.task?(Ze.log("session initiated"),dt=dt||Le(),D(),p(),it.widget&&!lt.initiated&&Be()&&g(),be("timeout")&&ve("timeout"),void We.emit("session/init",{options:it,url:n.location.href})):!1}function o(){et.poll(function(){return Ze.log("poll: ",tt),null!==tt},function(){i(),it.external||We.updateUrl(window.location.href)},function(){return 2>pt?(pt++,void a(it)):We.emit("Error","Module wasn't initiated due to network errors")},6e4)}function l(){Ve.saveState("init",!0,"session"),Ke&&!Ke.closed&&Ke.sessionStorage.setItem(it.prefix+".init",!0)}function c(e){d({url:e.url,entity:Ve.getState("entity","session")})}function u(){nt.unshare()}function d(e){it.external||nt.isInitiated()||(We.on("cobrowsing/init",function(){nt.share()}),We.on("cobrowsing/update",function(e){nt.updateEvents(e)}),We.on("cobrowsing/event",function(e){e.events&&e.events.length&&We.updateEvents(e.events)}),We.on("cobrowsing/shared",function(){Ve.saveState("shared",!0,"session")}),We.on("cobrowsing/unshared",function(e){Ve.saveState("shared",!1,"session")}),nt.init({widget:e.widget,entity:e.entity,emit:mt.emit,path:it.clientPath}))}function f(){return ze}function p(){We.getLanguages(function(e,t){Ze.log("getLanguages: ",e,t),e||t&&m(t)})}function m(e){var t=e.length?"online":"offline";ut=e,pe({state:t}),We.emit("chat/languages",e)}function _(){var e,t="";lt.initiated=!0,_e(),V(ze),pe({state:me()}),it.hideOfflineButton&&he("no-button"),it.offer&&h(),Ve.getState("chat")===!0&&(w(Ve.getState("credentials","session")||{}),Ve.getState("opened","session")&&ye()),it.webrtcEnabled&&he("webrtc-enabled"),ze&&it.intro.length&&(ut.forEach(function(n){tt[n]&&tt[n].lang&&(e=n===dt?"selected":"",t+='<option value="'+n+'" '+e+" >"+tt[n].lang+"</option>")}),n[it.prefix+"IntroForm"].lang.innerHTML=t),We.emit("widget/init")}function g(e){compiled=Se("widget",{defaults:it,languages:ut,translations:tt,currLang:dt||it.lang,credentials:Ve.getState("credentials","session")||{},_:et}),ze=$e(compiled),document.body.appendChild(ze),We.emit("widget/load",ze)}function h(){setTimeout(function(){b({from:it.offer.from||tt[dt].TOP_BAR.title,time:Date.now(),content:it.offer.text||tt[dt].default_offer})},it.offer.inSeconds?1e3*it.offer.inSeconds:3e4)}function b(e){"online"!==lt.state||y()||S(e)}function v(){Ve.getState("interacted","session")||Ve.saveState("interacted",!0,"session")}function y(){return Ve.getState("interacted","session")}function x(){ye(),Ve.getState("chat","cache")||(ut.length?it.intro.length?Ve.getState("chat")?w(Ve.getState("credentials","session")):fe("credentials"):w({lang:dt}):fe("sendemail"))}function w(e){e.uname||(e.uname=Ve.getState("sid").split("_")[0]),e.lang&&e.lang!==dt&&Ve.saveState("lang",e.lang),e.lang||(e.lang=dt),Ve.saveState("credentials",e,"session"),k({}),Ce(),fe("messages"),We.chatRequest(e)}function k(e){Ve.saveState("chat",!0),e.timeout&&(He=We.setChatTimeout(e.timeout)),he("chat")}function E(e){We.sendMessage(e),S({from:Ve.getState("credentials","session").uname,time:Date.now(),content:e.message}),He&&clearTimeout(He)}function S(e){var t,a,r=!1,s=Ve.getState("credentials","session")||{},i=Ve.getState("aname","session"),o=s.uname?s.uname:"";if(messagesCont=document.getElementById(it.prefix+"-messages-cont"),e.entity=e.from===o?"user":"agent",e.from="user"===e.entity?"":e.from,e.time=Oe(e.time?e.time:Date.now()),t=je(e.content,e.file,e.entity),"form"===t.type)a=Se("forms",{defaults:it,message:e,form:t.content,credentials:s,frases:tt[dt||it.lang],_:et}),n[t.content.name]&&ke({formName:t.content.name}),messagesCont.insertAdjacentHTML("beforeend","<li>"+a+"</li>"),messagesCont.scrollTop=messagesCont.scrollHeight;else{if(!e.content)return;e.content=t.content,a=Se("message",{defaults:it,message:e}),messagesCont.insertAdjacentHTML("beforeend","<li "+(e.className?'class="'+e.className+'"':"")+">"+a+"</li>"),L(a),e.hidden||ct.push(a)}"agent"===e.entity&&i!==e.from&&Ve.saveState("aname",e.from,"session"),"user"!==e.entity&&(r=!0),messagesCont.scrollTop=messagesCont.scrollHeight}function C(){var e=[].slice.call(document.querySelectorAll("."+it.prefix+"-msg-undelivered"));e&&e.length&&e.forEach(function(e){e.classList.add(it.prefix+"-hidden")})}function L(e){var t;lt.active||(t=document.getElementById(it.prefix+"-lastmsg"),t.innerHTML=e,he("notified"),ge("notified"))}function A(e,t){var n=Se("email",{defaults:it,content:e,frases:tt[dt||it.lang],_:et});return t?t(null,n):void 0}function O(e){var t=e.text.join("");A(t,function(t,n){t||(e.text=n,We.sendEmail(e))})}function j(e){var t=[],n=Se("message",{defaults:it,message:{from:tt[dt].EMAIL_SUBJECTS.complain+" "+e.email,content:e.text,entity:"",time:""}});t=t.concat(n,'<br><p class="h1">'+tt[dt].EMAIL_SUBJECTS.dialog+" "+it.host+"</p><br>",ct).reduce(function(e,t){return e.concat(t)}),A(t,function(t,n){t||(e.text=n,We.sendEmail(e))})}function T(e,t){var n=Se("message",{defaults:it,message:{from:tt[dt].EMAIL_SUBJECTS.request+" "+e.uname+" ("+e.email+")",content:e.text,entity:"",time:""}});A(n,function(n,a){n||(e.text=a,We.sendEmail(e),t&&t())})}function I(e,t){var n;return t.email?(t.subject=tt[dt].EMAIL_SUBJECTS.request+" "+t.email,void(t.file?n=Ee(e.file,function(n,a){n?Ze.warn("File wasn't sent"):(t.filename=a.filename,t.filedata=a.filedata),delete t.file,T(t,function(){e.reset(),xe()})}):T(t,function(){e.reset(),xe()}))):void alert(tt[dt].ERRORS.email)}function N(e,t){var n=t&&t.rating?parseInt(t.rating,10):null;if(t&&t.sendDialog){if(!t.email)return void alert(tt[dt].ERRORS.email);O({to:t.email,subject:tt[dt].EMAIL_SUBJECTS.dialog+" "+it.host,text:ct})}if(t&&t.text){if(!t.email)return void alert(tt[dt].ERRORS.email);j({email:t.email,subject:tt[dt].EMAIL_SUBJECTS.complain+" "+t.email,text:t.text})}He&&clearTimeout(He),e&&e.reset(),R(n),xe()}function R(e){Ve.saveState("chat",!1),We.closeChat(e),ve("chat"),Ve.getState("shared","session")&&(We.switchShareState("shareClosed",n.location.href),nt.unshare())}function M(){Ve.getState("shared","session")&&nt.unshare()}function F(){fe("closechat"),R()}function P(){Je||he("agent-typing"),clearTimeout(Je),Je=setTimeout(function(){Je=null,ve("agent-typing")},5e3)}function D(){We.listenerCount("session/timeout")>=1||We.once("session/timeout",function(){Ze.log("Session timeout:",it),Ve.getState("chat")===!0&&R(),ze&&(he("timeout"),xe()),pe({state:"timeout"}),ge("timeout"),getLanguagesInterval&&clearInterval(getLanguagesInterval),messagesTimeout&&clearTimeout(messagesTimeout),it.reCreateSession&&r()})}function B(){fe("callAgent"),rt.audiocall(it.channels.webrtc.hotline)}function U(){fe("callAgentFallback")}function q(){fe("callback")}function W(){var e=document.getElementById(it.prefix+"-callback-settings"),t=Re(e),n=document.getElementById(it.prefix+"-callback-spinner");document.getElementById(it.prefix+"-callback-sent");return t.phone=t.phone?De(t.phone):null,!t.phone||t.phone.length<10?alert(tt[dt].ERRORS.tel):(t.time=parseFloat(t.time),void(t.time<=0||(t.time=Date.now()+60*t.time*1e3,t.task=it.channels.callback.task,Ze.log("setCallback data: ",t),e.classList.add(it.prefix+"-hidden"),n.classList.remove(it.prefix+"-hidden"),We.requestCallback(t),fe("callbackSent"),e.reset())))}function H(){var e=document.getElementById(it.prefix+"-callback-settings"),t=document.getElementById(it.prefix+"-callback-spinner");t.classList.add(it.prefix+"-hidden"),e.classList.remove(it.prefix+"-hidden"),err||fe("callbackSent")}function z(e){Ze.log("initCallState: ",e);var t=document.getElementById(it.prefix+"-call-spinner"),n=document.getElementById(it.prefix+"-call-info"),a=document.getElementById(it.prefix+"-call-state"),r=document.getElementById(it.prefix+"-call-timer"),s=document.getElementById(it.prefix+"-tryagain-btn");"newRTCSession"===e?z("oncall"):"confirmed"===e?(a.innerText=tt[dt].PANELS.AUDIO_CALL.calling_agent,n.classList.remove(it.prefix+"-hidden"),t.classList.add(it.prefix+"-hidden"),s.classList.add(it.prefix+"-hidden")):"ringing"===e?(K(r,"init",0),r.classList.remove(it.prefix+"-hidden"),st.play("ringout_loop",!0)):"connected"===e?(a.innerText=tt[dt].PANELS.AUDIO_CALL.connected_with_agent,K(r,"start",0),st.stop()):"ended"===e?(a.innerText=tt[dt].PANELS.AUDIO_CALL.call_ended,K(r,"stop"),z("oncallend")):"failed"===e||"canceled"===e?("failed"===e?a.innerText=tt[dt].PANELS.AUDIO_CALL.call_failed:a.innerText=tt[dt].PANELS.AUDIO_CALL.call_canceled,n.classList.remove(it.prefix+"-hidden"),t.classList.add(it.prefix+"-hidden"),r.classList.add(it.prefix+"-hidden"),s.classList.remove(it.prefix+"-hidden"),z("oncallend"),st.play("busy")):"oncall"===e?(window.onbeforeunload=function(){return"Your connection is in progress. Do you realy want to close it?"},Ve.saveState("call",!0,"cache"),he("webrtc-call")):"oncallend"===e?(window.onbeforeunload=null,Ve.saveState("call",!1,"cache"),ve("webrtc-call")):(n.classList.add(it.prefix+"-hidden"),t.classList.remove(it.prefix+"-hidden"),s.classList.add(it.prefix+"-hidden"))}function K(e,t,n){var a=n;"start"===t?Ye=setInterval(function(){a+=1,e.textContent=Pe(a)},1e3):"stop"===t?clearInterval(Ye):"init"===t&&(e.textContent=Pe(0))}function J(){rt.isEstablished()||rt.isInProgress()?rt.terminate():(xe(),z("init"))}function G(){var e={};Ke&&!Ke.closed||(et.merge(e,it),e.widget=!0,e.external=!0,Ke=window.open("","wchat",it.widgetWindowOptions),Ke=Y(Ke),et.poll(function(){return void 0!==Ke.Wchat},function(){Ke.Module=Ke.Wchat(e),Ke.Module.on("widget/init",function(){Ke.Module.initWidgetState()}),et.forEach(We._events,function(e,t,a){Ke.Module.on(t,function(e){e.url=n.location.href,We.emit("window/"+t,e)})})},function(){console.warn("Wchat module was not initiated due to network connection issues.")},12e4),Ke.onbeforeunload=function(){Ve.getState("chat","storage")&&R()}),Ke.focus&&Ke.focus()}function Y(e){var t,n,a,r,s=s||Le(),i=e.document.createElement("div"),o=$(e,"swc-loader-styles"),l=e.document.getElementsByTagName("head")[0],c=e.document.getElementsByTagName("body")[0];return i.className="swc-widget-loader",i.innerHTML="<span></span><span></span><span></span>",a=e.document.createElement("meta"),a.name="viewport",a.content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0",n=e.document.createElement("meta"),n.setAttribute("charset","utf-8"),r=e.document.createElement("title"),r.textContent=tt[s].TOP_BAR.title,t=e.document.createElement("script"),t.src=it.clientPath+"wchat.min.js",t.charset="UTF-8",l.appendChild(a),l.appendChild(n),l.appendChild(r),l.appendChild(o),l.appendChild(t),c.id="swc-wg-window",c.appendChild(i),X(l.getElementsByTagName("style")[0]),e}function $(e,t){var n=e.document.createElement("style");return n.type="text/css",t&&(n.id=t),n.appendChild(e.document.createTextNode("")),n}function X(e){var t=["body { margin:0; background-color: #eee; }","@keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-webkit-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-moz-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-ms-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}","@-o-keyframes preloading {","0 { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","50% { transform: translate(0,15px); -webkit-transform: translate(0,15px); -moz-transform: translate(0,15px); -ms-transform: translate(0,15px); -o-transform: translate(0,15px); }","100% { transform: translate(0,0); -webkit-transform: translate(0,0); -moz-transform: translate(0,0); -ms-transform: translate(0,0); -o-transform: translate(0,0); }","}",".swc-widget-loader {","position: absolute;","width: 100%;","top: 50%;","margin-top: -18px;","text-align: center;","}",".swc-widget-loader span {","display: inline-block;","width: 18px;","height: 18px;","border-radius: 50%;","background-color: #fff;","margin: 3px;","}",".swc-widget-loader span:nth-last-child(1) { -webkit-animation: preloading .8s .1s linear infinite; -moz-animation: preloading .8s .1s linear infinite; -ms-animation: preloading .8s .1s linear infinite; -o-animation: preloading .8s .1s linear infinite; animation: preloading .8s .1s linear infinite; }",".swc-widget-loader span:nth-last-child(2) { -webkit-animation: preloading .8s .3s linear infinite; -moz-animation: preloading .8s .3s linear infinite; -ms-animation: preloading .8s .3s linear infinite; -o-animation: preloading .8s .3s linear infinite; animation: preloading .8s .3s linear infinite; }",".swc-widget-loader span:nth-last-child(3) { -webkit-animation: preloading .8s .5s linear infinite; -moz-animation: preloading .8s .5s linear infinite; -ms-animation: preloading .8s .5s linear infinite; -o-animation: preloading .8s .5s linear infinite; animation: preloading .8s .5s linear infinite; }"].join(" ");e.innerHTML=t}function V(e){var t=document.getElementById(it.prefix+"-file-select"),a=document.getElementById(it.prefix+"-message-text"),r=[].slice.call(e.querySelectorAll("."+it.prefix+"-inputfile")),s=document.getElementById(it.prefix+"-btn-cont");[].slice.call(e.querySelectorAll("."+it.prefix+"-wg-pane")),document.getElementById(it.prefix+"-messages-cont");r.forEach(function(e){var t=e.nextElementSibling,n=t.textContent;Ue(e,"change",function(e){var a=e.target.value.split("\\").pop();a?t.textContent=a:t.textContent=n})}),Ue(s,"click",ne),Ue(e,"click",te),Ue(e,"submit",ue),Ue(t,"change",de),Ue(a,"keypress",oe),Ue(a,"focus",le),Ue(a,"blur",ce),Ue(n,"DOMMouseScroll",ae),Ue(n,"wheel",ae),Ue(e,"mouseenter",Z),Ue(e,"mouseleave",ee)}function Q(e){var t=it.widget?se:G,n=[].slice.call(document.querySelectorAll(e));n.map(function(e){return Ue(e,"click",t),e})}function Z(){ft=!0}function ee(){ft=!1}function te(e){var t,n,a,r,s=e.target;"A"!==s.parentNode.tagName&&"BUTTON"!==s.parentNode.tagName||(s=s.parentNode),t=s.getAttribute("data-"+it.prefix+"-handler"),r=s.getAttribute("data-"+it.prefix+"-link"),"closeWidget"===t?xe():"finish"===t?Ve.getState("chat")?fe("closechat"):xe():"sendMessage"===t?ie():"openWindow"===t?G():"rejectForm"===t?We.emit("form/reject",{formName:et.findParent(s,"form").name}):"initCall"===t?B():"initFallbackCall"===t?U():"initCallback"===t?q():"setCallback"===t?W():"initChat"===t?x():"endCall"===t&&J(),"A"===s.tagName&&(a=s.href,r?We.linkFollowed(r):-1!==a.indexOf("#")&&(e.preventDefault(),n=a.substring(s.href.indexOf("#")+1),n&&fe(n)))}function ne(e){e.preventDefault();var t=e.target,n=e.currentTarget;return t.id===it.prefix+"-unnotify-btn"?(ve("notified"),void ge(lt.state)):void(n.id===it.prefix+"-btn-cont"&&se())}function ae(e){var t=document.getElementById(it.prefix+"-messages-cont"),n=re(e);ft&&(0===t.scrollTop&&"up"===n?(e.stopPropagation(),e.preventDefault()):t.scrollTop>=t.scrollHeight-t.clientHeight&&"down"===n&&(e.stopPropagation(),e.preventDefault()))}function re(e){var t;return t=e.wheelDelta?e.wheelDelta:-1*e.deltaY,0>t?"down":t>0?"up":void 0}function se(){var e=Ve.getState("chat","cache"),t=(Ve.getState("opened","session"),Ve.getState("call","cache"));v(),be("timeout")?r():e?ye():ut.length?it.webrtcEnabled?t?ye():it.chat||it.channels.callback.task?(fe("chooseConnection"),ye()):B():it.channels.callback.task?it.chat||it.webrtcEnabled?(fe("chooseConnection"),
ye()):(fe("callback"),ye()):x():(fe("sendemail"),ye())}function ie(){var e,t=document.getElementById(it.prefix+"-message-text");e=et.trim(t.value),e&&(E({message:e}),t.value="",ve("type-extend")),Ve.getState("chat")||x()}function oe(e){var t=e.target,n=document.getElementById("swc-message-text-clone");10===e.keyCode||13===e.keyCode?(e.preventDefault(),ie()):Ge||(Ge=setTimeout(function(){Ge=null,We.userIsTyping()},1e3)),n.innerText=t.value,t.style.height=n.clientHeight+"px"}function le(e){var t=e.target;t.style.borderColor=it.styles.primary.backgroundColor}function ce(e){var t=e.target;t.style.borderColor="#fff"}function ue(e){var t=e.target;e.preventDefault(),"FORM"===t.tagName&&We.emit("form/submit",{formElement:t,formData:Re(t)})}function de(e){var t=e.target;Ee(t,function(e,t){Ze.log("wgSendFile: ",t),e?alert("File was not sent"):E({message:t.filename,file:t.filedata})})}function fe(e){var t="data-"+it.prefix+"-pane",n=[].slice.call(ze.querySelectorAll("."+it.prefix+"-wg-pane"));n.forEach(function(n){n.getAttribute(t)===e?n.classList.add("active"):n.classList.remove("active")})}function pe(e){if(ze&&lt.state!==e.state){"offline"===e.state?ve("online"):"online"===e.state&&ve("offline");var t=document.querySelector("."+it.prefix+"-wg-state");t&&(t.textContent=tt[dt].TOP_BAR.STATUS[e.state]),lt.state=e.state,he(e.state),ge(e.state),We.emit("widget/statechange",{state:e.state})}}function me(){return lt.state?lt.state:ut&&ut.length?"online":"offline"}function _e(){var e=ze.querySelector("."+it.prefix+"-wg-btn");console.log("setStyles: ",e,it.buttonStyles),e.style.borderRadius=it.buttonStyles.borderRadius,e.style.boxShadow=it.buttonStyles.boxShadow}function ge(e){if(ze&&void 0!==it.buttonStyles[e]){var t=ze.querySelector("."+it.prefix+"-wg-btn"),n=ze.querySelector("."+it.prefix+"-btn-icon");t.style.background=it.buttonStyles[e].backgroundColor,n.style.color=it.buttonStyles[e].color||it.buttonStyles.color}}function he(e){ze&&ze.classList.add(e)}function be(e){return ze?ze.classList.contains(e):!1}function ve(e){ze&&ze.classList.remove(e)}function ye(){var e=document.getElementById(it.prefix+"-messages-cont");lt.active=!0,Ve.saveState("opened",!0,"session"),he("active"),ve("notified"),ge(lt.state),e.scrollTop=e.scrollHeight}function xe(){window.opener?window.close():(lt.active=!1,Ve.saveState("opened",!1,"session"),ve("active"))}function we(e){var t=e.formElement,n=e.formData;if(t.getAttribute("data-validate-form")){var a=Me(t);if(!a)return}t.id===it.prefix+"-closechat-form"?N(t,n):t.id===it.prefix+"-sendmail-form"?I(t,n):t.id===it.prefix+"-intro-form"?w(n):t.id===it.prefix+"-call-btn-form"?B():t.id===it.prefix+"-chat-btn-form"?x():ke({formName:t.name},!0)}function ke(e,t){var a=n[e.formName];return a?void(t?a.outerHTML='<p class="'+it.prefix+'-text-center"><i class="'+it.prefix+"-text-success "+it.prefix+'-icon-check"></i><span> '+tt[dt].FORMS.submitted+"</span></p>":a.outerHTML='<p class="'+it.prefix+'-text-center"><i class="'+it.prefix+"-text-danger "+it.prefix+'-icon-remove"></i><span> '+tt[dt].FORMS.canceled+"</span></p>"):!1}function Ee(e,t){var a,r,s,i=e.files;if(i.length){if(!n.FileReader)return void(t&&t("OBSOLETE_BROWSER"));a=i[0],s=new FileReader,s.onload=function(e){r=e.target.result,r=r.substring(r.indexOf(",")+1),t&&t(null,{filedata:r,filename:a.name})},s.onerror=function(e){We.emit("Error",e.target.error),t&&t(e.target.error)},s.readAsDataURL(a)}}function Se(e,t){var n=at[e];return n(t)}function Ce(){var e=document.getElementById(it.prefix+"-messages-cont"),t=e.cloneNode();e.parentNode.replaceChild(t,e)}function Le(){var e,t=Ve.getState("lang"),a=[];if(t)e=t;else{for(var r in tt)a.push(r);it.langFromUrl&&n.location.pathname.split("/").map(function(t){return t=Ae(t),-1!==a.indexOf(t)&&(e=t),t}),e||(e=it.lang||(navigator.language||navigator.userLanguage).split("-")[0],-1===a.indexOf(e)&&(e="en"))}return Ze.log("detected lang: ",e),e}function Ae(e){var t=e;return"ua"===e&&(t="uk"),"us"!==e&&"gb"!==e||(t="en"),t}function Oe(e){var t=new Date(e),n=t.getHours(),a=t.getMinutes(),r=(10>n?"0"+n:n)+":"+(10>a?"0"+a:a);return r}function je(e,t,n){var a,r;return t?(a=e.substring(e.indexOf("_")+1),Ne(t)?{type:"image",content:'<a href="'+We.options.server+"/ipcc/"+e+'" download="'+a+'"><img src="'+We.options.server+"/ipcc/"+e+'" alt="file preview" /></a>'}:{type:"file",content:'<a href="'+We.options.server+"/ipcc/"+e+'" download="'+a+'">'+a+"</a>"}):"agent"===n&&Ie(e)&&Ne(e)?(a=e.substring(e.indexOf("_")+1),{type:"image",content:'<a href="'+e+'" target="_blank"><img src="'+e+'" alt="'+a+'" /></a>'}):"agent"===n&&new RegExp("^{.+}$").test(e)?(qe.forEach(function(t){t.name===e.substring(1,e.length-1)&&(r=t)}),{type:r?"form":"text",content:r?r:e}):{type:"text",content:e.replace(/\n/g," <br> ").split(" ").map(Te).join(" ").replace(" <br> ","<br>")}}function Te(e){var t=0,n=e;if(Ie(e)){for(;!n.charAt(n.length-1).match(/[a-z0-9\/]/i);)n=n.slice(0,-1),t+=1;return'<a href="'+n+'" target="_blank" data-'+it.prefix+'-link="'+n+'">'+n+"</a>"+e.substr(e.length-t)}return e}function Ie(e){var t=new RegExp("^http://|^https://");return t.test(e)}function Ne(e){var t=new RegExp("png|PNG|jpg|JPG|JPEG|jpeg|gif|GIF"),n=e.substring(e.lastIndexOf(".")+1);return t.test(n)}function Re(e){var t={};return[].slice.call(e.elements).forEach(function(e){"checkbox"===e.type?t[e.name]=e.checked:e.value&&(t[e.name]=e.value)}),t}function Me(e){var t=!0;return[].slice.call(e.elements).every(function(e){return!e.hasAttribute("required")||""!==e.value&&null!==e.value?!0:(alert(tt[dt].ERRORS[e.type]||tt[dt].ERRORS.required),t=!1,!1)}),t}function Fe(){var e=document.createElement("link");e.rel="stylesheet",e.href=it.stylesPath||it.clientPath+"main.css",document.head.appendChild(e)}function Pe(e){var t=Math.floor(e/60),n=e%60,a=(t>9?t:"0"+t)+":"+(n>9?n:"0"+n);return a}function De(e){return e.replace(/\D+/g,"")}function Be(){return void 0!==document.body.classList}function Ue(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}var qe,We,He,ze,Ke,Je,Ge,Ye,$e=e("domify"),Xe=e("./core"),Ve=e("./storage"),Qe=e("./request"),Ze=e("./debug"),et=e("./lodash"),tt=null,nt=e("./cobrowsing"),at=e("./templates"),rt=e("./webrtc"),st=e("./audio-control"),it={prefix:"swc",autoStart:!0,intro:!1,widget:!0,chat:!0,channels:{webrtc:{},callback:{}},cobrowsing:!1,buttonSelector:"",reCreateSession:!0,title:"",lang:"en",langFromUrl:!1,position:"right",hideOfflineButton:!1,offer:!1,styles:{primary:{backgroundColor:"#74b9ff",color:"#FFFFFF"},intro:{},sendmail:{},closeChat:{}},buttonStyles:{online:{backgroundColor:"rgba(175,229,255,0.8)",color:""},offline:{backgroundColor:"rgba(241,241,241,0.8)",color:""},timeout:{backgroundColor:"rgba(241,241,241,0.8)",color:""},notified:{backgroundColor:"rgba(253,250,129,0.8)",color:""},color:"rgb(70,70,70)"},widgetWindowOptions:"left=10,top=10,width=350,height=550,resizable",path:"/ipcc/webchat/",clientPath:"https://cdn.smile-soft.com/wchat/v1/",stylesPath:"",translationsPath:"",host:window.location.host,webrtcEnabled:!1},ot="WchatSettings",lt={initiated:!1,active:!1,state:"",share:!1,sounds:!0},ct=[],ut=[],dt="",ft=!1,pt=1,mt={initModule:r,initWidgetState:se,openWidget:G,initChat:x,initCall:B,getWidgetElement:f,isWebrtcSupported:rt.isSupported,getWidgetState:function(){return lt},getEntity:function(){return Ve.getState("entity","session")},on:function(e,t){return We.on(e,t),this},emit:function(e,t){return We.emit(e,t),this},setDefaultCredentials:function(e){return it.credentials=e,this}};t.exports={module:a,api:mt},n[ot]&&n[ot].autoStart!==!1&&it.autoStart&&("complete"===document.readyState||"interactive"===document.readyState?a(n[ot]):document.addEventListener("DOMContentLoaded",function(){a(n[ot])},!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./audio-control":74,"./cobrowsing":75,"./core":76,"./debug":77,"./lodash":78,"./request":80,"./storage":81,"./templates":82,"./webrtc":83,domify:1}]},{},[79])(79)});